#!/bin/sh
pkgname=ncurses
pkgver=5.6
pkgrel=0
pkgdesc="Console display library"
url="http://www.gnu.org/software/ncurses/"
license=MIT
source="ftp://ftp.gnu.org/pub/gnu/${pkgname}/${pkgname}-${pkgver}.tar.gz
	ftp://invisible-island.net/ncurses/${pkgver}/${pkgname}-${pkgver}-coverity.patch.gz
	"
subpackages="$pkgname-dev $pkgname-doc $pkgname-terminfo"
splitfuncs="dev doc terminfo"

build() {
	cd "$srcdir/$pkgname-$pkgver"
	gunzip -c ../$pkgname-$pkgver-coverity.patch.gz | patch -p1

	 ./configure \
	 	--mandir=/usr/share/man \
	 	--disable-ada \
		--without-cxx-binding \
		--with-shared

	 # fix parallell builds by building sources first
	 make -j1 sources
	 make || return 1

	 make -j1 install DESTDIR=$pkgdir/
}

terminfo() {
	subpkgdir="$pkgdir-terminfo"
	pkgname="ncurses-terminfo"
	rm -rf $subpkgdir
	mkdir -p $subpkgdir/usr/share
	mv $pkgdir/usr/share/terminfo $subpkgdir/usr/share
}

md5sums="b6593abe1089d6aab1551c105c9300e3  ncurses-5.6.tar.gz
27607b10fef869740cbcc408d86695b1  ncurses-5.6-coverity.patch.gz"
