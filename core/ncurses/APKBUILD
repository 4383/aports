#!/bin/sh
pkgname=ncurses
pkgver=5.6
pkgrel=0
pkgdesc="Console display library"
url="http://www.gnu.org/software/ncurses/"
license=MIT
source="ftp://ftp.gnu.org/pub/gnu/${pkgname}/${pkgname}-${pkgver}.tar.gz
	ftp://invisible-island.net/ncurses/${pkgver}/${pkgname}-${pkgver}-coverity.patch.gz
	"
subpackages="dev doc terminfo"

build() {
	cd "$srcdir/$pkgname-$pkgver"
	gunzip -c ../$pkgname-$pkgver-coverity.patch.gz | patch -p1

	 ./configure \
	 	--disable-ada \
		--without-cxx-binding \
		--with-shared

	 # fix parallell builds by building sources first
	 make -j1 sources
	 make || return 1

	 make install DESTDIR=$pkgdir/
}

terminfo() {
	local orig=$pkgdir
	pkgdir="$pkgdir-terminfo"
	pkgname="Database with info for different terminals"
	rm -r $pkgdir
	mkdir -p $pkgdir/usr/share
	mv $orig/usr/share/terminfo $pkgdir/usr/share
}

md5="b6593abe1089d6aab1551c105c9300e3  ncurses-5.6.tar.gz
27607b10fef869740cbcc408d86695b1  ncurses-5.6-coverity.patch.gz"
