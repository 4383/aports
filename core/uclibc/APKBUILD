# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=uclibc
pkgver=0.9.30.1
pkgrel=1
pkgdesc="C library for developing embedded Linux systems"
url=http://uclibc.org
license="LGPL-2"
_mynamever=uClibc-$pkgver

subpackages="$pkgname-dev"
depends_dev="linux-headers"

source="http://uclibc.org/downloads/$_mynamever.tar.bz2
	$pkgname-0.9.30.1-resolv.patch
	uclibcconfig
	"

_prepare() {
	local i gcc_major
	cd "$srcdir/$_mynamever/"
	# patches goes here
	for i in ../*.patch; do
		msg "Applying $i..."
		patch -p1 < $i || return 1
	done
}

_compile() {
	cd "$srcdir/$_mynamever/"
	cp ../uclibcconfig .config
	make silentoldconfig
	make || return 1
}

_install() {
	cd "$srcdir/$_mynamever/"
	make install DESTDIR="$pkgdir"
	install -Dm755 extra/scripts/getent "$pkgdir"/usr/bin/getent
}

build() {
	_prepare && _compile && _install
}

md5sums="1a4b84e5536ad8170563ffa88c34679c  uClibc-0.9.30.1.tar.bz2
ea91460617601b6e084ead66bc3948f5  uclibc-0.9.30.1-resolv.patch
765e04df10aa24532a448ac1b8e2086e  uclibcconfig"
