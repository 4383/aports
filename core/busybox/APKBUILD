# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=busybox
pkgver=1.13.2
pkgrel=5
pkgdesc="Size optimized toolbox of many common UNIX utilities"
url=http://busybox.net
license=GPL-2
depends=uclibc
source="http://busybox.net/downloads/$pkgname-$pkgver.tar.bz2
	$pkgname-1.12.1-vi-path.patch
	$pkgname-1.11.1-bb.patch
	busybox-1.13.2-depmod.patch
	busybox-1.13.2-init.patch
	busybox-1.13.2-mdev.patch
	busybox-1.13.2-modprobe.patch
	busybox-1.13.2-modprobe-errormsg.patch
	busybox-1.13.2-modprobe-speedup.patch
	busybox-1.13.2-tar.patch
	busybox-1.13.2-depmod2.patch
	busyboxconfig"

build() {
	cd $srcdir/$pkgname-$pkgver

	#patches
	for i in ../*.patch; do
		msg "Applying $i"
		if ! patch -p1 -i $i; then
			error "$i failed"
			return 1
		fi
	done

	cp ../busyboxconfig .config
	make silentoldconfig || return 1
	make || return 1
	make install DESTDIR=$pkgdir
}

md5sums="9e2a604d18bef219a5a6bf3acf78b9e1  busybox-1.13.2.tar.bz2
f5a8ae3145aa249868c1a1abc319c228  busybox-1.12.1-vi-path.patch
4c0f3b486eaa0674961b7ddcd0c60a9b  busybox-1.11.1-bb.patch
7c9dfb5dcd66a1d6e837e72ad0cb05d4  busybox-1.13.2-depmod.patch
7afb3a1b474742bc198b3c8450ab9a7e  busybox-1.13.2-init.patch
a72d169e9545e26257032e0e367feb95  busybox-1.13.2-mdev.patch
6eeb6efcd71e57082d6654a9a6a368eb  busybox-1.13.2-modprobe.patch
a743ec04f378b8456a725c7270b0be8b  busybox-1.13.2-modprobe-errormsg.patch
2120bc7d9fb4dcbbb94664c9fefa4c8a  busybox-1.13.2-modprobe-speedup.patch
90d093817855bc63ad16fbb8524f80df  busybox-1.13.2-tar.patch
3c43008545e069749d2d653532e1feb3  busybox-1.13.2-depmod2.patch
7da47c98607834ca9c47a22bf3fe4b6e  busyboxconfig"
