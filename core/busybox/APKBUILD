pkgname=busybox
pkgver=1.13.0
pkgrel=2
pkgdesc="Size optimized toolbox of many common UNIX utilities"
url=http://busybox.net
license=GPL-2
depends=uclibc

source="http://busybox.net/downloads/$pkgname-$pkgver.tar.bz2
	http://busybox.net/downloads/fixes-$pkgver/$pkgname-$pkgver-ash.patch
	http://busybox.net/downloads/fixes-$pkgver/$pkgname-$pkgver-getopt.patch
	http://busybox.net/downloads/fixes-$pkgver/$pkgname-$pkgver-id.patch
	http://busybox.net/downloads/fixes-$pkgver/$pkgname-$pkgver-init.patch
	http://busybox.net/downloads/fixes-$pkgver/$pkgname-$pkgver-inotify.patch
	http://busybox.net/downloads/fixes-$pkgver/$pkgname-$pkgver-klogd.patch
	http://busybox.net/downloads/fixes-$pkgver/$pkgname-$pkgver-lineedit.patch
	http://busybox.net/downloads/fixes-$pkgver/$pkgname-$pkgver-modprobe.patch
	$pkgname-1.12.1-vi-path.patch
	$pkgname-1.11.1-bb.patch
	busyboxconfig"

build() {
	cd $srcdir/$pkgname-$pkgver

	#patches
	for i in ../*.patch; do
		msg "Applying $i"
		if ! patch -p1 -i $i; then
			error "$i failed"
			return 1
		fi
	done

	cp ../busyboxconfig .config
	make silentoldconfig || return 1
	make || return 1
	make install DESTDIR=$pkgdir
}

md5sums="c9159004d24ea7b9f6a816048c5cd1e6  busybox-1.13.0.tar.bz2
50a14acbd1992b1307112e9994c84f49  busybox-1.13.0-ash.patch
c559acc16820d7351510ad9a71a463fd  busybox-1.13.0-getopt.patch
93952435bdf3fc81217127f127a4233f  busybox-1.13.0-id.patch
db11b3964a0c5fad76cb9714dfeb8202  busybox-1.13.0-init.patch
de12cfa77e5fa6923eac11fe5d8305c5  busybox-1.13.0-inotify.patch
38a2101d0e01a736864ee0d3fb657571  busybox-1.13.0-klogd.patch
c6ed3d86e147e0691fdd00bce335d901  busybox-1.13.0-lineedit.patch
209bd64eba39e1ecfd119bf865aaa1d6  busybox-1.13.0-modprobe.patch
f5a8ae3145aa249868c1a1abc319c228  busybox-1.12.1-vi-path.patch
4c0f3b486eaa0674961b7ddcd0c60a9b  busybox-1.11.1-bb.patch
0a32b03209b82e37e085f0bd06985518  busyboxconfig"
