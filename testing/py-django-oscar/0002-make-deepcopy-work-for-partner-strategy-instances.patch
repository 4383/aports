From f4927825fb534ff535cc25bc7a8589479eaa8286 Mon Sep 17 00:00:00 2001
From: Kaarle Ritvanen <kaarle.ritvanen@datakunkku.fi>
Date: Sun, 28 Jun 2015 10:39:08 +0300
Subject: [PATCH 2/2] make deepcopy work for partner strategy instances

required for django-widget-tweaks 1.4 compatibility
---
 src/oscar/apps/partner/strategy.py | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/src/oscar/apps/partner/strategy.py b/src/oscar/apps/partner/strategy.py
index f65ebd8..66a9e2a 100644
--- a/src/oscar/apps/partner/strategy.py
+++ b/src/oscar/apps/partner/strategy.py
@@ -1,4 +1,5 @@
 from collections import namedtuple
+from copy import deepcopy
 from decimal import Decimal as D
 
 from . import availability, prices
@@ -54,6 +55,13 @@ class Base(object):
         if request and request.user.is_authenticated():
             self.user = request.user
 
+    def __deepcopy__(self, memo):
+        res = self.__class__(self.request)
+        for k, v in self.__dict__.items():
+            if k != 'request':
+                res.__dict__[deepcopy(k, memo)] = deepcopy(v, memo)
+        return res
+
     def fetch_for_product(self, product, stockrecord=None):
         """
         Given a product, return a ``PurchaseInfo`` instance.
-- 
2.1.0

