# Maintainer: Leonardo Arena <rnalrd@gmail.com>
pkgname=mpd
pkgver=0.15.13
pkgrel=0
pkgdesc="Music Player Daemon"
url="http://mpd.wikia.com/wiki/Music_Player_Daemon_Wiki"
license="GPL"
depends=
makedepends="alsa-lib-dev bzip2-dev curl-dev ffmpeg-dev flac-dev glib-dev 
	lame-dev libid3tag-dev libogg-dev libvorbis-dev"
install=
subpackages="$pkgname-doc"
source="http://downloads.sourceforge.net/project/musicpd/$pkgname/$pkgver/$pkgname-$pkgver.tar.bz2
	mpd.initd
	0.15.1-mpdconf.patch"

_builddir="$srcdir"/$pkgname-$pkgver

prepare() {
	cd "$_builddir"
	patch -p1 < ../0.15.1-mpdconf.patch || return 1
}

build() {
	cd "$_builddir"
	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info \
		--disable-libOggFLACtest \
		--enable-alsa \
		--enable-bzip2 \
		--enable-lame-encoder
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install

	install -m755 -D "$srcdir"/$pkgname.initd "$pkgdir"/etc/init.d/$pkgname
	# install -m644 -D "$srcdir"/$pkgname.confd "$pkgdir"/etc/conf.d/$pkgname
}

md5sums="d4b6fbc87541a37825c8f25e3ecd5283  mpd-0.15.13.tar.bz2
56a6eacafe64bcf1ffb4d5eb8c99f67b  mpd.initd
356155576dc0ee8d3f40fdb17bc56e45  0.15.1-mpdconf.patch"
