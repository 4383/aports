# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=btrfs-progs
pkgver=0.20_rc1
_ver=${pkgver/_rc/-rc}
pkgrel=0
pkgdesc="Tools for the btrfs"
url="https://btrfs.wiki.kernel.org/"
arch="all"
license="GPL"
depends=
makedepends="util-linux-dev bash attr-dev acl-dev e2fsprogs-dev"
install=
subpackages="$pkgname-doc"
source="https://www.kernel.org/pub/linux/kernel/people/mason/btrfs-progs/btrfs-progs-v$_ver.tar.xz"

_builddir="$srcdir"/$pkgname-v$_ver
prepare() {
	cd "$_builddir"
}

build() {
	cd "$_builddir"
	make CFLAGS="$CFLAGS" prefix=/usr || return 1
}

package() {
	cd "$_builddir"
	make prefix=/usr mandir=/usr/share/man DESTDIR="$pkgdir" install

	# remove the 2 lines below (and this) if there is no init.d script
	# install -m755 -D "$srcdir"/$pkgname.initd "$pkgdir"/etc/init.d/$pkgname
	# install -m644 -D "$srcdir"/$pkgname.confd "$pkgdir"/etc/conf.d/$pkgname
}

md5sums="b152503b9f1a9f577293fa37b1312310  btrfs-progs-v0.20-rc1.tar.xz"
sha256sums="ba969a90b4ae53fca9ba179469d47d194a29f25254612a91c6a12b473f94ee13  btrfs-progs-v0.20-rc1.tar.xz"
sha512sums="92f7a1b7c2c8c7f8be6d7dcb284b97251a97893b201353de28e28f65b01a8517bdf576a0b02e7f8f30f9b8056c0b2985998c0f87c6e9da236899488133a862de  btrfs-progs-v0.20-rc1.tar.xz"
