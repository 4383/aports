# Contributor: Andre Bierwolf <a.b.bierwolf@gmail.com>
# Maintainer: Andre Bierwolf <a.b.bierwolf@gmail.com>
pkgname=novnc
_pkgname=noVNC
pkgver=0.6.2
pkgrel=0
pkgdesc="VNC client using HTML5 (WebSockets, Canvas) with encryption (wss://) support"
url="https://kanaka.github.io/noVNC/"
arch="noarch"
license="MPL-2.0"
depends="websockify net-tools"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/$pkgname/$_pkgname/archive/v$pkgver.tar.gz
	alpine-specific-launch.js.patch"
builddir="$srcdir/$_pkgname-$pkgver"
options="!check"

package() {
	mkdir -p "$pkgdir"/usr/share/novnc
	cp -r "$builddir"/* "$pkgdir"/usr/share/novnc
	# Clean up package
	rm "$pkgdir"/usr/share/novnc/CONTRIBUTING.md
	rm "$pkgdir"/usr/share/novnc/utils/README.md
	# Move license files 
	mkdir -p "$pkgdir"/usr/share/licenses/novnc
	mv "$pkgdir"/usr/share/novnc/LICENSE.txt "$pkgdir"/usr/share/licenses/novnc
	mv "$pkgdir"/usr/share/novnc/docs/LICENSE.* "$pkgdir"/usr/share/licenses/novnc
	# Move documentation
	mkdir -p "$pkgdir"/usr/share/doc
	mv "$pkgdir"/usr/share/novnc/docs "$pkgdir"/usr/share/doc/novnc
	mv "$pkgdir"/usr/share/novnc/README.md "$pkgdir"/usr/share/doc/novnc
	# Add launch.sh to /usr/bin
	mkdir -p "$pkgdir"/usr/bin
	ln -sf /usr/share/novnc/utils/launch.sh "$pkgdir"/usr/bin/novnc_server 
}

sha512sums="245d205f8935c82722a55d6cfcd2cea1825176c0cd695fd0eec34aa19cdc3b766fed62e741ff41b0a8c4a3b3cbabc5a39dfa6ad8ffa6169f5b88420a4a845a7c  novnc-0.6.2.tar.gz
039abf940909767f93217832bb43dc3405613c9a0d0afa4f4d601c1c1d7459394e93fa9d8e5e880b8e65759e293c7da4cc586b73f2c981f50dcb6872093499bc  alpine-specific-launch.js.patch"
