# Contributor: Isaac Dunham <ibid.ag@gmail.com>
# Maintainer: Isaac Dunham <ibid.ag@gmail.com>
pkgname=otter-browser
# We build from the weekly releases.
# Unfortunately, upstream version numbering is rather annoying:
#  they use <next-release>-dev<week>
# abuild hates that, and it would break upgrades if it worked,
# so we use <last-release>.<week-since-release>
pkgver=0.9.03.01
_pkgver=0.9.04-dev45
# Weekly releases may be in otter-browser-weekly<NN> or otter-browser-<release>
_weekly=weekly45

pkgrel=0
pkgdesc="Web browser controlled by the user, not vice-versa"
url="http://otter-browser.org/"
arch="all"
license="GPL3"
depends=""
depends_dev=""
makedepends="$depends_dev qt5-qtbase-dev qt5-qtwebkit-dev qt5-qtscript-dev 
	cmake libpng-dev jpeg-dev openssl-dev"
install=""
subpackages="$pkgname-lang"
langdir="/usr/share/$pkgname/locale"
source="http://downloads.sourceforge.net/otter-browser/otter-browser-${_weekly}/otter-browser-$_pkgver.tar.bz2"

_builddir="$srcdir"/otter-browser-$_pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	mkdir build && cd build || return 1
	cmake -DCMAKE_INSTALL_PREFIX:PATH=/usr ../ && make || return 1
}

package() {
	cd "$_builddir"/build || return 1
	make install DESTDIR="$pkgdir" || return 1
}

md5sums="125b7acff99c8af620b2347c73443053  otter-browser-0.9.04-dev45.tar.bz2"
sha256sums="2546932eebc6d504729b07a28ac46b385f17499ffc6e570aa34ab32f9f3482ab  otter-browser-0.9.04-dev45.tar.bz2"
sha512sums="2e5acf9e5d10989042023ddf7beba0c50109f2cfe8d7602da59da8d69b85d83364fd01b9fb17686ef8cc80a63d2e4433161e3f3f27f6f4c14476b93389aeeca0  otter-browser-0.9.04-dev45.tar.bz2"
