# Contributor: Isaac Dunham <ibid.ag@gmail.com>
# Maintainer: Isaac Dunham <ibid.ag@gmail.com>
pkgname=otter-browser
# We build from the weekly releases.
# Unfortunately, upstream version numbering is rather annoying:
#  they use <next-release>-dev<week>
# abuild hates that, and it would break upgrades if it worked,
# so we use <last-release>.<week-since-release>
pkgver=0.9.03.02
_pkgver=0.9.04-dev46
# Weekly releases may be in otter-browser-weekly<NN> or otter-browser-<release>
_weekly=weekly46

pkgrel=0
pkgdesc="Web browser controlled by the user, not vice-versa"
url="http://otter-browser.org/"
arch="all"
license="GPL3"
depends=""
depends_dev=""
makedepends="$depends_dev qt5-qtbase-dev qt5-qtwebkit-dev qt5-qtscript-dev 
	cmake libpng-dev jpeg-dev openssl-dev"
install=""
subpackages="$pkgname-lang"
langdir="/usr/share/$pkgname/locale"
source="http://downloads.sourceforge.net/otter-browser/otter-browser-${_weekly}/otter-browser-$_pkgver.tar.bz2"

_builddir="$srcdir"/otter-browser-$_pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	mkdir build && cd build || return 1
	cmake -DCMAKE_INSTALL_PREFIX:PATH=/usr ../ && make || return 1
}

package() {
	cd "$_builddir"/build || return 1
	make install DESTDIR="$pkgdir" || return 1
}

md5sums="42ad3e658a5e3507b488dd2a5ea8e562  otter-browser-0.9.04-dev46.tar.bz2"
sha256sums="4e865e95b3079a538057852f828b42747d2af79db163217d38f6d7969ef8723a  otter-browser-0.9.04-dev46.tar.bz2"
sha512sums="5cdf9b7a751ea39b7895a6fb14db84eb9fc32976dfb99d845ac7b4bed67d6fc5a052eda2bc65ff00c29c6fef77e2d1031cdaff895e6090be4afe1a8d85718c01  otter-browser-0.9.04-dev46.tar.bz2"
