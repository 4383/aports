# Contributor: Carlo Landmeter <clandmeter at gmail>
# Maintainer: Carlo Landmeter <clandmeter at gmail>
pkgname=openvcpd
pkgver="0.4_rc1"
_myver="0.4-rc1"
pkgrel=0
pkgdesc="vserver control panel daemon"
url="http://openvcp.org/"
license="GPL"
depends="sqlite libxml2"
makedepends="libxml2-dev pkgconfig util-vserver-dev iptables-dev sqlite-dev libpcap-dev autoconf"
source="http://files.openvcp.org/${pkgname}-${_myver}.tar.gz
	$pkgname-0.4-rc1-makefile.patch
	$pkgname-0.4-rc1-posix-shell.patch
	"

build() {
	cd "$srcdir/$pkgname-$_myver"
	for i in ../*.patch; do
		msg "Applying $i"
		patch -p1 < $i || return 1
	done
	autoconf

	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info
	make || return 1
	mkdir -p "$pkgdir"/usr/bin/
	mkdir -p "$pkgdir"/etc/
	make DESTDIR="$pkgdir" install

	# install -m755 -D "$srcdir"/$pkgname.initd "$pkgdir"/etc/init.d/$pkgname
	# install -m644 -D "$srcdir"/$pkgname.confd "$pkgdir"/etc/conf.d/$pkgname
}

md5sums="18725ca88753e0a5c42af849347934c0  openvcpd-0.4-rc1.tar.gz
fb1802bf62ebc524a836b38683825b25  openvcpd-0.4-rc1-makefile.patch
b27f708c81a27bbf03f4c111b4b1f9f8  openvcpd-0.4-rc1-posix-shell.patch"
