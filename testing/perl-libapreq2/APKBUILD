# Automatically generated by apkbuild-cpan, template 1
# Contributor: Francesco Colista <francesco.colista@gmail.com>
# Maintainer: Francesco Colista <francesco.colista@gmail.com>
pkgname=perl-libapreq2
_pkgreal=libapreq2
pkgver=2.13
pkgrel=1
pkgdesc="Perl module for libapreq2"
url="http://search.cpan.org/dist/libapreq2/"
arch="all"
license="APACHE"
cpandepends="perl-extutils-xsbuilder perl-test-simple"
cpanmakedepends=""
depends="$cpandepends"
makedepends="perl-dev apache2-dev apache2-mod-perl-dev libtool automake autoconf $cpanmakedepends"
install="$pkgname.post-install"
subpackages="$pkgname-dev $pkgname-doc"
source="http://search.cpan.org/CPAN/authors/id/I/IS/ISAAC/$_pkgreal-$pkgver.tar.gz
	$pkgname.conf"

_builddir="$srcdir/$_pkgreal-$pkgver"

prepare() {
	cd "$_builddir"
	./configure --with-apache2-apxs=/usr/sbin/apxs
#	PERL_MM_USE_DEFAULT=1 perl Makefile.PL || return 1
}

build() {
	cd "$_builddir"
	make
}

package() {
	cd "$_builddir"
        make DESTDIR="$pkgdir" install || return 1
        install -Dm644 ../../$pkgname.conf "$pkgdir"/etc/apache2/conf.d/mod-perl-apreq2.conf || return 1
        rm -f "$pkgdir"/usr/lib/*.la \
              "$pkgdir"/usr/lib/apache2/*.la 
                                                        
}

doc() {
        arch="noarch"
        # doc files
        _docs="LICENSE README"
        for _doc in $_docs; do
                install -Dm644 "$_builddir"/$_doc \
                        "$subpkgdir"/usr/share/doc/$pkgname/$_doc || return 1
        done
}

md5sums="c11fb0861aa84dcc6cd0f0798b045eee  libapreq2-2.13.tar.gz
90288cabd74c73d76be4e7a27a620f9b  perl-libapreq2.conf"
