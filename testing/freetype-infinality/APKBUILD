# Contributor: Carlo Landmeter <clandmeter@gmail.com>
# Maintainer:
pkgname=freetype-infinality
pkgver=2.5.3
pkgrel=0
pkgdesc="TrueType font rendering library with infinality patch"
url="ttp://www.infinality.net/blog/infinality-freetype-patches/"
arch="all"
license="GPL"
depends=""
depends_dev="zlib-dev libpng-dev"
makedepends="$depends_dev"
install=""
replaces="freetype"
subpackages="$pkgname-dev"
source="http://downloads.sourceforge.net/sourceforge/freetype/freetype-${pkgver}.tar.bz2
	upstream-2014.10.08.patch
	freetype-2.5.3-enable-valid.patch
	infinality-2.5.3-2014.10.08.patch
	infinality-settings.sh"

_builddir=$srcdir/freetype-$pkgver

prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info \
		--localstatedir=/var \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	install -D "${srcdir}/infinality-settings.sh" \
		"${pkgdir}/etc/profile.d/infinality-settings.sh" || return 1
	rm -f "$pkgdir"/usr/lib/*.la
}

md5sums="d6b60f06bfc046e43ab2a6cbfd171d65  freetype-2.5.3.tar.bz2
bd394dec102e48b34689869765b912c9  upstream-2014.10.08.patch
aa55f7eae584dec7463930ab71ad3dc2  freetype-2.5.3-enable-valid.patch
20dcb30fe4669b7239188e091708dfc6  infinality-2.5.3-2014.10.08.patch
1b79263b344e4ca1e412f33da8399dbc  infinality-settings.sh"
sha256sums="c0848b29d52ef3ca27ad92e08351f023c5e24ce8cea7d8fe69fc96358e65f75e  freetype-2.5.3.tar.bz2
e63212a4e032470ac46fa459480fadf0dbee190e5d7040f1181d9465127053dd  upstream-2014.10.08.patch
086c9874ba5217dab419ac03dbc5ad6480aaa67b3c9d802f7181d8a3e007f8eb  freetype-2.5.3-enable-valid.patch
27199bfe792992f9db67a2f9776bde12efc0e809af7f538ac897991705d8853b  infinality-2.5.3-2014.10.08.patch
ec0cd975d5f5a4dd3363c6b92a49673ffad1460e48ddcddf5afeb2a3a9d60d9b  infinality-settings.sh"
sha512sums="bdd779dc11e9fdb52dfa87839ccc40293df3ea417da0232feadf0e711caa3e62ff145e9afdfd9c3d158df0bc69a805cfbf05b18af8ae7ab5a65213e9c66d242e  freetype-2.5.3.tar.bz2
7c4613849436096bfdb620ac7fd52859c083868f01c43c9f59a3407bda4fce826f657a4432653c4339b7bffbb7616e6f86bb40e642f6a02166622247a31973bd  upstream-2014.10.08.patch
1cefdab6a2de6dbae84140007b47a644bd2de72c112f7b0e9c17810df8897c768b8ce584863e9643405df27ffb4476830dd9a295af02b5ac2379e1bb9b1bb21f  freetype-2.5.3-enable-valid.patch
d041f3cf0413be82802dac4d48c25db808c95e94fa63c63bef148afe9d77393011cc2fae77e7dd5c83d6259070131a77a693e30f949337e59e1cb42250ed3611  infinality-2.5.3-2014.10.08.patch
0d19740d71e8d1f283db3db1e0d66a2d500ea644155b02ee7fe0ec0cdd20146b07cba497594590157df8afee9ffb729f13fc6867f10322fba87e9c31a34ec318  infinality-settings.sh"
