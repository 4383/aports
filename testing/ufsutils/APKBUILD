# Contributor:
# Maintainer:
pkgname=ufsutils
pkgver=8.2
pkgrel=0
pkgdesc="utilities to manage the UFS, UFS2 and FFS filesystems"
url="http://packages.debian.org/sid/ufsutils"
arch="all"
license="BSD"
depends=""
depends_dev="libbsd-dev"
makedepends="$depends_dev libedit-dev"
install=""
subpackages="$pkgname-dev $pkgname-doc"
source="http://ftp.de.debian.org/debian/pool/main/u/ufsutils/ufsutils_8.2.orig.tar.gz
	http://ftp.de.debian.org/debian/pool/main/u/ufsutils/ufsutils_8.2-3.debian.tar.gz
	uclibc-no-fstab.patch"

_builddir="$srcdir/ufsutils-$pkgver"
prepare() {
	local i
	cd "$_builddir"
	mv "$srcdir"/debian "$_builddir"
	for i in debian/patches/*.patch; do
		msg $i; patch -p1 -i $i || return 1
	done
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	make -j1 || return 1
}

package() {
	cd "$_builddir"
	mkdir -p "$pkgdir"/usr/bin "$pkgdir"/usr/lib "$pkgdir"/usr/include \
		"$pkgdir"/usr/sbin "$pkgdir"/usr/share/man/man8
	make DESTDIR="$pkgdir" prefix="/usr" install || return 1
}

md5sums="e36f879da29e227e4d6494afc0c13559  ufsutils_8.2.orig.tar.gz
82077eb8980d3f9567910f61892c56f1  ufsutils_8.2-3.debian.tar.gz
e63bb9f49b387e90d4a9bf9fef318b4a  uclibc-no-fstab.patch"
sha256sums="6298d2a94fb601f6951bf81ce074e6af597e8867ac210d8ff73348aeb3738bd9  ufsutils_8.2.orig.tar.gz
6040ad18ddbf9fa37b87b084fe6cf19c50f63456d15b6726067c558f8383b795  ufsutils_8.2-3.debian.tar.gz
8b581291d83dcdee402b2e441ca4e4026ba88d46a89a88182c65e6e7a85d99e7  uclibc-no-fstab.patch"
sha512sums="f378372c2493c16fe8cb3977f4ed2d104e747895e97d7642d21b5e87a2a03ac696bbac093e534e13c2f1dc4638741edcbbb0ddec5abcbfa6b4f7401efbf7cf14  ufsutils_8.2.orig.tar.gz
7bc925e742eaf4e1837ca4b46afa7966490234492eeb40ad8fabf71550a79890f3294780c2dbdf3593a82fc8e0708cf4c72baba81f4fec9a884cfa545c8895c8  ufsutils_8.2-3.debian.tar.gz
f3ba783768fcc0d595f715f3cf71ef64a13f7d3c7b9a6841b4681aceaa6c3c13a15a8d030e0e2141cd73c09cc52a15b315f4b05b63e61eaa0e08a74ff3331ca0  uclibc-no-fstab.patch"
