# Contributor: blinkkin <blink@bojary.koba.pl>
# Maintainer:

pkgname=mansh
pkgver=20110604
pkgrel=0
pkgdesc="man, whatis and apropos written in shell"
url="http://svnweb.freebsd.org/base/head/usr.bin/man/"
arch="noarch"
license="BSD"
depends=
depends_dev=
makedepends="cvs"
install="$pkgname.post-install"
subpackages="$pkgname-doc"
source="http://dev.alpinelinux.org/~ncopa/mansh-$pkgver.tar.bz2
	mdocml-support.patch"

_builddir="$srcdir"/$pkgname
mksource() {
	mkdir /tmp/${pkgname}-${pkgver}
	(cd /tmp/${pkgname}-${pkgver};
	cvs -d :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs checkout -D $pkgver -d $pkgname src/usr.bin/man/
	rm -rf /tmp/${pkgname}-${pkgver}/$pkgname/CVS
	tar cjf /tmp/${pkgname}-${pkgver}/${pkgname}-${pkgver}.tar.bz2 mansh/)
}

prepare() {
	cd "$_builddir"
	for i in "$srcdir"/*.patch; do
		msg "Applying ${i}"
		patch -p0 -i $i || return 1
	done
}

package() {
	cd "$_builddir"
	install -Dm 755 man.sh "$pkgdir"/usr/libexec/man.sh
	for i in *.1; do
		install -Dm 644 $i "$pkgdir"/usr/share/man/man1/$i
	done
	install -Dm 644 man.conf.5 "$pkgdir"/usr/share/man/man5/man.conf.5 || return 1
}

md5sums="0e25b2e02febf224709f4e2fabb12d6a  mansh-20110604.tar.bz2
f805bbd10a20d1f2c9aa318e83186ecf  mdocml-support.patch"
