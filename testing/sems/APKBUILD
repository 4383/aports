# Contributor: Francesco Colista <francesco.colista@gmail.com>
# Maintainer: Francesco Colista <francesco.colista@gmail.com>
pkgname=sems
pkgver=1.1.1
pkgrel=0
pkgdesc="High performance, extensible media server for SIP (RFC3261) based VoIP  services"
url="http://iptel.org/sems/"
license="GPL-2"
depends="kamailio"
makedepends="python openssl-dev"
install=
subpackages=""
source="http://ftp.iptel.org/pub/$pkgname/1.1/$pkgver/src/$pkgname-$pkgver.tar.gz
	"

# append extra dependencies to -dev subpackage
# remove if not used.
# depends_dev="somepackage-dev"

build() {
	cd "$srcdir"/$pkgname-$pkgver
	sed -i -e 's:^cfg-target.*:cfg-target = $(cfg-dir):' \
		-e 's:^cfg-prefix.*:cfg-prefix = $(basedir):' \
		Makefile.defs \
		|| return 1

	make PREFIX=/usr \
		cfg-dir=/etc/sems/ \
		CC="$CC" CXX="$CXX" \
		exclude_modules="ivr examples py_sems" \
		|| return 1
}

package() {
	cd "$srcdir"/$pkgname-$pkgver
	make PREFIX=/usr \
		cfg-dir=/etc/sems/ \
		exclude_modules="ivr examples py_sems" \
		DESTDIR="$pkgdir" \
		install || return 1

	# remove the 2 lines below (and this) if there is no init.d script
#	 install -m755 -D "$srcdir"/$pkgname.initd "$pkgdir"/etc/init.d/$pkgname
#	 install -m644 -D "$srcdir"//$pkgname.confd "$pkgdir"/etc/conf.d/$pkgname
}

md5sums="4a6422d09ddadaf9eacd8cae8f0848d5  sems-1.1.1.tar.gz"
