#!/usr/bin/lua5.2

local posix = require 'posix'
local aaudit = require 'aaudit'

local function usage()
	print("usage: aaudit-repo-update [-i COMMIT_IDENTITY] [-m COMMIT_MESSAGE]")
	os.exit(1)
end

local C = { }
local address
for ret, optval in posix.getopt(arg, 'a:i:m:') do
	if ret == 'a' then
		address = optval
	elseif ret == 'i' then
		C.identity = optval
	elseif ret == 'm' then
		C.message = optval
	else
		usage()
	end
end

aaudit.import_commit(aaudit.repohome(address), C)
