# Contributor: Carlo Landmeter <clandmeter@gmail.com>
pkgname=mysql
pkgver=5.0.75
pkgrel=2
pkgdesc="A fast SQL database server"
url="http://www.mysql.com/"
license='GPL'
depends="readline openssl"
makedepends="libtool uclibc++-dev readline-dev openssl-dev"
source="http://sunsite.informatik.rwth-aachen.de/mysql/Downloads/MySQL-5.0/${pkgname}-${pkgver}.tar.gz
$pkgname.initd
$pkgname.mycnf"
subpackages="$pkgname-doc $pkgname-dev $pkgname-test"

build() {
        cd "$srcdir/$pkgname-$pkgver"
        ./configure --prefix=/usr --libexecdir=/usr/sbin \
        --localstatedir=/var/lib/mysql \
        --disable-assembler --with-pthread \
        --without-raid --without-libwrap \
        --without-pstack --without-docs \
        --without-embedded-server --with-openssl \
        --without-mysqlfs --without-vio \
        --without-bench --without-debug \
        --with-innodb --mandir=/usr/share/man || return 1
        make || return 1
        make -j1 DESTDIR="$pkgdir/" install
        install -Dm 755 "$startdir"/$pkgname.initd $pkgdir/etc/init.d/$pkgname
        install -Dm 644 "$startdir"/$pkgname.mycnf $pkgdir/etc/mysql/my.cnf
        install -dDo mysql $pkgdir/var/log/mysql
        install -dDo mysql $pkgdir/var/run/mysqld
}

test() {
        mkdir -p "$subpkgdir"/usr
        mv "$pkgdir"/usr/mysql-test "$subpkgdir"/usr/
}

md5sums="a234f0a60a7f8c290d9875cba3a2c5a2  mysql-5.0.75.tar.gz
3ce9827b22d8fbbb29d83a91cbe98ffc  mysql.initd
ca0e193da25d2f10e41334c6d83fa859  mysql.mycnf"
