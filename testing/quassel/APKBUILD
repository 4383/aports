# Maintainer: Yves Schumann <yves@eisfair.org>

pkgname=quassel
pkgver=0.9.0
pkgrel=0
url="http://www.quassel-irc.org/"
pkgdesc="Distributed IRC client - metapackage"
arch="all"
license="GPL"
makedepends="qt-dev cmake"
subpackages="$pkgname-core"
source="http://www.quassel-irc.org/pub/quassel-$pkgver.tar.bz2
       $pkgname-core.defaultd
       $pkgname-core.initd"

build() {
  cd "$srcdir"
  mkdir core

  cd core
  cmake \
    -DCMAKE_INSTALL_PREFIX=/usr/ \
    -DWITH_KDE=0 \
    -DCMAKE_BUILD_TYPE="Release" \
    -DWITH_OPENSSL=ON \
    -DWANT_CORE=ON \
    -DWANT_MONO=OFF \
    -DWANT_QTCLIENT=OFF \
    -DWITH_DBUS=OFF \
    -DWITH_OXYGEN=OFF \
    -DWITH_PHONON=OFF \
    -DWITH_WEBKIT=OFF \
    -DCMAKE_BUILD_TYPE="Release" \
    ../quassel-$pkgver/ || return 1
}

package() {
  mkdir -p "$pkgdir" && return 0
}

core() {
  pkgdesc="Core component of distributed IRC client"
  install="quassel-core.pre-install"

  cd "$srcdir"/core
  make DESTDIR="$subpkgdir" install
  rm -r "$subpkgdir"/usr/share

  install -Dm0644 "$srcdir"/$subpkgname.defaultd \
    "$subpkgdir"/etc/conf.d/quassel-core || return 1
  install -Dm0755 ${srcdir}/$subpkgname.initd \
    "$subpkgdir"/etc/init.d/quassel-core || return 1
}

md5sums="29b843f18d703abfadb8fc729ca1df11  quassel-0.9.0.tar.bz2
560e396db1e85d641c15eb6b15cbae74  quassel-core.defaultd
5d4d6dee89961fb2108727b56b8bf75d  quassel-core.initd"
sha256sums="2e3fe06ae3731c829aa3c2f6bb5320619bad264c831f322985c3aa3fe58b6027  quassel-0.9.0.tar.bz2
9e916cefd6a1be7218249410490ce07c8a98ba8f96b2c3c16b3ee3f1222dbd51  quassel-core.defaultd
6ad0a474f3978980a3337e6b523b88c6dd81850b6b7f0538cbe86d36345f1605  quassel-core.initd"
sha512sums="5f0b54c7c0e839d30ec5cc1c76f115f60aef35c53b2ed1cc69cb856413e0b381bfa3b56d6a9b60d8a118d216930adb52856d39b1bbd4c96e8c0f3809756f6f21  quassel-0.9.0.tar.bz2
6f8120cf08b676a896a63e370d9c0e16db72cf2a9b1a8db52f5ce3b983ce38a7d157d6346282158fd0d440048aad00bb3c57d6b5c81a0ab5a92918b11d15aa6d  quassel-core.defaultd
f761d881973af0151b4e39419b972d8e9c5e9f43d3ae52d64fefc1fd631c397fee5a929b7d559705d2fbf53bd2adff943451d8402059e3ac6893b3b9fe72d979  quassel-core.initd"
