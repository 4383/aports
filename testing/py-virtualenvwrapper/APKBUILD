# Contributor: Herve Beraud <herveberaud.pro@gmail.com>
# Maintainer: Herve Beraud <herveberaud.pro@gmail.com>
pkgname=py-virtualenvwrapper
pkgver=4.8.0
pkgrel=0
pkgdesc="Enhancements to virtualenv"
url="https://bitbucket.org/virtualenvwrapper/virtualenvwrapper/"
arch="noarch"
license="MIT"
depends="bash"
makedepends='python2-dev python3-dev py-setuptools py-pbr'
install=""
subpackages="py2-${pkgname#py-}:_py2 py3-${pkgname#py-}:_py3"
source="${pkgname}-${pkgver}.tar.gz::https://bitbucket.org/virtualenvwrapper/virtualenvwrapper/get/${pkgver}.tar.gz"
builddir="${srcdir}/virtualenvwrapper-virtualenvwrapper-c9300524289e"

build() {
	cd "${builddir}"
	export PBR_VERSION=${pkgver}
	python2 setup.py build
	python3 setup.py build
}

package() {
	mkdir -p "${pkgdir}"
}

_py2() {
	depends="${depends//py-/py2-}"
	_py python2
}

_py3() {
	depends="${depends//py-/py3-}"
	_py python3
}

_py() {
	local python="$1"
	pkgdesc="${pkgdesc} (for ${python})"
	depends="${depends} ${python}"
	install_if="${pkgname}=${pkgver}-r${pkgrel} ${python}"

	cd "${builddir}"
	export PBR_VERSION=${pkgver}
	$python setup.py install --prefix=/usr --root="${subpkgdir}" --skip-build
}

sha512sums="912986356519da84fe5d113274ea69c10b26eb5f4d17b37e88e4b799a1d674e3ab1d04bbbf75411622f11534f2d1aeb771196a2f3cb1c4ea640bcb4cdcc6910d  py-virtualenvwrapper-4.8.0.tar.gz"
