# Contributor: Nathan Angelacos <nangel@tetrasec.net>
# Maintainer: Nathan Angelacos <nangel@tetrasec.net>
pkgname=vpopmail
pkgver=5.4.28
pkgrel=0
pkgdesc="inter7 virtual email domain management system"
url="http://www.inter7.com/vpopmail/"
license="GPL"
depends=""
makedepends="bash autoconf automake"
install=
subpackages="$pkgname-dev"
source="http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz
	vpopmail-5.4.9-access.violation.patch
	vpopmail-lazy.patch
	"

build() {
        cd "$srcdir"/$pkgname-$pkgver
	for i in ../*.patch; do
		patch -p1 -i $i || return 1
	done
	aclocal && autoconf && automake || return 1

	unset CHOST
        ./configure \
		--prefix=/usr \
                --sysconfdir=/etc/vpopmail \
                --mandir=/usr/share/man \
		--enable-non-root-build \
		--enable-qmaildir=/tmp \
		--enable-qmail-newu=/bin/true \
		--enable-qmail-inject=/bin/true \
		--enable-qmail-newmrh=/bin/true \
		--enable-vpopuser=vpopmail \
		--enable-vpopgroup=vpopmail \
		--enable-many-domains \
		--enable-file-locking \
		--enable-file-sync \
		--enable-md5-passwords \
		--enable-logging \
		--enable-auth-logging \
		--enable-log-name=vpopmail \
		--disable-tcpserver-file \
		--disable-roaming-users \
		|| return 1
        make || return 1
        make -j1  DESTDIR="$pkgdir" install

}

md5sums="8b44fb9c62d4ef96b29143863b577abb  vpopmail-5.4.28.tar.gz
76a1cf57780abbbdcc07e7312e532704  vpopmail-5.4.9-access.violation.patch
c87be7ba2d6d2efd4a8f12e8879de326  vpopmail-lazy.patch"
