# Contributor: Francesco Colista <francesco.colista@gmail.com>
# Maintainer: Francesco Colista <francesco.colista@gmail.com>
pkgname=mosh
pkgver=1.2.4
pkgrel=1
pkgdesc="Mobile shell (mosh) surviving disconnects with local echo and line editing"
url="http://mosh.mit.edu"
arch="all"
license="GPL3+"
depends="perl-io-tty"
makedepends="ncurses-dev zlib-dev openssl-dev perl-dev perl-io-tty protobuf-dev"
subpackages="$pkgname-doc"
source="http://$pkgname.mit.edu/$pkgname-$pkgver.tar.gz
	disable-utf8-check.patch"

_builddir="$srcdir"/$pkgname-$pkgver

prepare() {
        local i
        cd "$_builddir"
        for i in $source; do
                case $i in
                *.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
                esac
        done
}


build() {
	cd "$_builddir"
	./configure --prefix=/usr \
		--sysconfdir=/etc
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
}

md5sums="c2d918f4d91fdc32546e2e089f9281b2  mosh-1.2.4.tar.gz
521b99f8ed402bceb7b600bc01e71383  disable-utf8-check.patch"
sha256sums="e74d0d323226046e402dd469a176075fc2013b69b0e67cea49762c957175df46  mosh-1.2.4.tar.gz
732239ba535072466d997fd09e365d4d86639ac327fc820eaf21ef5a31c37aae  disable-utf8-check.patch"
sha512sums="f7505faffdc8da734179b37339b554f83cbf5450b251cd2aa50d63cd6e4cbefa0da17a1c1b2a61858735ac9e5cee5841ed20e81e244380f5f9a02af1b87199cc  mosh-1.2.4.tar.gz
e20d876d8355a872d9f311ce6390996b7473ea4215b55c292735fd294eca0b66393cbec3d8c9c387403875b6b6456f026669bd320ba991d6358df1e9508ec437  disable-utf8-check.patch"
