# Maintainer: Natanael Copa <ncopa@alpinelinux.org>

pkgname=libreswan
pkgver=3.3
pkgrel=0
pkgdesc='IPsec implementation for Linux'
url='https://libreswan.org/'
arch='all'
license='GPL'
depends='coreutils'
depends_dev='gmp-dev linux-pam-dev nss-dev unbound-dev libcap-ng-dev curl-dev nspr-dev'
makedepends="$depends_dev bison flex pkgconf coreutils bash"
subpackages="$pkgname-doc"
source="http://download.libreswan.org/libreswan-$pkgver.tar.gz
	ipsec.initd"

build() {
  cd "$srcdir"/$pkgname-$pkgver
  make programs || return 1
  #make module || return 1 
}

package() {
	cd "$srcdir"/$pkgname-$pkgver
	make INC_MANDIR=share/man \
		INC_RCDEFAULT=/etc/init.d \
		INC_USRLOCAL=/usr \
		DESTDIR="$pkgdir" \
		INSTCONFFLAGS=-m644 \
		install || return 1
	install -Dm755 "$srcdir"/ipsec.initd "$pkgdir"/etc/init.d/ipsec \
		|| return 1
}

md5sums="a3e8562dfa1a7f4384e0e66a26acec52  libreswan-3.3.tar.gz
014d8187d22a348a04dd2fdba4fc0d46  ipsec.initd"
sha256sums="ed30825d0d9c5742d53be1c6d251023ac23c0cccbabb4bd2714447985f05232d  libreswan-3.3.tar.gz
f21668846fdf6d01a7d92672adf0a5dda63f827b317ab0253a7c627968656d8f  ipsec.initd"
sha512sums="407ca3088dc77d651183fe1dd4e8c259d1c39c500137c5053c7a0dae9435d5b432e22cff7e84b377344da016ebe0d9e2ed68565fe6b5837f9ecf79b0b6a6e994  libreswan-3.3.tar.gz
c245b20e1ea8bd1a615f467e72ccbb3df7b63a60d1fcdb7b485a791377a0adfa75942ed73a6fb1c792eca472c92d3d524e33ba0594467738aac3aaa9123778b2  ipsec.initd"
