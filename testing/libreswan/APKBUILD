pkgname=libreswan
pkgver=3.2
pkgrel=1
pkgdesc='IPsec implementation for Linux'
url='https://libreswan.org/'
arch='all'
license='GPL'
depends='coreutils'
depends_dev='gmp-dev linux-pam-dev nss-dev unbound-dev libcap-ng-dev curl-dev nspr-dev'
makedepends="$depends_dev bison flex pkgconf coreutils bash"
subpackages="$pkgname-doc"
source="http://download.libreswan.org/libreswan-$pkgver.tar.gz
	ipsec.initd"

build() {
  cd "$srcdir"/$pkgname-$pkgver
  make programs || return 1
  #make module || return 1 
}

package() {
	cd "$srcdir"/$pkgname-$pkgver
	make INC_MANDIR=share/man \
		INC_RCDEFAULT=/etc/init.d \
		INC_USRLOCAL=/usr \
		DESTDIR="$pkgdir" \
		INSTCONFFLAGS=-m644 \
		install || return 1
	install -Dm755 "$srcdir"/ipsec.initd "$pkgdir"/etc/init.d/ipsec \
		|| return 1
}

md5sums="9917acaa9b389adf75588cbeba7279fd  libreswan-3.2.tar.gz
014d8187d22a348a04dd2fdba4fc0d46  ipsec.initd"
sha256sums="a000684f69161b2459c041aab669cbb8f2337789243ff3a4b0bf9c4201c97176  libreswan-3.2.tar.gz
f21668846fdf6d01a7d92672adf0a5dda63f827b317ab0253a7c627968656d8f  ipsec.initd"
sha512sums="9b988302fda1fe82c16eb9c824975ea6ac0f27e863394f950dd681f46521981cce32336182fe7496d341bc9933a308412a8d96b05a9dba66b1a91181e21effee  libreswan-3.2.tar.gz
c245b20e1ea8bd1a615f467e72ccbb3df7b63a60d1fcdb7b485a791377a0adfa75942ed73a6fb1c792eca472c92d3d524e33ba0594467738aac3aaa9123778b2  ipsec.initd"
