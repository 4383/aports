# Contributor: Leonardo Arena <rnalrd@gmail.com>
pkgname=ipvsadm
pkgver=1.27
pkgrel=1
pkgdesc="The IP Virtual Server administration utility"
url="http://www.linuxvirtualserver.org/software/ipvs.html"
arch="all"
license="GPL2"
depends=
depends_dev="libnl-dev popt-dev"
makedepends="$depends_dev"
install=
subpackages="$pkgname-doc"
source="https://kernel.org/pub/linux/utils/kernel/ipvsadm/$pkgname-$pkgver.tar.xz
	$pkgname.initd"

_builddir="$srcdir"/$pkgname-$pkgver

build() {
	cd "$_builddir"
	make -j1 BUILD_ROOT="$pkgdir" \
		MANDIR=usr/share/man \
		SBIN="$pkgdir/usr/sbin" \
		INIT="$pkgdir/etc/init.d" \
		|| return 1
}

package() {
	cd "$_builddir"
	make -j1 BUILD_ROOT="$pkgdir" \
		MANDIR=usr/share/man \
		SBIN="$pkgdir/usr/sbin" \
		INIT="$pkgdir/etc/init.d" \
		install

	# remove the 2 lines below (and this) if there is no init.d script
	install -m755 -D "$srcdir"/$pkgname.initd "$pkgdir"/etc/init.d/$pkgname
	# install -m644 -D "$srcdir"/$pkgname.confd "$pkgdir"/etc/conf.d/$pkgname
}

md5sums="9decaaaad2fd637ed06cffd954e66cf3  ipvsadm-1.27.tar.xz
f3e8df193ebf50e4161bee64d34d2fc5  ipvsadm.initd"
sha256sums="d360fb4dcf591e0a8a918831e2c02b1dc03e3c17ee1e60d0d70de9455238b3f8  ipvsadm-1.27.tar.xz
462cc0ee041a0ed2a3bcb8a0f84c0c04a9394d046ba0c2dcb8ca454575207cb9  ipvsadm.initd"
sha512sums="cf982b7981674c91d1b7516de7b55cf378b306ce4a53e13976b8eeb8610015c4fa4aa9d251bc4d329db8e05c1862863160af2d3c63b76263f290087cffdf1b80  ipvsadm-1.27.tar.xz
7e34e10a9bf975c2318605e9603ce2f2ab447563b7cfb6ef0cda2054ee5f73f97d5aa678cf43f9466ba2f6751a01e8830b85df9396ac973d4708472b275f476e  ipvsadm.initd"
