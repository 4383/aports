# Contributor: Cameron Banta <cbanta@gmail.com>
# Maintainer: Fabian Affolter <fabian@affolter-engineering.ch>
pkgname=bcfg2
pkgver=1.3.0
pkgrel=o
pkgdesc="A configuration management tool"
url="http://bcfg2.org"
arch="noarch"
license="BSD"
depends="python py-lxml"
makedepends="python-dev py-setuptools"
install=""
subpackages="$pkgname-doc $pkgname-server"
source="ftp://ftp.mcs.anl.gov/pub/bcfg/$pkgname-$pkgver.tar.gz
		bcfg2-server.initd"
_builddir="$srcdir"/$pkgname-$pkgver

build() {
	cd "$_builddir"
	python setup.py build || return 1
}

package() {
	cd "$_builddir"
	python setup.py install --root="$pkgdir" || return 1
}

server() {
	depends="python bcfg2 py-lxml openssl"

	mkdir -p "$subpkgdir"/usr/bin
	mv "$pkgdir"/usr/bin/bcfg2-* "$subpkgdir"/usr/bin/
	mkdir -p "$subpkgdir"/usr/share
	mv "$pkgdir"/usr/share/bcfg2 "$subpkgdir"/usr/share/
	install -m755 -D bcfg2-server.initd "$subpkgdir"/etc/init.d/$subpkgname
}

md5sums="e99861a5f219fc11d40f814089928ee3  bcfg2-1.3.0.tar.gz
9a13baa6f40267ff9dbec574967c5068  bcfg2-server.initd"
sha256sums="f15f9b54bc020bae782642cb8a8d6339f12b0335f049398a5afb9d8e80c01a53  bcfg2-1.3.0.tar.gz
c23385c66d5a472d3a322873b2873301db8f674af9e03c24105158c27ce0831c  bcfg2-server.initd"
sha512sums="a5773d6e9fa630705483c7476d65ff4a81a0c2951fccf09ca65ab74f2910174e9a83a489ec61b911cc3af1807b216952d7c9613cb26edbed58c24f0a8783c0d9  bcfg2-1.3.0.tar.gz
8ad40aedeaa5084793a624599ff4ec61a1b6489854b5533504baf456c9c39f97a4c80a521909c7386c481d2417ad59f28735cfbeedf86468634223695f1dc2fc  bcfg2-server.initd"
