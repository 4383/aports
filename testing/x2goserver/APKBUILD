# Contributor: Jeff Bilyk <jbilyk@gmail.com>
# Maintainer:
pkgname=x2goserver
pkgver=4.0.0.0
pkgrel=0
pkgdesc="Terminal server"
url="http://x2go.org"
arch="all"
license="GPL2+"
depends=""
makedepends="libssh2-dev perl-dbd-sqlite python-dev xauth bash man"
install="$pkgname.pre-install"
subpackages="$pkgname-doc"
source="http://code.x2go.org/releases/source/$pkgname/$pkgname-$pkgver.tar.gz"
pkgusers="x2gouser"
pkggroups="x2gouser"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done

	#Every Makefile has /usr/local as PREFIX, so replace that
	find ./ -name Makefile | xargs sed -e 's#/usr/local#/usr#g' -i
}

build() {
	cd "$_builddir"
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
}

md5sums="1fc38566832c30897c6583e7ffa1fda3  x2goserver-4.0.0.0.tar.gz"
sha256sums="32c7926edeecd8d9362711ba34f9795821e140bb8d10d056c4f4c2c98fb1778f  x2goserver-4.0.0.0.tar.gz"
sha512sums="f951bfffb398a7ff9e2d59714a742d0c02180b8264a83292a88b10c7d08816c20f0d6ab2f3147717d0f6784153606814257cf5be7850bebb811340aafeaeb7db  x2goserver-4.0.0.0.tar.gz"
