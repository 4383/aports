# Contributor: Jeff Bilyk <jbilyk@gmail.com>
# Maintainer:
pkgname=x2goserver
pkgver=4.0.1.6
pkgrel=0
pkgdesc="Terminal server"
url="http://x2go.org"
arch="all"
license="GPL2+"
depends=""
makedepends="libssh2-dev perl-dbd-sqlite python-dev xauth bash man"
install="$pkgname.pre-install"
subpackages="$pkgname-doc"
source="http://code.x2go.org/releases/source/$pkgname/$pkgname-$pkgver.tar.gz"
pkgusers="x2gouser"
pkggroups="x2gouser"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done

	#Every Makefile has /usr/local as PREFIX, so replace that
	find ./ -name Makefile | xargs sed -e 's#/usr/local#/usr#g' -i
}

build() {
	cd "$_builddir"
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
}

md5sums="61f2248fb16bc035f92b9588ab19c35e  x2goserver-4.0.1.6.tar.gz"
sha256sums="5aef214e98ad2a91e87429faed2a871abdd435a081c88f86430dcf175b0c6159  x2goserver-4.0.1.6.tar.gz"
sha512sums="4d8372059d478cddc0a373303bae12cf2008e0e7cb953ad21c0e4558df5dcdc8f1143a5458932d06f1f9ca595f926f316310ed5623881605a76997c0d34d6b07  x2goserver-4.0.1.6.tar.gz"
