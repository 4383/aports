# Contributor: Dennis Przytarski <dennis@przytarski.com>
# Maintainer:
pkgname=rng-tools
pkgver=5
pkgrel=1
pkgdesc="a random number generator daemon"
url="http://sourceforge.net/projects/gkernel/"
arch="all"
license="GPL2"
depends=""
depends_dev="argp-standalone linux-headers"
makedepends="$depends_dev"
install=
subpackages=
source="http://downloads.sourceforge.net/project/gkernel/$pkgname/$pkgver/$pkgname-$pkgver.tar.gz
	fix-textrels-on-PIC-x86.patch 
	rngd.confd
	rngd.initd
	"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	export LIBS="-largp"
	./configure \
		--prefix=/usr \
		--libexecdir=/usr/lib/rng-tools \
		--sysconfdir=/etc \
		--disable-silent-rules
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="${pkgdir}" install || return 1

	install -m644 -D "${srcdir}/rngd.confd" "${pkgdir}/etc/conf.d/rngd" || return 1
	install -m755 -D "${srcdir}/rngd.initd" "${pkgdir}/etc/init.d/rngd" || return 1
}

md5sums="6726cdc6fae1f5122463f24ae980dd68  rng-tools-5.tar.gz
327ecc26d50a4a93f8cdec4a24fa837c  fix-textrels-on-PIC-x86.patch
6f883db10f299d0640e0b3c5fa6e6175  rngd.confd
afe366ae9d230898abf7984e4fd6686a  rngd.initd"
sha256sums="60a102b6603bbcce2da341470cad42eeaa9564a16b4490e7867026ca11a3078e  rng-tools-5.tar.gz
15072f76a7198859a08de56fc6c438a1c393a31e4a119200a7c8c63c5b15f0b6  fix-textrels-on-PIC-x86.patch
5cd5751f8b849b3df9c8d5203e137123ef4603eb882f02603c83a61c5365f237  rngd.confd
3bf0a290067f4e02aa1b655ecd609ab21ff4bea28aab77659c4926a26029ec28  rngd.initd"
sha512sums="58047c37cad4f5f1210b696e4dba122878f78e57d05d9cb822f79234240ecce31efd2d39061fea1eb5b2e81d48d8c3bf6b92d06451f1ce5d5db7117704e89c50  rng-tools-5.tar.gz
5c8196c3e70c093215fc0720cd3f58f339f74293a7eb35d95b914591d783472119dcc34fb27ab6a4c3ce5359e050b4987d1e7ddf213a7445fc0b70d9fae5eae5  fix-textrels-on-PIC-x86.patch
2823cdb88cd45652d7d5097cdb239b404d7754930995f957dc2653c03762952cefc7c804f3dabfe8a4836bd098a4265cff67cff351b22cccf94d70efad293e2b  rngd.confd
833612de0fb3f3f4a43a1d570660bd95a544983f1fe6e4a7b34e2a039729512dd76077e1a2469552830b98a869e47f4c8685fc55219beaca267993d8f0bdd2b9  rngd.initd"
