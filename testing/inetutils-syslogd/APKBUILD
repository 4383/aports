# Contributor: IT Offshore <developer@it-offshore.co.uk>
# Maintainer:
pkgname=inetutils-syslogd
_pkgname=inetutils
pkgver=1.9.1
pkgrel=0
pkgdesc="A small syslogd for logging to multiple files"
url="http://www.gnu.org/software/inetutils/"
arch="all"
license="GPL3"
depends=""
depends_dev=""
makedepends="$depends_dev readline-dev ncurses-dev"
install="$pkgname.post-install $pkgname.post-deinstall"
subpackages="$pkgname-doc"
source="http://ftp.gnu.org/gnu/inetutils/${_pkgname}-${pkgver}.tar.gz
	inetutils-syslogd.initd
	inetutils-syslogd.confd
	syslog.conf
	inetutils-syslogd.logrotate
	"

_builddir="$srcdir"/$_pkgname-$pkgver

build() {
	cd "$_builddir"

        ./configure \
                --build=$CBUILD \
                --host=$CHOST \
                --prefix=/usr \
		--libexec=/usr/sbin \
                --sysconfdir=/etc \
                --mandir=/usr/share/man \
                --infodir=/usr/share/info \
                --localstatedir=/var \
		--without-wrap --without-pam \
		--disable-ftp --disable-ftpd \
		--disable-telnet --disable-telnetd \
		--disable-talk --disable-talkd \
		--disable-rlogin --disable-rlogind \
		--disable-rsh --disable-rshd \
		--disable-rexec --disable-rexecd \
		--disable-rcp --disable-hostname \
		--disable-tftp --disable-tftpd \
		--disable-ping --disable-ping6 \
		--disable-logger --enable-syslogd \
		--disable-inetd --disable-whois \
		--disable-uucpd --disable-ifconfig --disable-traceroute \
		|| return 1
        make || return 1
}

check() {
  cd "$srcdir/${_pkgname}-${pkgver}"
  make check
}

package() {
	cd "$_builddir"
	make DESTDIR="${pkgdir}" install
	#binary installed to /usr/sbin not bin
	rm -rf $pkgdir/usr/bin

	#install init script & config defaults
        install -m755 -D "$srcdir"/$pkgname.initd \
                "$pkgdir"/etc/init.d/$pkgname || return 1
        install -m644 -D "$srcdir"/$pkgname.confd \
                "$pkgdir"/etc/conf.d/$pkgname || return 1
	install -m644 -D "$srcdir"/syslog.conf \
                "$pkgdir"/etc/syslog.conf || return 1
	install -m644 -D "$srcdir"/inetutils-syslogd.logrotate \
                "$pkgdir"/etc/logrotate.d/inetutils-syslogd || return 1
}

md5sums="944f7196a2b3dba2d400e9088576000c  inetutils-1.9.1.tar.gz
6f0deb2a07439638161d03fd887d4fad  inetutils-syslogd.initd
edf3f502d9f2bf49c5da8cb37a927d06  inetutils-syslogd.confd
506560780445d5a7b30e2e3c96efa19d  syslog.conf
9980ae54a3791c7f9d1d3baa04698e2a  inetutils-syslogd.logrotate"
sha256sums="02a9ebde8a198cb85f87545b9d88fb103a183958139864a85fe9e027ad79ff2b  inetutils-1.9.1.tar.gz
1cf71f3656dceba3ddf0543a43a98e644a0b42999ba80b9f72318ee578c9ff53  inetutils-syslogd.initd
86105f0a0105f50275f7381b5d7fe603b8d854a0e6753c2f06f6d0c234562948  inetutils-syslogd.confd
a991140072f0ff1a0d3b3e593eb5935fcca0c00f93436022b9055c7450decdf9  syslog.conf
2b3e73b1a808cabd54dd3c3b78573cdf759422fa3c7b64f15838ce0830edaa31  inetutils-syslogd.logrotate"
sha512sums="69267bfa3cae34f6145caad668dc2e9385701fb52a144640e9893fa7f0b7694eacd1fe579de3fb7190e8485b26c00337ded136488694c399b0fc290f7eec303c  inetutils-1.9.1.tar.gz
e70d0e244fcc30e94f846b82b4ec7318b5582f512bd715fb5bd9178d7be5ede0e5b53e29431a2db5177ce2f31fc306900b3a1297a658e84b2671f3ad5153b81c  inetutils-syslogd.initd
82968692b4fe79706aacaeb1021b343288dc4f1d86925481796dac1f743a8269976ce86bf446cd0c16d246b918e5822e312660b201407eb7031a17cb398c9513  inetutils-syslogd.confd
5abb2a0309c9e180d7cacf97917044a8d3573fdf4d5902d757788fb687800900b47a02c6ec4a113475931176b52a1c2ba0771452bfb301a11b5aa0230377872d  syslog.conf
30741cf17a86a0bf39404882711d827e200a2d22cdba873e49f1a871f8d113cfe5bb1ddf3206c44be888be15aa09104656f9bd26406abb42c9b6fed0624d0bfb  inetutils-syslogd.logrotate"
