# Contributor: Sören Tempel <soeren+alpine@soeren-tempel.net>
# Maintainer: Sören Tempel <soeren+alpine@soeren-tempel.net>
pkgname=dma
pkgver=0.11
pkgrel=0
pkgdesc="A small Mail Transport Agent from DragonFly BSD"
url="https://github.com/corecode/dma"
arch="all"
license="BSD"
depends=""
depends_dev=""
makedepends="bison flex libbsd-dev bsd-compat-headers openssl-dev"
install=""
options="suid"
subpackages="$pkgname-doc"
options="suid"
source="$pkgname-$pkgver.tar.gz::https://github.com/corecode/$pkgname/archive/v$pkgver.tar.gz
	musl-fixes.patch"

_builddir="$srcdir"/$pkgname-$pkgver
build() {
	make -C "$_builddir" || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" PREFIX=/usr install || return 1

	# Install additional documentation files.
	mkdir -p "$pkgdir"/usr/share/doc/$pkgname/examples
	install -m644 README.markdown TODO \
		"$pkgdir"/usr/share/doc/$pkgname/ || return 1
	install -m644 *.conf \
		"$pkgdir"/usr/share/doc/$pkgname/examples/ || return 1
}

md5sums="4090572921fc33be0977f4010881b501  dma-0.11.tar.gz
458a0f8aa745843556dccf4a9fdfe251  musl-fixes.patch"
sha256sums="288bd57f17aba696b6423b1fa0cd0f7d9b7228d32811f1cd7b821d5f020051b8  dma-0.11.tar.gz
a46013b72a6e9b6b5ed2badbd590c6e27b426c2fac7e8599764de5cab068674d  musl-fixes.patch"
sha512sums="8ccf85a921da12cbf5b9f2c93dd96da91d2acdace979ed4a6b37af94e72441bf654ac65525fc2c1118c1b16136278de4daeafc753dcaf4300a017e317f83fc4d  dma-0.11.tar.gz
7aac2bd424c8196ecc882e5f4a3c51a1f245ca7c4b112804ddf29e49bb7c4925337038700582c8deaaa84fa2010a4c4d477ba0ca7e881a3a4734333edc0c4c35  musl-fixes.patch"
