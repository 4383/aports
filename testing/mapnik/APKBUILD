pkgname=mapnik
pkgver=2.2.0
pkgrel=0
pkgdesc="Toolkit and API for developing mapping application"
url="http://mapnik.org/"
arch="all"
license="LGPL"
options=""
depends="python ttf-dejavu"
makedepends="freetype-dev libxml2-dev zlib-dev icu-dev proj4-dev
	     libjpeg-turbo-dev libpng-dev tiff-dev boost-dev
	     sqlite-dev postgresql-dev cairo-dev py-cairo-dev"
subpackages="$pkgname-dev"
source="http://mapnik.s3.amazonaws.com/dist/v$pkgver/mapnik-v$pkgver.tar.bz2
	"

_builddir="$srcdir"/$pkgname-v$pkgver
prepare() {
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build () {
	cd "$_builddir"
	sh configure \
		DESTDIR="$pkgdir" \
		SYSTEM_FONTS="/usr/share/fonts/TTF/" \
		CUSTOM_CFLAGS="$CFLAGS" \
		CUSTOM_LDFLAGS="$LDFLAGS" \
		PREFIX="/usr" \
		|| return 1
	make
}

package() {
	cd "$_builddir"
	make install || return 1
}

md5sums="b5357848dc6806bcd43e245f4fdefdaf  mapnik-v2.2.0.tar.bz2"
sha256sums="9b30de4e58adc6d5aa8478779d0a47fdabe6bf8b166b67a383b35f5aa5d6c1b0  mapnik-v2.2.0.tar.bz2"
sha512sums="6e0bf5027865842a2648ab073b81785dd2c0d8ddb8c75da73caa8aa0c0697e8129ae7e2899f694d44ee1d3de2f207b285abff8e0a0616774564ac6e6b1e774ce  mapnik-v2.2.0.tar.bz2"
