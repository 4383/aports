# Contributor:
# Maintainer: Fabian Affolter <fabian@affolter-engineering.ch>
pkgname=chntpw
pkgver=110511
pkgrel=0
pkgdesc="Change passwords in Windows SAM files"
url="http://pogostick.net/~pnh/ntpasswd/"
arch="all"
license="GPL2"
depends=""
depends_dev=""
makedepends="$depends_dev openssl-dev"
install=""
subpackages=""
source="http://pogostick.net/~pnh/ntpasswd/$pkgname-source-$pkgver.zip"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	make CC="${CC:-gcc}" CFLAGS="$CFLAGS -DUSEOPENSSL" LIBS="-lcrypto" \
		chntpw cpnt reged || return 1
}

package() {
	cd "$_builddir"
	install -d "$pkgdir"/usr/bin
	install chntpw cpnt reged "$pkgdir"/usr/bin/
}

md5sums="a3fb358d1adec589cd6bc8dedf68896c  chntpw-source-110511.zip"
sha256sums="593514ca8601adb4091d951499b916dfdac2bd34b325d307237fa52ca572b5b7  chntpw-source-110511.zip"
sha512sums="2a0b3638df40481d0650a5fb524b37896db253db83eb8e12836a3f59f12df59bea89ae92710e28bd08dc01f6fa806789be118397fd097732f7132571d3057d56  chntpw-source-110511.zip"
