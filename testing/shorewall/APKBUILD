# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=shorewall
pkgver=4.5.20
pkgrel=0
pkgdesc="Core libraries for Shorewall"
url="http://www.shorewall.net/"
arch="noarch"
license="GPL-2"
depends="shorewall-core perl iptables iproute2"
# coreutils for install -T
makedepends="coreutils bash"
replaces=""
subpackages="$pkgname-doc"
source="http://www1.shorewall.net/pub/shorewall/${pkgver%.*}/shorewall-$pkgver/$pkgname-$pkgver.tar.bz2
	shorewall.initd
	"

_builddir="$srcdir/$pkgname-$pkgver"
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	./configure MANDIR=/usr/share/man SBINDIR=/usr/sbin || return 1
}

package() {
	cd "$_builddir"
	DESTDIR="$pkgdir" ./install.sh || return 1
	rm -f "$pkgdir"/etc/init.d/shorewall
	install -m755 "$srcdir"/shorewall.initd "$pkgdir"/etc/init.d/shorewall
}

md5sums="d13bb8d730b3f3697895674c123dc4e5  shorewall-4.5.20.tar.bz2
a59c0ec3f299f6a383d33aacbdc83e44  shorewall.initd"
sha256sums="645336e86ba08e14a5565209b461855fbc9034f3718f7bb39db92f835e6f6aac  shorewall-4.5.20.tar.bz2
ee8cff251a24cc5f9b31e835682f6fc7d9f01625e93c2f9d8c82c859dad09e8e  shorewall.initd"
sha512sums="320cb1757a4f50726d68b2925edb63c4c37b5ab48dbd798f9447a8cd7d6634e55479f1942c25a60c8791432bf67231d2a27b51c62d969557e6a06c6367381016  shorewall-4.5.20.tar.bz2
365819451ee3a412c321eea4d3011c548295f00f9dd2cbb996c84a61be77eae859d568077677f1acad64af2a642028e2ef577a3757239703153b3293232afade  shorewall.initd"
