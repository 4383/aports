# Contributor: Carlo Landmeter <clandmeter@alpinelinux.org>
pkgname=telegram-cli
pkgver=0.01_git20140127
verbase=0.01
pkgrel=0
pkgdesc="Command line telegram client"
url="https://github.com/vysheng/tg"
arch="all"
license="GPL3"
depends=""
depends_dev="readline-dev openssl-dev libconfig-dev"
makedepends="$depends_dev"
subpackages=""
source="http://dev.alpinelinux.org/archive/$pkgname/$pkgname-$pkgver.tar.gz
	0001-uclibc-does-not-provide-aio.h.patch"
giturl="git://github.com/vysheng/tg.git"
disturl="dev.alpinelinux.org:/archive/$pkgname/"

_builddir="$srcdir/$pkgname-$pkgver"

prepare() {
        local i
        cd "$_builddir"
        for i in $source; do
                case $i in
                *.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
                esac
        done
}

build() {
        cd "$_builddir"
        export LUA_INCLUDE="-I/usr/include/lua5.2"
	export LUA_LIBS="-Llua5.2"
	./configure --prefix=/usr \
                --sysconfdir=/etc \
                --mandir=/usr/share/man \
                --infodir=/usr/share/info \
                --localstatedir=/var \
		--enable-libconfig \
		--disable-liblua \
                || return 1
        make || return 1
}

package() {
        cd "$_builddir"
	mkdir -p "$pkgdir"/usr/bin || return 1
	cp telegram "$pkgdir"/usr/bin
}

md5sums="4753891325f51690d9fabab8e009b6ff  telegram-cli-0.01_git20140127.tar.gz
ed21dd0f9056fe3a8132894ccf943844  0001-uclibc-does-not-provide-aio.h.patch"
sha256sums="e06b0f09d2dcaaefde83abeb67aae3d16bee044eb93a6a725c04bf6d04570d2c  telegram-cli-0.01_git20140127.tar.gz
5a92614b40c50fcd5b5601c33d87edba421086eb777663bc6c43d18734b4cfea  0001-uclibc-does-not-provide-aio.h.patch"
sha512sums="e10112884e458eb123f65ffec8267c5f02f5ab6e78ee05024b2c5923c8e6ddb702ba8be9993d92af6a55c3e1ac957099af02fc6e1f8a157ea9fe1668b9036569  telegram-cli-0.01_git20140127.tar.gz
46725ec1d6255ddb359e8e33a73510461264451689f7bcc14233e3730a6cae26073b0629af18443c1ad6e7140748e75293349b97ac8d8cec21b0c10541a62333  0001-uclibc-does-not-provide-aio.h.patch"
