# Maintainer: Natanael Copa <natanael.copa@gmail.com>
_luaver=5.2
pkgname=lua$_luaver-sql-sqlite3
pkgver=2.3.0
pkgrel=0
pkgdesc="Lua $_luaver SQL driver for sqlite3"
url="http://www.keplerproject.org/luasql/"
arch="all"
license="MIT"
depends=""
makedepends="lua$_luaver-dev sqlite-dev"
install=
subpackages=
source="luasql-$pkgver.tar.gz::https://github.com/keplerproject/luasql/archive/v$pkgver.tar.gz"

build() {
	cd "$srcdir"/luasql-$pkgver
	local _sqlite_libs="$( pkg-config sqlite3 --libs )" || return 1
	local _lua_cflags="$( pkg-config lua$_luaver --cflags )" || return 1
	make CFLAGS="-fPIC $CFLAGS $_lua_cflags" \
		T=sqlite3 \
		DRIVER_LIBS="$_sqlite_libs" \
		|| return 1
}

package() {
	cd "$srcdir"/luasql-$pkgver
	install -D src/sqlite3.so "$pkgdir"/usr/lib/lua/$_luaver/luasql/sqlite3.so
}

md5sums="af9f0f3a2313a1fcf88c40700092048d  luasql-2.3.0.tar.gz"
sha256sums="e173ff7b17a2757951b4b2f67d3b1bfe04caad7185b68cffa7758ce822e25e9f  luasql-2.3.0.tar.gz"
sha512sums="62309cf6241ffab1ed32e718536a5c986168a7bb6fcf2cf55e884db5043d5ec473bbbb7c93b399dfc0a19f282e850f742452583ad0d973661a7f672b0f8da2d5  luasql-2.3.0.tar.gz"
