# Contributor: Carlo Landmeter <clandmeter@gmail.com>
# Maintainer:
pkgname=syncthing
pkgver=0.9.5
pkgrel=0
pkgdesc="Open Source Continuous File Synchronization"
url="http://syncthing.net/"
arch="all"
license="MIT"
depends=""
depends_dev=""
makedepends="$depends_dev godep go mercurial bash"
install=""
subpackages=""
source="syncthing-${pkgver}.tar.gz::https://github.com/syncthing/syncthing/archive/v$pkgver.tar.gz"

_builddir="$srcdir/src/github.com/syncthing"

prepare() {
	local i
	mkdir -p $_builddir
	mv $srcdir/$pkgname-$pkgver $_builddir/$pkgname
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"/$pkgname
	export GOPATH="$srcdir"
	./build.sh "" -tags noupgrade
}

package() {
	mkdir -p "$pkgdir"/usr/bin
	mv "$_builddir"/$pkgname/bin/* \
		"$pkgdir"/usr/bin || return 1
}

md5sums="034925c10154c5fbe2583e18c05c3314  syncthing-0.9.5.tar.gz"
sha256sums="df27d0920d77f82e8dc30bb95c40001828e70b6a7568156a6a47b7caf22765b4  syncthing-0.9.5.tar.gz"
sha512sums="ccfdea7a8e400c89abb031613104da4a16bdccd200d90181166773cafe7a2922025d26db002f017fa7139a25422304a743013d76d99d28c867757b6bf3b5f573  syncthing-0.9.5.tar.gz"
