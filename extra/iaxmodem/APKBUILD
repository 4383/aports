# Contributor: Cameron Banta <cbanta@gmail.com>
# Maintainer: Cameron Banta <cbanta@gmail.com>
pkgname=iaxmodem
pkgver=1.2.0
pkgrel=0
pkgdesc="Softmodem for hylafax that connects to VOIP gateway with IAX"
url="http://iaxmodem.sourceforge.net/"
license="GPL"
depends="uclibc tiff uclibc++"
makedepends="tiff-dev uclibc++-dev"
install=
subpackages="$pkgname-doc"
source="http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz"

build() {
	cd "$srcdir/$pkgname-$pkgver"
	export CXX=g++-uc
	./configure
	make || return 1
	install -m755 -s -D "$srcdir/$pkgname-$pkgver/iaxmodem" \
		"$pkgdir/sbin/iaxmodem"
	mkdir -p "$pkgdir/etc/iaxmodem"
	mkdir -p "$pkgdir/var/log/iaxmodem"

	#library licenses
	install -m644 -D "$srcdir/$pkgname-$pkgver/lib/libiax2/COPYING" \
		"$pkgdir"/usr/share/licenses/$pkgname/libiax2.COPYING
	install -m644 -D "$srcdir/$pkgname-$pkgver/lib/libiax2/COPYING.LIB" \
		"$pkgdir"/usr/share/licenses/$pkgname/libiax2.COPYING.LIB
	
	install -m644 -D "$srcdir/$pkgname-$pkgver/lib/spandsp/COPYING" \
		"$pkgdir"/usr/share/licenses/$pkgname/libspandsp.COPYING

	#docs
	install -m644 -D "$srcdir/$pkgname-$pkgver/README" \
		"$pkgdir/usr/share/doc/$pkgname/README"
	install -m644 -D "$srcdir/$pkgname-$pkgver/FAQ" \
		"$pkgdir/usr/share/doc/$pkgname/FAQ"

	install -m644 -D "$srcdir/$pkgname-$pkgver/iaxmodem-cfg.ttyIAX" \
		"$pkgdir/usr/share/doc/$pkgname/iaxmodem-cfg.ttyIAX"
	install -m644 -D "$srcdir/$pkgname-$pkgver/iaxmodem.init.debian" \
		"$pkgdir/usr/share/doc/$pkgname/iaxmodem.init.debian"
	install -m644 -D "$srcdir/$pkgname-$pkgver/config.ttyIAX" \
		"$pkgdir/usr/share/doc/$pkgname/config.ttyIAX"

	# install -m755 -D "$srcdir"/$pkgname.initd \
	#	"$pkgdir"/etc/init.d/$pkgname
	# install -m644 -D "$srcdir"/$pkgname.confd \
	#	"$pkgdir"/etc/conf.d/$pkgname
}

md5sums="f8b26cfeed188e5c1dcbc5ae5ef923b3  iaxmodem-1.2.0.tar.gz"
