# Contributor: Carlo Landmeter <clandmeter at gmail>
# Maintainer: Carlo Landmeter <clandmeter at gmail>
pkgname=clamav
pkgver=0.94.2
pkgrel=2
pkgdesc="An anti-virus toolkit for UNIX"
url="http://www.clamav.net/"
license="GPL"
depends="zlib gmp"
install="$pkgname.pre-install $pkgname.post-install"
makedepends="gmp-dev zlib-dev"
subpackages="$pkgname-doc $pkgname-dev"
source="http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz
	clamd.initd
	clamd.confd
	freshclam.initd
	freshclam.confd
	clamav-0.94.2-nls.patch
	$install"

build() {
	cd "$srcdir/$pkgname-$pkgver"

	patch -p0 -i "$srcdir/clamav-0.94.2-nls.patch" || return 1

	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info \
		--disable-clamav
	make || return 1
	make DESTDIR="$pkgdir" install

	install -m755 -D "$srcdir"/clamd.initd "$pkgdir"/etc/init.d/clamd
	install -m644 -D "$srcdir"/clamd.confd "$pkgdir"/etc/conf.d/clamd
        install -m755 -D "$srcdir"/freshclam.initd "$pkgdir"/etc/init.d/freshclam
	install -m644 -D "$srcdir"/freshclam.confd "$pkgdir"/etc/conf.d/freshclam
	mkdir -p "$pkgdir"/var/run/clamav "$pkgdir"/var/log/clamav
}

md5sums="1181e6d62341b84708f126cc353f7ebf  clamav-0.94.2.tar.gz
04f32738c037c96c3fd2c4fa7781fc7a  clamd.initd
e84205681f64c07af9ec5b6a3dd8bc38  clamd.confd
fe3cfca9e1355183117936bea6fc6783  freshclam.initd
e84205681f64c07af9ec5b6a3dd8bc38  freshclam.confd
328a0c3449a6b516e443d7db5a0d4d01  clamav-0.94.2-nls.patch
275e05587e2da782781829a1862d57b1  clamav.pre-install
ec4d600097a15e64dfb714e7739a1804  clamav.post-install"
