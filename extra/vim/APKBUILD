# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=vim
_srcver=7.2
_patchver=079
pkgver=$_srcver.$_patchver
pkgrel=0
pkgdesc="advanced text editor"
url="http://www.vim.org"
license='GPL'
depends="ncurses ncurses-terminfo"
makedepends="ncurses-dev"
subpackages="$pkgname-doc"

# those patches dont apply. exclude them
_patchexclude="007 036 041 049 071 072 074"

# use "abuild patchlist >> APKBUILD" to generate the list of patches
source="ftp://ftp.vim.org/pub/vim/unix/vim-7.2.tar.bz2
	vimrc
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.001
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.002
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.003
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.004
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.005
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.006
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.008
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.009
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.010
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.011
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.012
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.013
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.014
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.015
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.016
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.017
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.018
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.019
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.020
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.021
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.022
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.023
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.024
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.025
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.026
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.027
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.028
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.029
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.030
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.031
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.032
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.033
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.034
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.035
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.037
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.038
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.039
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.040
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.042
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.043
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.044
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.045
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.046
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.047
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.048
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.050
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.051
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.052
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.053
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.054
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.055
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.056
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.057
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.058
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.059
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.060
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.061
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.062
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.063
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.064
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.065
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.066
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.067
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.068
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.069
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.070
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.073
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.075
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.076
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.077
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.078
	ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.079
	"

# this function is only for generating the patches list
excluded() {
	local i
	for i in $_patchexclude; do
		if [ "$1" = "$i" ]; then
			return 0
		fi
	done
	return 1
}

# this generates the patches list
patchlist() {
	local i j
	for i in $(seq 1 $_patchver); do
		local v=$(printf "%0.3i" $i)
		if excluded $v; then
			continue
		fi
		echo -e "\tftp://ftp.vim.org/pub/vim/patches/7.2/$_srcver.$v"
	done
}
	

build() {
	local i
	cd "$srcdir/${pkgname}72"

	for i in ../"$_srcver".* ; do
		msg "Applying ${i##*/}"
		patch -p0 < $i || return 1
	done

	./configure --prefix=/usr \
		--without-x \
		--disable-nls
	make || return 1
	make DESTDIR="$pkgdir/" install
	install -D "$srcdir"/vimrc "$pkgdir"/etc/vim/vimrc
}

md5sums="f0901284b338e448bfd79ccca0041254  vim-7.2.tar.bz2
f5b1c4b4a8ffdf3acbedb00ed0ac131a  vimrc
7c2dc4a956cf315e546e347bc349968c  7.2.001
7f16f80814f1e071a689806c2056b39d  7.2.002
0de916fdfd450a4a0d95bed44ae2c398  7.2.003
25cc99ad42b25b16a4610e2fad9cdab4  7.2.004
a5b7b1c7c5b75aa7d730b0b9aa491558  7.2.005
a93a72cd40c37da91dc634dc8dddefec  7.2.006
e65c8c2223eea5289d8cbef2e867a5de  7.2.008
ab1566b69bd0e0c82a866f00675ffe0e  7.2.009
d69f559bfb5436c157e8069a829ca50d  7.2.010
05334a6bb31402bfd49d82ea6f59a57b  7.2.011
a11dcd5552f36544a9e27978b5359935  7.2.012
8bc70978291aadea9c82072b623c955d  7.2.013
a87826187cb77ad2e567a40c1609eea4  7.2.014
47a466fbfdbca616f519fc4afa0432df  7.2.015
fd08bac73d7ffcabf53bd25a63dff893  7.2.016
0f0284d87f6f52101802dbe1a45d54c3  7.2.017
38d06ba325b716c1177c1012d781bada  7.2.018
661ca021fb70c24ef4df229512cfb14b  7.2.019
cb2c5ca0f9a9718fb635874925432dd8  7.2.020
9073d2311ae7101c143237a45afb4efa  7.2.021
48ccb0deec77a3bb91bf967dacb43492  7.2.022
d77ed8aa4de30d4dbd17a7998ae8f269  7.2.023
cf983237e5e866ef459870fee2754bac  7.2.024
ab32defa4b2cfb509ccb34d4858b1223  7.2.025
5e96c227c7765b1e0f03f44cb5b750f6  7.2.026
f26b7ee0f271eacbb3652dbdf92dd860  7.2.027
fc54a3d35bdc7b7a7660c6d2274f7b74  7.2.028
d53630dc8f3a823f54dfba73dcd47b36  7.2.029
208f8ed2db2665ebfc17674f78d47c6d  7.2.030
3387583af86faa78e10be979214071f3  7.2.031
eca017686205ec8658bf9fa8c73f7af6  7.2.032
88c91b84ffc772fd57f86475f7ba90f1  7.2.033
c3d6eaaa0b74df423f90afaaafa3a0de  7.2.034
f4c35dae581d671dc271407d377f7199  7.2.035
1c6501c366cc8df205955f3e4d3ebba9  7.2.037
ed3479ddb4ded7b74c82af5e50b0e4a6  7.2.038
2a61f28f6f793c5a43abded6e59b6506  7.2.039
4c493255ae227498016f30a0002ec1cc  7.2.040
99baedef8a9c908774b7ed74deacf184  7.2.042
87035b208c9377c28d796b1e48ab8aac  7.2.043
b127def242996b4e7d7e870cab3e4b45  7.2.044
5233327e4c97d310e3793b223892ea8d  7.2.045
9ecfa0454f5a329996b273cb12369962  7.2.046
35e16f4e7198e861a71322fee2cb7909  7.2.047
84ef9658181f49bfbd7a61ec87dd0b8d  7.2.048
27a9700e39e266a31df702677acea52c  7.2.050
89ce3f5b513510fb288a4a301e7494c7  7.2.051
5992bb56b07a9b9b4e3504f1f2f2c79c  7.2.052
3fe570c1317fee8a71ede17197358e02  7.2.053
5b047e8e8413c4807d74a6d9716474a2  7.2.054
c276080d95de2fafa9706f247c35ff74  7.2.055
5b65e2654a78dcc4c15dc49dbce5418e  7.2.056
cab5a9ddf0ab180089d84bf9ec685574  7.2.057
80991ff846f88222e3266dab6b07e2b8  7.2.058
89cede639caf8beed5ea071790445e26  7.2.059
9781d833263060308a9622dd097ad378  7.2.060
71b4bc625bc1cdd68747262d329db551  7.2.061
9243a773d19966dbfd98b7aff3fe3ab7  7.2.062
08155711f8db2dfce217ec5a34253a76  7.2.063
fd692f9624ec0170800b3d9a2a9a53cb  7.2.064
ee1a8dc311c7580608e3bd2196a7d042  7.2.065
8d1d5f8aefabf0abcb54de5247893246  7.2.066
fa0ccca2decdd2db64947658b04b8c99  7.2.067
ca5ab057205023613020ca920d903028  7.2.068
f3e6f3dd76278a9f7e396955faa4ca31  7.2.069
805cdc76da46e73ae908038e09efae16  7.2.070
0d77ee653eabe4b7fdb640d768d7c1be  7.2.073
d7eccf57f8fc04cf0385f85eff3d989a  7.2.075
99750c988d0c48f56cb12a04b78aebc2  7.2.076
1967f5e7fa4cec07bd67cc47925ec3c8  7.2.077
7b285d2ba24fdd2390b4aaba08fcf5f6  7.2.078
a3385578174d3867f17ab287276db49b  7.2.079"
