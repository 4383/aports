Fix nat-oa parsing when rekeying.

From: Timo Teras <timo.teras@iki.fi>


---

 src/racoon/handler.c |   11 +++++++++++
 1 files changed, 11 insertions(+), 0 deletions(-)


diff --git a/src/racoon/handler.c b/src/racoon/handler.c
index 6f91beb..960b5b3 100644
--- a/src/racoon/handler.c
+++ b/src/racoon/handler.c
@@ -736,6 +736,17 @@ initph2(iph2)
 		oakley_delivm(iph2->ivm);
 		iph2->ivm = NULL;
 	}
+
+#ifdef ENABLE_NATT
+	if (iph2->natoa_src) {
+		racoon_free(iph2->natoa_src);
+		iph2->natoa_src = NULL;
+	}
+	if (iph2->natoa_dst) {
+		racoon_free(iph2->natoa_dst);
+		iph2->natoa_dst = NULL;
+	}
+#endif
 }
 
 /*
