# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=cpufrequtils
pkgver=005
pkgrel=0
pkgdesc="Userspace tools for the kernel cpufreq subsystem"
url="http://www.kernel.org/pub/linux/utils/kernel/cpufreq/cpufrequtils.html"
license="GPL"
subpackages="$pkgname-dev $pkgname-doc"
depends="sysfsutils uclibc"
makedepends="sysfsutils-dev uclibc libtool"
source="http://www.kernel.org/pub/linux/utils/kernel/cpufreq/$pkgname-$pkgver.tar.bz2
	cpufrequtils-005-build.patch
	cpufrequtils-005-nls.patch
	$pkgname.initd
	$pkgname.confd"

build ()
{
	cd "$srcdir"/$pkgname-$pkgver
	for i in ../*.patch; do
		msg "Applying $i..."
		patch -p1 < $i || return 1
	done

	# distcc and ccache makes libtool confused about the tag.
	# we save 4k by disabling the 2.4 kernel support (PROC=false)
	make -j1 LIBTOOL_OPT="--tag=CC --silent" \
		NLS=false \
		PROC=false \
		|| return 1
	make mandir=/usr/share/man \
		NLS=false \
		DESTDIR="$pkgdir" \
		install || return 1
	install -D -m755 ../$pkgname.initd "$pkgdir"/etc/init.d/$pkgname
	install -D -m644 ../$pkgname.confd "$pkgdir"/etc/conf.d/$pkgname
}
md5sums="73a41589fe74b73fc530f4179f2c6142  cpufrequtils-005.tar.bz2
0b007dbd9fcb3acf55a8570f21b2f5d4  cpufrequtils-005-build.patch
d88bee4d20c8b72d8edd50c2af5d4600  cpufrequtils-005-nls.patch
b9b80ef2f1b6c5e7ce0476037a8bce6b  cpufrequtils.initd
d47ff635eef03248c633486eaeec191d  cpufrequtils.confd"
