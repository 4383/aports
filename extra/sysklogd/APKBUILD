# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=sysklogd
pkgver=1.5
pkgrel=0
pkgdesc="System and kernel log daemons"
url="http://www.infodrom.org/projects/sysklogd/"
license="GPL BSD"
subpackages="$pkgname-doc"
depends="logrotate"
makedepends=""
source="http://www.infodrom.org/projects/$pkgname/download/$pkgname-$pkgver.tar.gz
	sysklogd.logrotate
	sysklogd.initd
	sysklogd.confd
	sysklogd-1.4.2-caen-owl-klogd-drop-root.diff
	sysklogd-1.4.2-caen-owl-syslogd-bind.diff
	sysklogd-1.4.2-caen-owl-syslogd-drop-root.diff
	sysklogd-1.5-build.patch
	LICENSE"

build ()
{
	cd "$srcdir"/$pkgname-$pkgver

	for i in ../*.patch ../*.diff; do
		msg "Applying $i..."
		patch -p1 < $i || return 1
	done

	export CFLAGS="$CFLAGS -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE" 
	make || return 1
	install -d "$pkgdir"/usr/sbin
	install -d "$pkgdir"/usr/share/man/man5 
	install -d "$pkgdir"/usr/share/man/man8
	make INSTALL=install prefix="$pkgdir" install
	install -D -m644 ../sysklogd.logrotate \
		"$pkgdir"/etc/logrotate.d/sysklogd
	install -D -m755 ../sysklogd.initd "$pkgdir"/etc/init.d/sysklogd
	install -D -m644 ../sysklogd.confd "$pkgdir"/etc/conf.d/sysklogd
	install -D -m644 ../LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}
md5sums="e053094e8103165f98ddafe828f6ae4b  sysklogd-1.5.tar.gz
40304e92b2f6a92e252de24c5e3ca88e  sysklogd.logrotate
9332657663a9f4286e5c61d22c46378f  sysklogd.initd
e25d7b583b7e4bd8be503b89e1771e90  sysklogd.confd
3b7ba3aa6519f96f11165a7d5900a8b1  sysklogd-1.4.2-caen-owl-klogd-drop-root.diff
4715e1dd2deb7a9ac137e004210e3154  sysklogd-1.4.2-caen-owl-syslogd-bind.diff
6c0a416e40a678cf99c454b0e98185c9  sysklogd-1.4.2-caen-owl-syslogd-drop-root.diff
c71826d1a4f3f7e8ffa57adbfc24f1ce  sysklogd-1.5-build.patch
7930f7ff5038e1318511624e348581cc  LICENSE"
