# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@alpinelinux.org>

pkgname=xtrabackup
pkgver=2.1.6
pkgrel=1
pkgdesc='MySQL non-blocking backup solution for InnoDB and XtraDB data'
arch=all
url='http://www.percona.com/software/percona-xtrabackup/'
license='GPL'
makedepends='bash bison cmake ncurses-dev libaio-dev libgcrypt-dev
             py-setuptools py-sphinx zlib-dev'
source="http://percona.com/redir/downloads/XtraBackup/XtraBackup-$pkgver/source/percona-xtrabackup-$pkgver.tar.gz"

build() {
  cd "$srcdir"/percona-xtrabackup-$pkgver
  utils/build.sh innodb55 || return 1
}

package() {
  cd "$srcdir"/percona-xtrabackup-$pkgver

  install -D innobackupex "$pkgdir"/usr/bin/innobackupex
  install -D src/xtrabackup_55 "$pkgdir"/usr/bin/xtrabackup_55
  install -D src/xbcrypt "$pkgdir"/usr/bin/xbcrypt
  install -D src/xtrabackup_innodb55 "$pkgdir"/usr/bin/xbstream

  ln -s /usr/bin/xtrabackup_55 "$pkgdir"/usr/bin/xtrabackup
}

md5sums="577cc44b70e68b35558c931a3a8d13ef  percona-xtrabackup-2.1.6.tar.gz"
sha256sums="40af775cc818bb45ef9c49bc24eb414742005ee20c2474f9895dff6649351a79  percona-xtrabackup-2.1.6.tar.gz"
sha512sums="126df9fd18d8269811e62a71ca21952859f5adb5196f71b6158fd04153e7e1512ff67b52a06c61dad96c50495dd4b952bc331e737e11b521cfd482238266bd33  percona-xtrabackup-2.1.6.tar.gz"
