# Contributor: William Pitcock <nenolod@dereferenced.org>
# Maintainer: William Pitcock <nenolod@dereferenced.org>
pkgname=libmcs
pkgver=0.7.2
pkgrel=2
pkgdesc="library for configuration system abstraction"
url="http://atheme.org/project/mcs"
arch="all"
license="ISC"
depends=
makedepends="libmowgli-dev autoconf"
install=
subpackages="$pkgname-dev"
source="http://distfiles.atheme.org/$pkgname-$pkgver.tgz
	libmowgli2.patch"

_builddir="$srcdir"/$pkgname-$pkgver

prepare() {
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
	autoconf || return 1
	# workaround bug in busybox
	sed -e "/touch/s/0001010000/200001010000/g" \
		-i configure
}

build() {
	cd "$_builddir"
	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install
}

md5sums="c47fc81f3efacaa0a5a0b8fd14f9d48e  libmcs-0.7.2.tgz
2ed26ea0cbba425f2bf324a675a8cb84  libmowgli2.patch"
sha256sums="989f8dc4598ffab2f6a5648ba40f12d2e2c392b7ec6e66eeef194591565e60d9  libmcs-0.7.2.tgz
6692f7ff46f9cf0aad82731e73af3d7bc9dcf3dd74d7feb05646439b482ed47c  libmowgli2.patch"
sha512sums="798420299d7aa756a949ebfb21ae13effe146d222f1c09233ff64736c4f24c5aa132520d3486ab9460cd38632f67e47e619148acfffa74d82638a5b3cbf0c0d6  libmcs-0.7.2.tgz
b491d82cc10082091a8d5177c3cc17bcfd5cc6edcb334c48e5a4af2bc02ec709d4025dc4f68d06397b1a91d82da88acc4bcf852d98fc1f979d61fce37fe9939f  libmowgli2.patch"
