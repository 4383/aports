# Contributor: William Pitcock <nenolod@dereferenced.org>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=libev
pkgver=4.11
pkgrel=1
pkgdesc="event dispatch library"
url="http://libev.schmorp.de/"
arch="all"
license="BSD GPL"
depends=
depends_dev=
makedepends="$depends_dev autoconf automake libtool"
install=""
subpackages="$pkgname-dev $pkgname-doc"
source="http://dist.schmorp.de/${pkgname}/${pkgname}-${pkgver}.tar.gz
	libev-4.11-Add-pkgconfig-support.patch
	libev-4.11-Modernize-the-configure.ac.patch
	libev-4.11-Respect-the-CFLAGS-if-defined.patch
	"

_builddir="${srcdir}/${pkgname}-${pkgver}"
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
	libtoolize --force && aclocal && autoconf && autoheader \
		&& automake --add-missing
}

build() {
	cd "$_builddir"
	./configure --prefix=/usr \
		--sysconfdir=/etc || return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make -j1 DESTDIR="$pkgdir" install || return 1
	rm "$pkgdir"/usr/include/event.h \
		"$pkgdir"/usr/lib/*.la
}

md5sums="cda69b858a1849dfe6ce17c930cf10cd  libev-4.11.tar.gz
acec6b40b5ebea613fb0829f84e8a48b  libev-4.11-Add-pkgconfig-support.patch
7e4870998ed6e0d1350181c906c7aef5  libev-4.11-Modernize-the-configure.ac.patch
4fc88fe789946b6cf44a04dc4d39cfc2  libev-4.11-Respect-the-CFLAGS-if-defined.patch"
sha256sums="9f55f16ff6e4d60a1b1fa7f4962af69768468f0d7c362aab6387f52020938cdf  libev-4.11.tar.gz
2228eb682631655678e172a647238bf9c00b5ea8e732b45795e45fe5d79e1ffb  libev-4.11-Add-pkgconfig-support.patch
b7e38bc90a2f1b688726ef24382d4c65f6381b0708f1f674bcc1c8df1df4e2d6  libev-4.11-Modernize-the-configure.ac.patch
c581f42f82c9d63a1a9d56d64de35eadd40773cfa1f076594b4c48cd6b1533cc  libev-4.11-Respect-the-CFLAGS-if-defined.patch"
sha512sums="802d9f28781140ccb2634e80b7ca73f694203d95da0b4d3ee38edff4c89db94d3073a61a7b95af0ede5865ade6b48f4960c9f33ba73e088779eedd1e396a8817  libev-4.11.tar.gz
b5bc1b5ed1e605cd45a01adce70c1a97188c0b46a36333f12eccd4407c95d96f18adff90ee8c5733c1783a36b4adc5ef67d6b470104339a1ac5c4539a2a4599e  libev-4.11-Add-pkgconfig-support.patch
bc4070d8bce60aa65f93aa000bf186f21604880d0c1c4f096a036f6d72d2a2b2a2513e9fc7375515ce73bbae7ea9baec0369dc2978720a13a317dc713fdc6f81  libev-4.11-Modernize-the-configure.ac.patch
caeb95c0610f93f8cba6e3d06414b004ce9d19bacda0164d823b079ba7a0395be46718bb5f0479456bf5c31a63aa6d74ba4a4395f632de34a5dc68738bdbf3d9  libev-4.11-Respect-the-CFLAGS-if-defined.patch"
