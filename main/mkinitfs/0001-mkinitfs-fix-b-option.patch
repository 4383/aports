From d64e5baefc7e1ca75e6f1ca50f28e96b30991c6a Mon Sep 17 00:00:00 2001
From: Natanael Copa <ncopa@alpinelinux.org>
Date: Thu, 3 Sep 2009 09:06:54 +0000
Subject: [PATCH] mkinitfs: fix -b option

---
 mkinitfs.in |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/mkinitfs.in b/mkinitfs.in
index e18b59c..0332151 100755
--- a/mkinitfs.in
+++ b/mkinitfs.in
@@ -16,7 +16,7 @@ _cp() {
 	local i
 	if [ -n "$list_sources" ]; then
 		for i in "$@"; do
-			echo $i
+			echo "$basedir"/$i
 		done
 		return
 	fi
@@ -24,7 +24,7 @@ _cp() {
 	for i in "$@"; do
 		local dest="$tmpdir"/${i%/*}
 		mkdir -p "$dest"
-		cp -flLpR "$i" "$dest" 2>/dev/null || cp -pR "$i" "$dest"
+		cp -flLpR "$basedir"/"$i" "$dest" 2>/dev/null || cp -pR "$i" "$dest"
 	done
 }
 
@@ -121,7 +121,7 @@ initfs_kmods() {
 	[ -z "$list_sources" ] && rm -rf "$tmpdir"/lib/modules
 	files=$(find_kmods)
 	for file in $files; do
-		_cp "$basedir"/$file
+		_cp $file
 	done
 	[ -z "$list_sources" ] && depmod $kernel -b "$tmpdir"
 }
-- 
1.6.4.2

