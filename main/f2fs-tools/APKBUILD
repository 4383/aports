# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=f2fs-tools
pkgver=1.2.0
pkgrel=1
pkgdesc="Tools for Flash-Friendly File System (F2FS)"
url="http://sourceforge.net/projects/f2fs-tools/"
arch="all"
license="GPLv2+"
depends=""
depends_dev=""
makedepends="$depends_dev automake autoconf libtool util-linux-dev"
install=""
subpackages="$pkgname-doc"
#source="http://git.kernel.org/cgit/linux/kernel/git/jaegeuk/f2fs-tools.git/snapshot/f2fs-tools-$pkgver.tar.gz"
source="http://dev.alpinelinux.org/archive/f2fs-tools/f2fs-tools-$pkgver.tar.gz
	musl-fix-includes.patch
	"

_builddir="$srcdir"/f2fs-tools-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
	libtoolize --force && aclocal && autoheader && autoconf \
		&& automake --add-missing
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make install DESTDIR="$pkgdir" || return 1
	rm "$pkgdir"/usr/lib/*.la
}

md5sums="d27ad7cd56f6001f7e1d508d85eef195  f2fs-tools-1.2.0.tar.gz
58f111607726f2e4db5f5622359e621a  musl-fix-includes.patch"
sha256sums="243361c689d851f70feb0e5c97a93394392dc0629f965bcebda9ca825315f732  f2fs-tools-1.2.0.tar.gz
4eaa40dbac52ae4a83a09e5414557bab495afc2b0cb36085eef4c018ebfd42fd  musl-fix-includes.patch"
sha512sums="f259c354c849e84269a8218ad738b38e8a40ac39be1355d323dab6fdf5d58145759db229cceb51524462aad1ef14d3ee57df4c398bb40b3b5288a1869e5567ab  f2fs-tools-1.2.0.tar.gz
0d5d83d992acc0477e3de4981853c6e7757335fa2527621f023e49ca022394582c4085529a6e02e4514d6eccfe69bbe101c4ffa41ba9328df14155da6fe834db  musl-fix-includes.patch"
