# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=alpine-conf
pkgver=2.14.0
pkgrel=3
pkgdesc="Alpine configuration management scripts"
url=http://git.alpinelinux.org/cgit/$pkgname
arch="all"
license="GPL2"
depends="openrc"
source="http://dev.alpinelinux.org/archive/alpine-conf/alpine-conf-$pkgver.tar.xz
	0001-setup-bootable-use-UUID-on-new-USBs.patch
	0001-setup-bootable-move-syslinux.cfg-to-boot-syslinux-if.patch
	"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	make VERSION=$pkgver-r$pkgrel || return 1
}

package() {
	cd "$_builddir"
	make install PREFIX= DESTDIR="$pkgdir" || return 1
	for i in commit exclude include status update; do
		ln -s lbu "$pkgdir"/sbin/lbu_$i
	done
}

md5sums="94b82dd9d7a2c63aa6909238da3b44b3  alpine-conf-2.14.0.tar.xz
c0eeeebfb67b757c954a2f5100461a7b  0001-setup-bootable-use-UUID-on-new-USBs.patch
6568923677063d92939f85157baf0dc4  0001-setup-bootable-move-syslinux.cfg-to-boot-syslinux-if.patch"
sha256sums="14dc81845b16ffcbb39af9d0c5aeffab68166eec154c822b7c1c9c0697823d5b  alpine-conf-2.14.0.tar.xz
754a59868f069c4eb2321034f00539ea02e734ede1a483b9c9ec5360c788f8c1  0001-setup-bootable-use-UUID-on-new-USBs.patch
a410da99de3ef31a7a8a537aeb0fcd0ab53027e6febd95e15c1accdc49c135ee  0001-setup-bootable-move-syslinux.cfg-to-boot-syslinux-if.patch"
sha512sums="39aa74e676221475ce088d82b134563c3dd04a69e90919089d3876b6a4715f6df58aa156352a40d9f817414cbdb603350a3e9c15914fb254a24d8cef4acd6581  alpine-conf-2.14.0.tar.xz
3b2d2fb754421f7dd4c45c7212544c2f34587da9da10e777ee9de153dd77e70d016bf8b270d72dd6ee8299c99a17f2969bddef586afbdcac13b4d76c87bcc35e  0001-setup-bootable-use-UUID-on-new-USBs.patch
32bc771eba2b912623dd5b0c96571d0770afc370c354831353f2ebda5e396323f1cebfddc36d8ac3ee8028a1554a0163ecdaa9cca108097002282f838139f5b6  0001-setup-bootable-move-syslinux.cfg-to-boot-syslinux-if.patch"
