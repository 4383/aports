# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=abiword
pkgver=2.8.4
pkgrel=1
pkgdesc="A fully-featured word processor"
url="http://www.abisource.com"
license="GPL"
makedepends="pkgconfig libglade-dev libgsf-dev enchant-dev fribidi-dev wv-dev
	popt-dev jpeg-dev librsvg-dev bzip2-dev goffice-dev"
subpackages="$pkgname-dev $pkgname-doc $pkgname-plugin-goffice:goffice
	$pkgname-plugin-opendocument:opendocument"
source="http://www.abisource.com/downloads/$pkgname/$pkgver/source/$pkgname-$pkgver.tar.gz"

build() {
	cd "$srcdir"/$pkgname-$pkgver
	./configure --prefix=/usr \
		--enable-shared \
		--disable-static \
		--enable-plugins="opendocument goffice" \
		|| return 1
	make || return 1
}

package() {
	cd "$srcdir"/$pkgname-$pkgver
	make DESTDIR="$pkgdir" install
}

_plugin() {
	local plugin="$1"
	pkgdesc="$2"
	local dir="usr/lib/abiword-${pkgver%.*}/plugins"
	mkdir -p "$subpkgdir"/$dir
	mv "$pkgdir"/$dir/$plugin.so "$subpkgdir"/$dir/
}

goffice() {
	_plugin goffice "GOffice interaction plugin for AbiWord"
}

opendocument() {
	_plugin opendocument "OpenDocument support plugin for AbiWord"
}

md5sums="f782ecb8e07d07ec179f7a143353cc29  abiword-2.8.4.tar.gz"
