# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=gst-ffmpeg
pkgver=0.10.7
pkgrel=1
pkgdesc="Gstreamer FFMpeg Plugin"
url="http://www.gstreamer.net"
license="GPL"
makedepends="gstreamer-dev gst-plugins-base-dev liboil-dev ffmpeg-dev"
source="http://gstreamer.freedesktop.org/src/gst-ffmpeg/gst-ffmpeg-$pkgver.tar.bz2"

build ()
{
	cd "$srcdir"/gst-ffmpeg-$pkgver
	sed -i \
		-e 's,ffmpeg/avformat.h,libavformat/avformat.h,' \
		-e 's,ffmpeg/avcodec.h,libavcodec/avcodec.h,' \
		-e 's,ffmpeg/swscale.h,libswscale/swscale.h,' \
		ext/ffmpeg/gst*	\
		ext/libpostproc/gstpostproc.c \
		|| return 1

	export CFLAGS="$CFLAGS -fno-strict-aliasing"
	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--with-system-ffmpeg \
		--localstatedir=/var || return 1
	make || return 1
	make DESTDIR="$pkgdir" install || return 1
	rm -f "$pkgdir"/usr/lib/gstreamer-0.10/*.{l,}a
}

md5sums="6be89b26592f36ef631b22a68b8e06c4  gst-ffmpeg-0.10.7.tar.bz2"
