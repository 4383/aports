# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=imlib2
pkgver=1.4.5
pkgrel=6
pkgdesc="Library that does image file loading and saving as well as rendering, manipulation, arbitrary polygon support"
url="http://sourceforge.net/projects/enlightenment/"
arch="all"
license="BSD"
subpackages="$pkgname-dev $pkgname-doc"
depends=
depends_dev="freetype-dev libxext-dev libsm-dev"
makedepends="$depends_dev tiff-dev giflib-dev bzip2-dev
	libpng-dev libid3tag-dev libjpeg-turbo-dev zlib-dev util-linux-dev"
source="http://downloads.sourceforge.net/enlightenment/$pkgname-$pkgver.tar.bz2
	imlib2-giflib5.patch
	"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
	update_config_sub || return 1
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc/imlib2 \
		--x-libraries=/usr/lib \
		--disable-mmx \
		--disable-amd64 \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR=$pkgdir install || return 1
	rm "$pkgdir"/usr/lib/*.la \
		"$pkgdir"/usr/lib/imlib2/*/*.la || return 1
	install -Dm644 COPYING $pkgdir/usr/share/licenses/$pkgname/COPYING
}
md5sums="859e5fede51ec819f4314eee11da3ea5  imlib2-1.4.5.tar.bz2
afc474880648ab32d26bae7b04e40abb  imlib2-giflib5.patch"
sha256sums="24700d93931838d2149cc2b4b58b9355cc81ec11d297f101a98dbb8d1c5c945a  imlib2-1.4.5.tar.bz2
1b3ee77da360d072fa6a2d6b5a1198fcb53dbb07488b38d1ee013c68dc455aad  imlib2-giflib5.patch"
sha512sums="3016f68305bf431644c1ba159ce56f58cb31318bc36a8c794603bbcd8d7f19cb3408d671bc255ad47d105e5b6693f0985341a61592bc6f6a1f3674aed1862faa  imlib2-1.4.5.tar.bz2
7a99f7d59f320f02119411a5a078679ef4a549700fbcfe5987e1bc3e79787c6ea65e7779883b8e2b686bfae87827408fce7de1669ac97ea1db8612fca3202870  imlib2-giflib5.patch"
