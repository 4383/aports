# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=openobex
pkgver=1.7
pkgrel=0
pkgdesc="Implementation of the OBject EXchange (OBEX) protocol"
url="http://dev.zuckschwerdt.org/openobex/"
arch="all"
license="GPL LGPL"
depends=
depends_dev="libusbx-dev"
makedepends="$depends_dev bluez-dev cmake udev-dev libxml2-utils
	docbook-xsl"
subpackages="$pkgname-dev $pkgname-doc $pkgname-apps"
source="http://downloads.sourceforge.net/project/openobex/openobex/$pkgver/openobex-$pkgver-Source.tar.gz"

_builddir="$srcdir"/openobex-$pkgver-Source

prepare() {
	cd "$_builddir"
	update_config_sub || return 1
}

build() {
	cd "$_builddir"
	cmake \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=/usr/lib \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_SKIP_RPATH=ON \
		|| return 1
	make && make openobex-apps || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
}

apps() {
	pkgdesc="Applications for using OBEX"
	mkdir -p "$subpkgdir"/usr
	mv "$pkgdir"/usr/bin "$subpkgdir"/usr/
}

md5sums="11031f6f0b876bb6259bd27106491528  openobex-1.7-Source.tar.gz"
sha256sums="48180469b85c9101ec17e55c9d9f28fafae0a44d5fe6b75c0be26964c5e19cdb  openobex-1.7-Source.tar.gz"
sha512sums="2e1ebdbfdac24d7ad220362eb055d8790df60b45e5bdac87a1aaacfa52f30386995a2e9e0d37083fc4ceaf5c1231df973abe9e183511bb33c9d9a79194e5b6ea  openobex-1.7-Source.tar.gz"
