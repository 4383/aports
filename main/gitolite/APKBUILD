# Contributor: Łukasz Jendrysik <scadu@yandex.com>
# Maintainer:  Bartłomiej Piotrowski <bpiotrowski@alpinelinux.org>
# Contributor: Carlo Landmeter <clandmeter@gmail.com>

pkgname=gitolite
pkgver=3.6.2
pkgrel=0
pkgdesc='Centralized git server, with very fine-grained access control and many powerful features'
url='http://github.com/sitaramc/gitolite'
arch='noarch'
license='GPL2'
depends='git perl'
install=$pkgname.pre-install
source="https://github.com/sitaramc/$pkgname/tarball/v${pkgver}/$pkgname-$pkgver.tar.gz"

prepare() {
	cd "$srcdir"/sitaramc-gitolite-*
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
	echo "v${pkgver}" > VERSION
}

package() {
    cd "$srcdir"/sitaramc-gitolite-*

    install -d "$pkgdir"/usr/lib/gitolite || return 1
    install -d "$pkgdir"/usr/bin || return 1
    ./install -to "$pkgdir"/usr/lib/gitolite || return 1
    ln -s /usr/lib/gitolite/gitolite "$pkgdir"/usr/bin/ || return 1
}

md5sums="48ad0cf87094f38c6b59e054951c63e6  gitolite-3.6.2.tar.gz"
sha256sums="9354e52568456829ce509b33c72b73f21f9fc8b43d6d08ffee3dc240e949584b  gitolite-3.6.2.tar.gz"
sha512sums="9b8c406723caab3c70b5d0fdc3b28f69489f21c595d6bc5448e45b94067dac949ee3a5ab83c3725d433bb523ed132ab2ab73c1b5ecbfd81eedf7b03bd5562357  gitolite-3.6.2.tar.gz"
