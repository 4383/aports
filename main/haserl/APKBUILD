# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=haserl
pkgver=0.9.31
pkgrel=0
pkgdesc="Html And Shell Embedded Report Language"
url="http://haserl.sourceforge.net/"
arch="all"
license="GPL-2"
depends=
makedepends="lua-dev automake autoconf"
subpackages="$pkgname-doc"
source="http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz
	"

_builddir="$srcdir/$pkgname-$pkgver"
prepare() {
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
	sed -i -e 's/^        /\t/' src/Makefile.am || return 1
	rm -f src/haserl_lualib.inc

	aclocal && autoconf && autoheader && automake --add-missing || return 1
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--with-lua \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir/" install
	chmod 4111 "$pkgdir"/usr/bin/haserl
}

md5sums="7639d6f96de1fd5d3fbccecf9220df80  haserl-0.9.31.tar.gz"
sha256sums="7941157b3ab2786203a9c95f0d00876c2bba1b087f7a4900dbfecec0107f3d2f  haserl-0.9.31.tar.gz"
sha512sums="ee49bc95e1cabd042c51a4c161f64ab5351b9bbebb1c60b1f495ce7704341720ed62d4729125eba264c4ae17a7f86da3f316a7e6e316cbde0fe79b8a4218e14c  haserl-0.9.31.tar.gz"
