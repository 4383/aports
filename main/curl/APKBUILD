# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=curl
pkgver=7.33.0
pkgrel=1
pkgdesc="An URL retrival utility and library"
url="http://curl.haxx.se"
arch="all"
license="MIT"
depends=
depends_dev="zlib-dev openssl-dev libssh2-dev"
makedepends="$depends_dev"
source="http://curl.haxx.se/download/curl-$pkgver.tar.bz2
	CVE-2014-0015.patch
	"
subpackages="$pkgname-doc $pkgname-dev"

_builddir="$srcdir/$pkgname-$pkgver"

prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}
build() {
	cd "$_builddir"
	./configure --prefix=/usr \
		--mandir=/usr/share/man \
		--without-libidn \
		--enable-ipv6 \
		--disable-ldap
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	rm "$pkgdir"/usr/lib/*.la || return 1
}

md5sums="57409d6bf0bd97053b8378dbe0cadcef  curl-7.33.0.tar.bz2
bab6cc59679fbb496c2c3034418b70d8  CVE-2014-0015.patch"
sha256sums="0afde4cd949e2658eddc3cda675b19b165eea1af48ac5f3e1ec160792255d1b3  curl-7.33.0.tar.bz2
4d7e468cbd699fe0fc15635ab496d97761976b38f480b38075c7b9646e8e73a0  CVE-2014-0015.patch"
sha512sums="13f61e8255859f3d1138bf7cc935bda90af5f51103f1660b9e9cc6dd63d37b7672752900f3a76f8c80d47a7c02061077c6417d53617576f4030e180552b75076  curl-7.33.0.tar.bz2
607591592932c317a40bb8fe7c2cab58b97eb08de14bd890c8b56fb49e49274a76fad52af3e29dc529d8537cc782b08d3471f30f7e90e0ff25500019fa961524  CVE-2014-0015.patch"
