# Contributor: Michael Mason <ms13sp@gmail.com> 
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=dhcpcd
pkgver=6.4.0
pkgrel=0
pkgdesc="RFC2131 compliant DHCP client"
url="http://roy.marples.name/projects/dhcpcd/"
arch="all"
license="BSD-2"
depends=
makedepends=
install=
subpackages="$pkgname-doc"
source="http://roy.marples.name/downloads/dhcpcd/$pkgname-$pkgver.tar.bz2
	busybox-logger.patch
	fix-includes.patch
	cc.patch
	fix-caddr_t.patch
	dhcpcd.initd"

prepare() {
	cd "$srcdir/$pkgname-$pkgver"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$srcdir/$pkgname-$pkgver"
	CFLAGS="$CFLAGS -D_GNU_SOURCE"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--libexecdir=/lib/dhcpcd \
		--dbdir=/var/lib/dhcpcd \
		|| return 1
	make
}

package() {
	cd "$srcdir"/$pkgname-$pkgver
	make DESTDIR="$pkgdir" install
	install -Dm755 "$srcdir"/dhcpcd.initd "$pkgdir"/etc/init.d/dhcpcd
}

md5sums="3a6f5952fd1bcf0eefb9c7c087acbfc9  dhcpcd-6.4.0.tar.bz2
ee37c1f2b73055e6cf127fc8e581af87  busybox-logger.patch
6f5f2e7df22f09b0ef8f3ff05fe87151  fix-includes.patch
f5058ba88ed8c14dee8a1264bca96ab3  cc.patch
247992cddc9fa9088d84a3f500674d1b  fix-caddr_t.patch
ecbd807cf3f87d7c5b6095bf63f26894  dhcpcd.initd"
sha256sums="0413a9c8910cad4df2758402be88a9f1630361e1f5dd09926161461a1ea69013  dhcpcd-6.4.0.tar.bz2
a590961c9e53829a9d33ae458fc4c4b68880f5b2b972c3a78c60a947b8c56fb5  busybox-logger.patch
fd7aae982ee22b6e22bbeb4fa4e8a5694ed68eac64b2cfc52a6f2c97ddd60049  fix-includes.patch
baa515f07494b6329d2ce135f74f5557c9996185a956d6a7a0c1032c7866e1d3  cc.patch
ef861dad9bc5149b33987e3023a435733a859d12dda0118d42b5ef63a8930f20  fix-caddr_t.patch
72b42c9939fda3fb56666813513029ed36194c1708bddce06bcb3e131e547492  dhcpcd.initd"
sha512sums="d2a1be0f26e1537756874ba476bfdb55e97e7cad336e13f35bc34bacb4f9be3c5b21b6eb428d5da1fcb2906a69d8e6f40653391186f663d5b4fbff0115dae204  dhcpcd-6.4.0.tar.bz2
35960cc9197750890d1a8540eb920e6c0544295993044718aa5309303e29eb2c7622eee74f742861cf446d88c7b80b5ea104f3f6bcc3e9daa5be59237a962971  busybox-logger.patch
d21e431f723537061e0787f461eaeed2f02384653dd82d89cd53163ea0b616f11a2d2b1a4013bd1a5682c6c6f4c24d1f42d1201ad5a63be007b26923d884b7dd  fix-includes.patch
f6eb27ba164504dcac7602cdc83eb967c625fd46ba26710222f88196c9488d0c5d7e847d61d5873896d4be8bd5c396ae504169116bd8e711707ab2692887bb0e  cc.patch
afe7bb9c1a592c7268bce1544bf8c106e7c6db721ba98bd3f4e67753eca35183b48ec01b677e0edfd781e8ccff3cb095ec7ab2774cadbd397063e33497f86ad6  fix-caddr_t.patch
0a188b67f0641a480ac6d3cf6a634dddc4b72b1b9b47df33b05fba5d802693dd88e0cece0bfe9b641009c03022c620595b1ce35cd53d5024ee87f4c81e9acf63  dhcpcd.initd"
