# Contributor: Michael Mason <ms13sp@gmail.com> 
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=dhcpcd
pkgver=5.6.8
pkgrel=1
pkgdesc="RFC2131 compliant DHCP client"
url="http://roy.marples.name/projects/dhcpcd/"
arch="all"
license="BSD-2"
depends=
makedepends=
install=
subpackages="$pkgname-doc"
source="http://roy.marples.name/downloads/dhcpcd/$pkgname-$pkgver.tar.bz2
	CVE-2014-6060.patch
	dhcpcd.initd"

prepare() {
	cd "$srcdir/$pkgname-$pkgver"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$srcdir/$pkgname-$pkgver"
	./configure --libexecdir=/lib/dhcpcd \
		--dbdir=/var/lib/dhcpcd \
		|| return 1
	make
}

package() {
	cd "$srcdir"/$pkgname-$pkgver
	make DESTDIR="$pkgdir" install
	install -Dm755 "$srcdir"/dhcpcd.initd "$pkgdir"/etc/init.d/dhcpcd
}

md5sums="0f1fb6e7bcbf7e374d4af0d58e75246e  dhcpcd-5.6.8.tar.bz2
bb314ebc6bdf643ee2621b78b934b133  CVE-2014-6060.patch
ecbd807cf3f87d7c5b6095bf63f26894  dhcpcd.initd"
sha256sums="a3b15da770623774f4e659bf3239fca50f03594207bca3a2ad011f0b68d8eec4  dhcpcd-5.6.8.tar.bz2
93dda893861f921021fbd3b25f78141a93df96cdf232b9118b058a9e2689e4fd  CVE-2014-6060.patch
72b42c9939fda3fb56666813513029ed36194c1708bddce06bcb3e131e547492  dhcpcd.initd"
sha512sums="20e51d19d2a45101fa28322be3f17aec081ec9ed026b07d24fc45e090135bcf2422e3d1d2a62f60a90714babd036faef2fa1f251dd69cfeb1cce021b56485fae  dhcpcd-5.6.8.tar.bz2
dce502b69b7260031817c66aed35dec46a477a7108d750a9f3c32cab87fc83ba9947ae4438a37352d445a4b2f35567d184b1df3416906e3ed149180a84b738b6  CVE-2014-6060.patch
0a188b67f0641a480ac6d3cf6a634dddc4b72b1b9b47df33b05fba5d802693dd88e0cece0bfe9b641009c03022c620595b1ce35cd53d5024ee87f4c81e9acf63  dhcpcd.initd"
