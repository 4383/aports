# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=newt
pkgver=0.52.10
pkgrel=1
pkgdesc="Redhat's Newt windowing toolkit development files"
url="https://fedorahosted.org/newt/"
license="LGPL-2"
depends=
makedepends="slang-dev popt-dev python-dev ncurses-dev wget"
subpackages="$pkgname-dev $pkgname-doc"
source="https://fedorahosted.org/releases/n/e/newt/newt-$pkgver.tar.gz
	$pkgname-0.52.7-notcl.patch
	"

prepare() {
	cd "$srcdir"/$pkgname-$pkgver
	for i in ../*.patch; do
		msg "Applying $i..."
		patch -p1 < $i || return 1
	done

	sed -i -e 's:-lslang:-lslang -lncurses:g' \
		-e 's:instroot:DESTDIR:g' Makefile.in || return 1
}

build() {
	cd "$srcdir"/$pkgname-$pkgver
	./configure --prefix=/usr \
		--without-gpm \
		--without-tcl \
		--disable-nls
	make RPM_OPT_FLAGS="$CFLAGS" || return 1
}

package() {
	cd "$srcdir"/$pkgname-$pkgver
	# TODO: fix the make install target to not try install po files
	make -j1 DESTDIR="$pkgdir" prefix="/usr" RPM_OPT_FLAGS="ERROR" install \
		||  true
}
md5sums="bcbcc87ec19ba37d34f819209afa2e15  newt-0.52.10.tar.gz
6780156f3b66a3f05efe1ee821617031  newt-0.52.7-notcl.patch"
