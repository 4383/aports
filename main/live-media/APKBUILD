# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=live-media
pkgver=2013.08.05
pkgrel=0
pkgdesc="A set of C++ libraries for multimedia streaming"
url="http://live555.com/liveMedia"
arch="all"
license="LGPL"
depends=
makedepends=
subpackages="$pkgname-dev"
source="http://live555.com/liveMedia/public/live.$pkgver.tar.gz"

_builddir="$srcdir"/live

prepare() { 
	cd "$_builddir"
	sed -e "/^COMPILE_OPTS/s/$/ $CFLAGS -fPIC -DPIC -DXLOCALE_NOT_USED=1 -DRTSPCLIENT_SYNCHRONOUS_INTERFACE/" \
		-i config.linux
}

build() {
	cd "$_builddir"
	./genMakefiles linux
	make C_COMPILER="${CC:-gcc}" CPLUSPLUS_COMPILER="${CXX:-g++}" \
		|| return 1
}

package() {
	local testprog f
	cd "$_builddir"
	mkdir -p "$pkgdir"/usr/lib
	for f in BasicUsageEnvironment UsageEnvironment liveMedia groupsock; do
		mkdir -p "$pkgdir"/usr/include/$f
		cp $f/include/*.h* "$pkgdir"/usr/include/$f
		cp $f/lib${f}.a "$pkgdir"/usr/lib
	done

	mkdir -p "$pkgdir"/usr/bin
	for testprog in `find testProgs -type f -perm 755`; do
		install ${testprog} "$pkgdir"/usr/bin
	done
}

md5sums="d41b4b9468392b4e44cbb2200b26c698  live.2013.08.05.tar.gz"
sha256sums="67e0716aa45ac5f3a6b7749fd39520e4c24f3a76100e9ab8efccd533535e8ffc  live.2013.08.05.tar.gz"
sha512sums="c9b730d855428a7f6eaf07379df11fde03b1af3d035ee88254ce7b1e9ab722d973396ba55e747a7c6fe8b49899c7a39771977dcaedca0bd2dd901c76dd0ae05d  live.2013.08.05.tar.gz"
