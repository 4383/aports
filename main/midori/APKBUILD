# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=midori
pkgver=0.5.4
pkgrel=0
pkgdesc="A lightweight web browser based on Gtk WebKit"
url="http://www.twotoasts.de/index.php?/pages/midori_summary.html"
arch="all"
license="LGPL2+"
depends="
	desktop-file-utils
	hicolor-icon-theme
	"
makedepends="
	gettext-dev
	git
	intltool
	libidn-dev
	libnotify-dev
	librsvg-dev
	libunique3-dev
	libxml2-dev
	paxctl
	pkgconfig
	python
	sqlite-dev
	vala
	webkitgtk-dev
	"
subpackages="$pkgname-lang"
install="$pkgname.post-install $pkgname.post-upgrade $pkgname.post-deinstall"
source="http://www.midori-browser.org/downloads/midori_${pkgver}_all_.tar.bz2"

_builddir="$srcdir"/midori_${pkgver}_all_
build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--jobs=${MAKEFLAGS/-j/} \
		--disable-zeitgeist \
		--enable-addons \
		--enable-unique \
		--enable-nls \
		--enable-gtk3 \
		|| return 1
	make
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	# PAX does not like the JIT
	paxctl -c -m -p "$pkgdir"/usr/bin/midori
}

md5sums="f8e95d84e7fb3814da537bf455168fba  midori_0.5.4_all_.tar.bz2"
sha256sums="d4ee77f3dd9bf2c07cea7674d533e77960e9346bd8b5482582ccb3cdaf182022  midori_0.5.4_all_.tar.bz2"
sha512sums="94d71eb5b4addb184b356d2434550c40adc717f105518a78b42df40830467a91a6acc5bd04a02891cd4ad3343e0a881d063bdb7ea979dfa0cbe19a84271e3138  midori_0.5.4_all_.tar.bz2"
