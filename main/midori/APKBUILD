# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=midori
pkgver=0.5.2
pkgrel=0
pkgdesc="A lightweight web browser based on Gtk WebKit"
url="http://www.twotoasts.de/index.php?/pages/midori_summary.html"
arch="all"
license="LGPL2+"
depends="
	desktop-file-utils
	hicolor-icon-theme
	"
makedepends="
	gettext-dev
	git
	intltool
	libidn-dev
	libnotify-dev
	librsvg-dev
	libunique3-dev
	libxml2-dev
	paxctl
	pkgconfig
	python
	sqlite-dev
	vala
	webkitgtk-dev
	"
subpackages="$pkgname-lang"
install="$pkgname.post-install $pkgname.post-upgrade $pkgname.post-deinstall"
source="http://archive.xfce.org/src/apps/midori/${pkgver%.*}/midori-$pkgver.tar.bz2"

build() {
	cd "$srcdir"/$pkgname-$pkgver
	./configure --prefix=/usr \
		--jobs=${MAKEFLAGS/-j/} \
		--disable-zeitgeist \
		--enable-addons \
		--enable-unique \
		--enable-nls \
		--enable-gtk3\
		|| return 1
	make
}

package() {
	cd "$srcdir"/$pkgname-$pkgver
	make DESTDIR="$pkgdir" install || return 1
	# PAX does not like the JIT
	paxctl -c -m -p "$pkgdir"/usr/bin/midori
}

md5sums="e2c1e0b617397ec9f9eef4fdb47b3565  midori-0.5.2.tar.bz2"
sha256sums="a9c5cb4606e8e4967a2b980caa9ada25623c50d927a302b6bf73eeac5815c97c  midori-0.5.2.tar.bz2"
sha512sums="4fdd93107db9fb472fc55a75e363395a49852970c2619d291e0117ac882412cfa2be9c4fef82ab7cd79935d4aebc0af78e990e370388304343543c7b86c6d8f1  midori-0.5.2.tar.bz2"
