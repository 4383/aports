# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=midori
pkgver=0.5.5
pkgrel=0
pkgdesc="A lightweight web browser based on Gtk WebKit"
url="http://www.twotoasts.de/index.php?/pages/midori_summary.html"
arch="all"
license="LGPL2+"
depends="
	desktop-file-utils
	hicolor-icon-theme
	"
makedepends="
	gettext-dev
	git
	intltool
	libidn-dev
	libnotify-dev
	librsvg-dev
	libsoup-dev
	libunique3-dev
	libxml2-dev
	paxctl
	pkgconfig
	python
	sqlite-dev
	vala
	webkitgtk-dev
	"
subpackages="$pkgname-lang"
install="$pkgname.post-install $pkgname.post-upgrade $pkgname.post-deinstall"
source="http://www.midori-browser.org/downloads/midori_${pkgver}_all_.tar.bz2"

_builddir="$srcdir"/midori-${pkgver}
build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--prefix=/usr \
		--jobs=${MAKEFLAGS/-j/} \
		--disable-zeitgeist \
		--enable-addons \
		--enable-unique \
		--enable-nls \
		--enable-gtk3 \
		|| return 1
	make
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	# PAX does not like the JIT
	paxctl -c -m -p "$pkgdir"/usr/bin/midori
}

md5sums="b99e87d4b73a4732ed1c1e591f0242ac  midori_0.5.5_all_.tar.bz2"
sha256sums="ca69382a285222a86028abebd73fed1976735883027ff0adc094b627789bbd62  midori_0.5.5_all_.tar.bz2"
sha512sums="89d1ddb461af460a83744cc761989d430750dcef9565ac98960c1c87e6082ebb35e61c4f21f28891a19119e2733dc8a6440bc51c0bd206c37ac068e434fc0231  midori_0.5.5_all_.tar.bz2"
