--- ./arch/x86/kernel/alternative.c.orig
+++ ./arch/x86/kernel/alternative.c
@@ -500,9 +500,9 @@
 
 	pax_open_kernel();
 	memcpy(ktla_ktva(addr), opcode, len);
+	sync_core();
 	pax_close_kernel();
 
-	sync_core();
 	local_irq_restore(flags);
 	/* Could also do a CLFLUSH here to speed up CPU recovery; but
 	   that causes hangs on some VIA CPUs. */
