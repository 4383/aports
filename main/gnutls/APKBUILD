# Contributor: Michael Mason <ms13sp@gmail.com>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=gnutls
pkgver=2.10.5
pkgrel=4
pkgdesc="A library which provides a secure connection"
url="http://www.gnu.org/software/gnutls/"
arch="all"
license="GPL"
depends=
depends_dev="libgcrypt-dev libgpg-error-dev zlib-dev libtasn1-dev"
makedepends="$depends_dev perl"
install=
subpackages="$pkgname-doc $pkgname-dev"
source="http://ftp.gnu.org/pub/gnu/gnutls/$pkgname-$pkgver.tar.bz2
	CVE-2011-4128.patch
	CVE-2012-1573.patch
	CVE-2013-1619.patch
	"

prepare() {
	cd "$srcdir/$pkgname-$pkgver"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$srcdir/$pkgname-$pkgver"

	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info \
		--disable-nls
	make
}

package() {
	cd "$srcdir/$pkgname-$pkgver"
	make -j1 DESTDIR="$pkgdir" install
}

md5sums="1b032e07ccd22f71a5df78aa73bd91f2  gnutls-2.10.5.tar.bz2
fce93a1175f9af9bc8db02e4fe2eeabf  CVE-2011-4128.patch
6c3fbdd0fe2cb7519284350363edc432  CVE-2012-1573.patch
846e66213a5b854053151f1ef8e6f097  CVE-2013-1619.patch"
