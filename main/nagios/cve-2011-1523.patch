--- trunk/cgi/config.c	2011/05/31 13:41:33	1740
+++ trunk/cgi/config.c	2011/06/13 08:51:05	1741
@@ -2278,7 +2278,7 @@
 	if ((*to_expand)!='\0'){
 		arg_count[0]=0;
 
-		printf("<TR CLASS='dataEven'><TD CLASS='dataEven'>To expand:</TD><TD CLASS='dataEven'>%s",command_args[0]);
+		printf("<TR CLASS='dataEven'><TD CLASS='dataEven'>To expand:</TD><TD CLASS='dataEven'>%s",escape_string(command_args[0]));
 		for (i=1;(i<MAX_COMMAND_ARGUMENTS)&&command_args[i];i++)
 			printf("!<FONT\n   COLOR='%s'>%s</FONT>",hash_color(i),command_args[i]);
 		printf("\n</TD></TR>\n");
--- trunk/cgi/statusmap.c	2011/05/31 13:41:33	1740
+++ trunk/cgi/statusmap.c	2011/06/13 08:51:05	1741
@@ -2408,7 +2408,7 @@
 
 	for(temp_layer=layer_list;temp_layer!=NULL;temp_layer=temp_layer->next){
 		if(get_method==TRUE)
-			printf("&layer=%s",temp_layer->layer_name);
+			printf("&layer=%s",escape_string(temp_layer->layer_name));
 		else
 			printf("<input type='hidden' name='layer' value='%s'>\n",escape_string(temp_layer->layer_name));
 	        }
