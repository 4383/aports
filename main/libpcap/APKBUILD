# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=libpcap
pkgver=1.4.0
_sover=1.0.0
pkgrel=0
pkgdesc="A system-independent interface for user-level packet capture"
url="http://www.tcpdump.org/"
arch="all"
license="BSD"
depends=
makedepends="bison flex autoconf"
source="http://www.tcpdump.org/release/$pkgname-$pkgver.tar.gz
	"
subpackages="$pkgname-doc $pkgname-dev"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	cd "$_builddir"
	update_config_sub || return 1
	for i in "$srcdir"/*.patch; do
		[ -r "$i" ] || continue
		msg "Applying $i..."
		patch -p1 -i $i || return 1
	done
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--enable-ipv6 \
		|| return 1
	# seems to be problem with timestamps
	sleep 1
	./config.status
	make all shared || return 1
}

package() {
	cd "$_builddir"
	mkdir -p "$pkgdir/usr/bin"
	make -j1 DESTDIR="$pkgdir" install install-shared
}
md5sums="56e88a5aabdd1e04414985ac24f7e76c  libpcap-1.4.0.tar.gz"
sha256sums="7c6a2a4f71e8ab09804e6b4fb3aff998c5583108ac42c0e2967eee8e1dbc7406  libpcap-1.4.0.tar.gz"
sha512sums="b7662867c6449c603a65c37e63ce881260dee80989ccb5b71b1e55fa437fb18ac9bb123a7b8ed68302baf4511b97bca40d9f08dea7b0dd0eb6a2ac4a7b73cf15  libpcap-1.4.0.tar.gz"
