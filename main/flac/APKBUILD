# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=flac
pkgver=1.3.1
pkgrel=0
pkgdesc="Free Lossless Audio Codec"
url="http://flac.sourceforge.net/"
arch="all"
license="custom:Xiph LGPL GPL FDL"
subpackages="$pkgname-dev $pkgname-doc"
depends=
makedepends="libogg-dev !libiconv"
source="http://downloads.xiph.org/releases/flac/flac-${pkgver}.tar.xz"

_builddir="$srcdir/$pkgname-$pkgver"

prepare() {
	cd "$_builddir"
}

build () {
	cd "$_builddir"

	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--mandir=/usr/share/man \
		--enable-shared \
		--enable-ogg \
		--disable-sse \
		--disable-rpath \
		--with-pic \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	rm "$pkgdir"/usr/lib/*.la

	install -Dm0644 COPYING.Xiph \
		"$pkgdir"/usr/share/licenses/$pkgname/COPYING.Xiph
}
md5sums="b9922c9a0378c88d3e901b234f852698  flac-1.3.1.tar.xz"
sha256sums="4773c0099dba767d963fd92143263be338c48702172e8754b9bc5103efe1c56c  flac-1.3.1.tar.xz"
sha512sums="923cd0ffe2155636febf2b4633791bc83370d57080461b97ebb69ea21a4b1be7c0ff376c7fc8ca3979af4714e761112114a24b49ff6c80228b58b929db6e96d5  flac-1.3.1.tar.xz"
