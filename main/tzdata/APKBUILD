# Contributor: Natanael Copa <ncopa@alpinelinux.org>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=tzdata
pkgver=2013f
_tzcodever=2013f
_ptzver=0.3
pkgrel=0
pkgdesc="Timezone data"
url="http://www.twinsun.com/tz/tz-link.htm"
arch="all"
license="Public Domain"
depends=
makedepends=
install=
subpackages="$pkgname-doc"
source="http://www.iana.org/time-zones/repository/releases/tzcode$_tzcodever.tar.gz
	http://www.iana.org/time-zones/repository/releases/tzdata$pkgver.tar.gz
	http://git.alpinelinux.org/cgit/ncopa/posixtz/snapshot/posixtz-$_ptzver.tar.bz2
	Makefile.patch
	0001-posixtz-fix-up-lseek.patch"

_builddir="$srcdir"
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	make || return 1

	cd "$srcdir"/posixtz-$_ptzver
	make posixtz
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" \
		install || return 1
	rm -f "$pkgdir"/usr/share/zoneinfo/localtime

	rm "$pkgdir"/usr/bin/tzselect || return 1
	install -Dm755 "$srcdir"/posixtz-$_ptzver/posixtz \
		"$pkgdir"/usr/bin/posixtz || return 1
}

md5sums="0cca1a29a3734935e7dd44e86fa3bbd5  tzcode2013f.tar.gz
6d35470a6090e741c39aa9bc9cd103e3  tzdata2013f.tar.gz
99efce32b3f870e1b071ce47f3a98a18  posixtz-0.3.tar.bz2
8c44bb07b4e86568f5ed4bdf10de6a0f  Makefile.patch
0b4d86d855f7daa3f79c9f28f04a48f9  0001-posixtz-fix-up-lseek.patch"
sha256sums="ffd83e06f61f7854827cd7ac34239ef29c3d5ec760d7216f06c68f1b1d805ea3  tzcode2013f.tar.gz
5b72ed29bea75e0b59cbd3f575db0aac62f96a2a36e652725f674a92a95d4ada  tzdata2013f.tar.gz
574a765e0569458d7ccb76e97b3a96de2f0c19ad093c6811675b8a57f7088a53  posixtz-0.3.tar.bz2
7437b00386ee673467e0fa01a0dbae1a3a32d709e444443c1eefd00b890ed725  Makefile.patch
e0b6de6a3d389f96dc95e5b75c2ada9afc63858e3770a0f07a62e1e56a77561e  0001-posixtz-fix-up-lseek.patch"
sha512sums="80015341cb969345ba629da65bc41c3abc75e170ab4b6795ef83828d05a737ae6d3de89806a116ba7e43e0f2c8c0f28e91cbee2022b9f9115a79df26d046bd66  tzcode2013f.tar.gz
489c6386b3926bcd5c257efbfdfe4fc62beff7bd030e2c686c7de4857d8b8ba13d09522358aedc6c324a0dc5d449e0dbf48ec289a5e91b1cb70f36886604c239  tzdata2013f.tar.gz
57dfd38a4050230e49ec9a23bfec5e995dd48ed1fa338a72c4d2c3b86590d4c7357d3dc6d12b4f1564beebcf48f0d0ed855574e4ba29268160d8f84928a477fd  posixtz-0.3.tar.bz2
5ab04af020cca764179885f7c7b93402bc16a625a92acdde0e52ba56552aaa04c50723d2e0f98e13d7090a1a34b450818a86119d20301e2b8518bccc0cbdd10f  Makefile.patch
c7ddb4eecf8e55e6153f641d478a3affa2522e093e94e95e2ee43039a5c6eed28dcc472bcaa3a7c7c1b84747744c25028467e0048765ef0fc75b89345fc29318  0001-posixtz-fix-up-lseek.patch"
