# Contributor: Carlo Landmeter <clandmeter@gmail.com>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=libpng
pkgver=1.6.8
_apngver=$pkgver
pkgrel=0
pkgdesc="Portable Network Graphics library"
url="http://www.libpng.org/"
arch="all"
license="GPL"
depends=
depends_dev="zlib-dev"
makedepends="$depends_dev gawk"
subpackages="$pkgname-doc $pkgname-dev"
source="http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz
	http://downloads.sourceforge.net/sourceforge/libpng-apng/libpng-$_apngver-apng.patch.gz
	"

_builddir="$srcdir/$pkgname-$pkgver"

prepare() {
	cd "$_builddir"
	gunzip -c "$srcdir"/libpng-$pkgver-apng.patch.gz | patch -p1 || return 1
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		|| return 1
	make
}

package() {
	cd "$srcdir/$pkgname-$pkgver"
	make DESTDIR="$pkgdir" install
	install -Dm644 LICENSE "${pkgdir}"/usr/share/licenses/${pkgname}/LICENSE || return 1
	rm -f "$pkgdir"/usr/lib/*.la
}

md5sums="29b7065906e2551508a0d7eacd19174e  libpng-1.6.8.tar.gz
6ddeea37e1945d809959a152d4258987  libpng-1.6.8-apng.patch.gz"
sha256sums="32c7acf1608b9c8b71b743b9780adb7a7b347563dbfb4a5263761056da44cc96  libpng-1.6.8.tar.gz
118f92c544ea503117379605f53055f54ca1329ff629f7cef7f740d4c0b6da73  libpng-1.6.8-apng.patch.gz"
sha512sums="1b0de10acf39b300e22fd02fd6a0766a358a02358d081989e9d4f0619918c7ab5be830a232bd58c67a1eb1b592ed0d956588c5dcf489885320c499bb0bd35a74  libpng-1.6.8.tar.gz
e4aeb4ee547263a11c4f15e06b057186370470207e3b4df6169294e5a578592bd6fc149ff07d0f9e486f65d141a911eeafd4a73767db576fa42a2b8761cdc2d3  libpng-1.6.8-apng.patch.gz"
