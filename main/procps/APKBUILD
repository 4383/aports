# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=procps
pkgver=3.3.8
pkgrel=0
pkgdesc="Utilities for monitoring your system and processes on your system"
url="https://sourceforge.net/projects/procps-ng/"
arch="all"
license="GPL LGPL"
depends=
makedepends="ncurses-dev autoconf automake"
subpackages="$pkgname-dev $pkgname-doc libproc"
source="http://downloads.sourceforge.net/procps-ng/procps-ng-$pkgver.tar.xz"

_builddir="$srcdir"/procps-ng-$pkgver
prepare() {
	cd "$_builddir"
	update_config_sub || return 1
	aclocal && autoconf && automake --add-missing
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/ \
		--bindir=/bin \
		--sbindir=/sbin \
		--libdir=/lib \
		--mandir=/usr/share/man \
		--sysconfdir=/etc \
		--docdir=/usr/share/doc \
		--disable-static \
		--disable-w-from \
		--disable-kill \
		--disable-rpath \
		--with-ncurses \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" ldconfig=true install="install -D" \
		install || return 1
	rm "$pkgdir"/lib/*.la || return 1
	install -d "$pkgdir"/usr/lib
	mv "$pkgdir"/include "$pkgdir"/usr/ \
		&& mv "$pkgdir"/lib/pkgconfig "$pkgdir"/usr/lib/
}

libproc() {
	pkgdesc="Library for monitoring system and processes"
	install -d "$subpkgdir"/
	mv "$pkgdir"/lib "$subpkgdir"/
}

md5sums="aecbeeda2ab308f8d09dddcb4cb9a572  procps-ng-3.3.8.tar.xz"
sha256sums="a4109cfb6fe3bcfb5a0efb37efe04d0c8ce858bff3820d48cc258bad41bed46b  procps-ng-3.3.8.tar.xz"
sha512sums="63ba13f9ef0f4558748c6b2d1b0719a1173bd87e38279e3b052a10e207e1b808626d031f16dd65b05c55708366df7350cb0a64da8dc20e7f9f1fdc1cd2417c71  procps-ng-3.3.8.tar.xz"
