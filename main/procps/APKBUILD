# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=procps
pkgver=3.3.6
pkgrel=0
pkgdesc="Utilities for monitoring your system and processes on your system"
url="https://sourceforge.net/projects/procps-ng/"
arch="all"
license="GPL LGPL"
depends=
makedepends="ncurses-dev autoconf automake"
subpackages="$pkgname-dev $pkgname-doc libproc"
source="http://downloads.sourceforge.net/procps-ng/procps-ng-$pkgver.tar.xz"

_builddir="$srcdir"/procps-ng-$pkgver
prepare() {
	cd "$_builddir"
	aclocal && autoconf && automake --add-missing
}

build() {
	cd "$_builddir"
	./configure --prefix=/ \
		--bindir=/bin \
		--sbindir=/sbin \
		--libdir=/lib \
		--mandir=/usr/share/man \
		--sysconfdir=/etc \
		--docdir=/usr/share/doc \
		--disable-static \
		--disable-w-from \
		--disable-kill \
		--disable-rpath \
		--with-ncurses
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" ldconfig=true install="install -D" \
		install || return 1
	rm "$pkgdir"/lib/*.la || return 1
	install -d "$pkgdir"/usr/lib
	mv "$pkgdir"/include "$pkgdir"/usr/ \
		&& mv "$pkgdir"/lib/pkgconfig "$pkgdir"/usr/lib/
}

libproc() {
	pkgdesc="Library for monitoring system and processes"
	install -d "$subpkgdir"/
	mv "$pkgdir"/lib "$subpkgdir"/
}

md5sums="0a050d9be531921db3cd38f1371e73e3  procps-ng-3.3.6.tar.xz"
