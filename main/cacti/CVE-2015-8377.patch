Description: SQL injection vulnerability in the host_new_graphs_save function
 in graphs_new.php in Cacti 0.8.8f and earlier allows remote authenticated users
 to execute arbitrary SQL commands via crafted serialized data in the
 selected_graphs_array parameter in a save action.
Author: Chris Lamb <lamby@debian.org> and Paul Gevers <elbrus@debian.org>
Bug: http://bugs.cacti.net/view.php?id=2655
Index: cacti/graphs_new.php
===================================================================
--- cacti.orig/graphs_new.php
+++ cacti/graphs_new.php
@@ -183,11 +183,17 @@ function host_new_graphs_save() {
 
 		while (list($form_id1, $form_array2) = each($form_array)) {
 			/* enumerate information from the arrays stored in post variables */
+			/* ================= input validation ================= */
+			input_validate_input_number($form_id1);
+			/* ==================================================== */
 			if ($form_type == "cg") {
 				$graph_template_id = $form_id1;
 			}elseif ($form_type == "sg") {
 				while (list($form_id2, $form_array3) = each($form_array2)) {
 					$snmp_index_array = $form_array3;
+					/* ================= input validation ================= */
+					input_validate_input_number($form_id2);
+					/* ==================================================== */
 
 					$snmp_query_array["snmp_query_id"] = $form_id1;
 					$snmp_query_array["snmp_index_on"] = get_best_data_query_index_type($_POST["host_id"], $form_id1);
