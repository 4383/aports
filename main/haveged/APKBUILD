# Maintainer: Bart≈Çomiej Piotrowski <nospam@bpiotrowski.pl>
# Contributor: Danilo Godec <danilo.godec@agenda.si>

pkgname=haveged
pkgver=1.8
pkgrel=0
pkgdesc='Entropy harvesting daemon using CPU timings'
url="http://www.issihosts.com/haveged/"
arch="all"
license="GPL"
subpackages="$pkgname-doc"
source="http://www.issihosts.com/haveged/haveged-$pkgver.tar.gz
        haveged.initd haveged.confd"

_builddir="$srcdir"/$pkgname-$pkgver

prepare() {
	cd "$_builddir"
	update_config_sub || return 1
}

build() {
  cd "$_builddir"
  ./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix /usr \
		--sysconfdir /etc \
		|| return 1
  make || return 1
}

package() {
  cd "$_builddir"
  make DESTDIR="$pkgdir" install || return 1
  rm "$pkgdir"/usr/lib/libhavege.la

  install -Dm755 "$srcdir"/haveged.initd \
                 "$pkgdir"/etc/init.d/haveged || return 1
  install -Dm644 "$srcdir"/haveged.confd \
                 "$pkgdir"/etc/conf.d/haveged || return 1
}

md5sums="e0034fd8a645b7499157a31a3e3b224d  haveged-1.8.tar.gz
0718d29f820b878a311e939b3682935c  haveged.initd
242300ea7948a16018d1b0f77fb5ec96  haveged.confd"
sha256sums="73c3d9543cf9274e777064bd179f1ff563987ca103f8ab6d7035c94c8a0db192  haveged-1.8.tar.gz
f5e99dc3e11437714fabc956611404306c3894a70f78259c412fb847377268af  haveged.initd
54f692941e4d15108683daa0e37240f834beaa216aeee462ef94f24c2382abf7  haveged.confd"
sha512sums="770ea9f4f47a0121ba4712269ab1f6796cf4522ab4a44f04b154f9c76732899ee01d747ff8e614e01be6f08726ed7d3b1429940960d810a2d7aa883eb9a849f0  haveged-1.8.tar.gz
4a6cd8f97953b0ea9ca1ee7c0fc672f962b78d2020c9f733f202d0d6e7aced14f7110bd2b757799d5a296a187eeff6a0f7d18daa3c7644c0e9c756f57ee2d45a  haveged.initd
57201472fc659aaab919562a00d474d3823d5becea62e8b13ef93eda05e1fd667721c968f224fcae871d13cfcd16d1924403d9181e0899fa214fa00bf4fefc75  haveged.confd"
