# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=lua-posix
_name=luaposix
pkgver=5.1.14
pkgrel=0
pkgdesc="POSIX library for Lua"
url="http://luaforge.net/projects/luaposix/"
arch="all"
license="MIT"
depends="lua"
makedepends="lua-dev perl ncurses-dev"
source="http://luaforge.net/frs/download.php/4848/luaposix-$pkgver.tar.gz"
replaces="luaposix"
subpackages="curses"

_builddir="$srcdir"/$_name-$pkgver
_lualib=/usr/lib/lua/5.1
_luashare=/usr/share/lua/5.1

build() {
	cd "$_builddir"
	./configure --prefix=/usr \
		--libdir=$_lualib \
		--datadir=$_luashare \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	rm "$pkgdir"/$_lualib/*.la || return 1
}

curses() {
	pkgdesc="ncurses binding for Lua"
	mkdir -p "$subpkgdir"/$_lualib "$subpkgdir"/$_luashare
	mv "$pkgdir"/$_lualib/curses* "$subpkgdir"/$_lualib/ || return 1
	mv "$pkgdir"/$_luashare/curses* "$subpkgdir"/$_luashare/ || return 1
}
md5sums="a06af926a87e8d5e7c5b99304e0371f1  luaposix-5.1.14.tar.gz"
