# Contributor: Carlo Landmeter <clandmeter at gmail>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=mdadm
pkgver=3.1.1
pkgrel=0
pkgdesc="a tool for managing Linux Software RAID arrays"
url="http://neil.brown.name/blog/mdadm"
license="GPL-2"
depends=
makedepends="groff"
subpackages="$pkgname-doc"
source="http://www.kernel.org/pub/linux/utils/raid/${pkgname}/${pkgname}-${pkgver}.tar.gz
	${pkgname}.initd
	${pkgname}.confd
	mdadm-raid.initd
	mdadm-uclibc.patch
	"

build() {
	cd "$srcdir/$pkgname-$pkgver"
	patch -p1 -i ../mdadm-uclibc.patch || return 1
	make
}

package() {
	cd "$srcdir/$pkgname-$pkgver"
	make DESTDIR=$pkgdir install

	install -m755 -D "$srcdir"/$pkgname.initd "$pkgdir"/etc/init.d/$pkgname
	install -m755 -D "$srcdir"/$pkgname-raid.initd "$pkgdir"/etc/init.d/$pkgname-raid
	install -m644 -D "$srcdir"/$pkgname.confd "$pkgdir"/etc/conf.d/$pkgname
	install -m644 -D mdadm.conf-example "$pkgdir"/etc/mdadm.conf
}

md5sums="8bfeea282d21b5ef8e825122fb359457  mdadm-3.1.1.tar.gz
ce57e798431f7ab89f9b07a7daaa4852  mdadm.initd
16d2b8eb2e17184357db503470fdd8eb  mdadm.confd
cf60ee08fc4fbed0450c5a2d4efc4214  mdadm-raid.initd
aa601f072096fb8bae8b8946f59a561f  mdadm-uclibc.patch"
