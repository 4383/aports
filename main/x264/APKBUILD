# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=x264
pkgver=20121217
pkgrel=1
pkgdesc="free library for encoding H264/AVC video streams"
url="http://www.videolan.org/developers/x264.html"
arch="all"
license="GPL"
depends=
makedepends="libx11-dev bash yasm"
subpackages="$pkgname-dev"
source="ftp://ftp.videolan.org/pub/x264/snapshots/x264-snapshot-$pkgver-2245-stable.tar.bz2"
_builddir="$srcdir/$pkgname-snapshot-$pkgver-2245-stable"
build() { 
	cd "$_builddir"
	local _asmopts=
	if [ "$CARCH" = "x86" ]; then
		_asmopts="--disable-asm"
	fi
	./configure --prefix=/usr \
		--enable-visualize \
		--enable-shared \
		$_asmopts \
		--enable-pic || return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" bindir=/usr/bin libdir=/usr/lib includedir=/usr/include install || return 1
}
md5sums="078aef5b68d659d7cdec2d187d8bce6b  x264-snapshot-20121217-2245-stable.tar.bz2"
sha256sums="b22371a9ed0f60b42d5339647934fc3e177a766327304f064eca582336696c90  x264-snapshot-20121217-2245-stable.tar.bz2"
sha512sums="4fc5aae9ac21d9a6bcb6c0aceb187b753b0d6de91b14aa090b33b5c5f84d8fe7c4650daea3d40d9751c308ebecaf05c6aab1550efac9c83841df45babb9ca768  x264-snapshot-20121217-2245-stable.tar.bz2"
