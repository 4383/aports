# Maintainer:
# Contributor: Bart≈Çomiej Piotrowski <bpiotrowski@alpinelinux.org>

pkgname=teeworlds
pkgver=0.6.2
pkgrel=0
arch=all
pkgdesc='Multiplayer 2D shooter'
url='https://www.teeworlds.com'
license='custom'
depends=
makedepends='python mesa-dev glu-dev sdl-dev freetype-dev alsa-lib-dev bam'
subpackages="$pkgname-server $pkgname-common"
source="https://www.teeworlds.com/files/$pkgname-$pkgver-source.tar.gz"

build() {
  cd "$srcdir"/$pkgname-$pkgver-source
  bam client_release server_release || return 1
}

package() {
  depends="$pkgname-common"

  cd "$srcdir"/$pkgname-$pkgver-source
  install -Dm755 teeworlds "$pkgdir"/usr/bin/teeworlds || return 1
}

server() {
  depends="$pkgname-common"

  cd "$srcdir"/$pkgname-$pkgver-source
  install -Dm755 teeworlds_srv "$subpkgdir"/usr/bin/teeworlds_srv || return 1
}

common() {
  arch=noarch

  cd "$srcdir"/$pkgname-$pkgver-source
  install -Dm644 license.txt "$subpkgdir"/usr/share/licenses/teeworlds/LICENSE \
    || return 1

  install -d "$subpkgdir"/usr/share/teeworlds/data || return 1
  cp -r data/* "$subpkgdir"/usr/share/teeworlds/data || return 1
}

md5sums="649f6c05a7b117096b238c07062edc39  teeworlds-0.6.2-source.tar.gz"
sha256sums="00061b30377597a61810eda3dc5de0caad439ca851cb8eebbe4152e4f861e2af  teeworlds-0.6.2-source.tar.gz"
sha512sums="e08db7a8eabe2f04c543ecf1abc2f51b513a06812581cf8c396fc8bd7e038ce09c46f73bfea80e295affded96c511ef74d47a14dd03fd0aac05487a46f380839  teeworlds-0.6.2-source.tar.gz"
