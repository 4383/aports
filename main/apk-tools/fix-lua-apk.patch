diff --git a/src/lua-apk.c b/src/lua-apk.c
index 6fbd1cf..45488c2 100644
--- a/src/lua-apk.c
+++ b/src/lua-apk.c
@@ -208,7 +208,7 @@ static int Papk_exists(lua_State *L)
 	apk_blob_t blob = APK_BLOB_STR(depstr);
 	apk_blob_pull_dep(&blob, db, &dep);
 
-	if (APK_BLOB_IS_NULL(blob) || b.len > 0)
+	if (APK_BLOB_IS_NULL(blob) || blob.len > 0)
 		goto ret_nil;
 
 	name = dep.name;
