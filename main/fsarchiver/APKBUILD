# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@alpinelinux.org>

pkgname=fsarchiver
pkgver=0.6.18
pkgrel=0
pkgdesc='Safe and flexible file-system backup and deployment tool'
arch=all
url='http://www.fsarchiver.org/'
license='GPL2'
subpackages="$pkgname-doc"
makedepends='attr-dev bzip2-dev e2fsprogs-dev lzo-dev xz-dev libgcrypt-dev zlib-dev'
source="http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz
        musl.patch"

_builddir="$srcdir/$pkgname-$pkgver"

prepare() {
	cd "$_builddir"
	update_config_sub || return 1
	patch -p1 -i "$srcdir"/musl.patch
}

build() {
  cd $srcdir/$pkgname-$pkgver
  ./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		|| return 1
  make
}

package() {
  cd $srcdir/$pkgname-$pkgver
  make DESTDIR="$pkgdir" install
}

md5sums="61bfe46dd1aca508169a96dfcd48a630  fsarchiver-0.6.18.tar.gz
ed536e4ef7dbcce3558d748c2f7d2136  musl.patch"
sha256sums="30c7b81b19435ca50fcdf964c15f50f530fbc3c3e1c6d379f3d656eba40c5d82  fsarchiver-0.6.18.tar.gz
b60e1f81b3fcff818578ea49bddb40f343b7d646b961d4aa6b269fb175b023cc  musl.patch"
sha512sums="e56f00ae89196aff74943d4b4f3ff4a0c49bde0d77072d35e7d2ad8fd591dde33c4fa53d24151438812daa6052ec7f7ce639674e1c590f11fdd161591faeeb20  fsarchiver-0.6.18.tar.gz
62f1dbf109984a6eeb7a5786fbf9453b4341300aaf19d487cbdc43fadcdd9a2b437128b189e9391101cb19a9f02423f6e10e7f8afd8e032b0af13694fd4eba6a  musl.patch"
