# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=xfburn
pkgver=0.4.3
pkgrel=2
pkgdesc="a simple CD/DVD burning tool based on libburnia libraries"
url="http://goodies.xfce.org/projects/applications/xfburn"
arch="all"
license="GPL2"
depends="desktop-file-utils hicolor-icon-theme"
makedepends="libburn-dev libisofs-dev libxfcegui4-dev thunar-dev librsvg-dev
	gst-plugins-base-dev exo-dev"
install=
subpackages="$pkgname-doc $pkgname-lang"
source="http://archive.xfce.org/src/apps/xfburn/${pkgver%.*}/xfburn-$pkgver.tar.bz2
	fix_empty_dir_segfault.patch
	xfburn-0.4.3-if-with-several-statements.patch
	xfburn-0.4.3-desktop-file.patch
	"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	cd "$_builddir"
	update_config_sub || return 1
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
	# fix build issue
	sed -i '1 i\
		#include <glib-object.h>' \
		xfburn/xfburn-settings.h
}

build () {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--enable-gstreamer \
		--enable-thunar-vfs \
		--enable-dbus \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
}

md5sums="147cdc2d909e751125be16103b8dc81f  xfburn-0.4.3.tar.bz2
7e04ba806e3a0d945d5921dc5d875bdd  fix_empty_dir_segfault.patch
66f61a08305577efb1d27f0265475d5a  xfburn-0.4.3-if-with-several-statements.patch
2a49044f041c50951aef1e22606e2e18  xfburn-0.4.3-desktop-file.patch"
sha256sums="c9993226f0f4e3dea3326ad320a01c165a7e1a485f07fa4a2583475a4e6eaafe  xfburn-0.4.3.tar.bz2
fe7a5678b1ca55d324b8369c304007ccd0103bf6ba2b5a94a8e5fd2cc35ebb63  fix_empty_dir_segfault.patch
0301453fc4433350540134a9258b1647f945465ddb7cd1d4f710c702d85fb1be  xfburn-0.4.3-if-with-several-statements.patch
a2bf198d7a5610342caa69c07c2165478765edca5d7fccc60e98b4123ad3e3f4  xfburn-0.4.3-desktop-file.patch"
sha512sums="3b82d763f6ac542eeaac0d752faa487f9f5101b6e2d11080e4ec80141496a3c80edfeb0249b37d7bef49505b37c1dd60468253758bbedbd1258a8f3f0db99205  xfburn-0.4.3.tar.bz2
fd34ca1a36ad8faef1199d5688c02977a40deb5cd20bc04abd084fc4109a723d445a133930fe3a71827b72735489e708d4ef403be4f508cff496156cc83d3ee5  fix_empty_dir_segfault.patch
aee7e0e25642bc615769fc4b4d2ccceec5bd412b5702100a462cb2ca28b64049cba0e783fde6fd8d107a553f3bcae536b1d2b7feed66cc17a8ceff7dc32e40d5  xfburn-0.4.3-if-with-several-statements.patch
7ed8152ef2c33a136b88d6b2ea9c22b76a0f1d722773a85cc204634a82526227851e2f4eb465e31dcbbec985be5479bd87568a8edc0c1ad357ee78d84662dd45  xfburn-0.4.3-desktop-file.patch"
