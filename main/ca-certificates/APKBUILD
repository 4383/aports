# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=ca-certificates
pkgver=20130610

_date=${pkgver%_p*}
_nmu="+nmu${pkgver#*_p}"
[ "$_nmu" = "+nmu${pkgver}" ] && _nmu=""
_ver=${_date}${_nmu}

pkgrel=0
pkgdesc="Common CA certificates PEM files"
url="http://packages.debian.org/sid/ca-certificates"
arch="noarch"
license="MPL GPL"
depends="run-parts openssl"
makedepends="python"
triggers="ca-certificates.trigger=/usr/share/ca-certificates:/etc/ssl/certs"
source="http://ftp.no.debian.org/debian/pool/main/c/$pkgname/${pkgname}_${_ver}.tar.gz
	"
_builddir="$srcdir"/$pkgname-$_ver
build () {
	cd "$_builddir"
	make || return 1
}

package() {
	cd "$_builddir"
	install -d -m755 "$pkgdir"/etc/ca-certificates/update.d \
		"$pkgdir"/usr/sbin \
		"$pkgdir"/usr/share/ca-certificates \
		"$pkgdir"/etc/ssl/certs \
		|| return 1
	make DESTDIR="$pkgdir" install || return 1
	install -D -m644 sbin/update-ca-certificates.8 \
		"$pkgdir"/usr/share/man/man8/update-ca-certificates.8 \
		|| return 1

	(
	echo "# Automatically generated by ${pkgname}-${pkgver}-${pkgrel}"
	echo "# $(date -u)"
	echo "# Do not edit."
	cd "$pkgdir"/usr/share/ca-certificates
	find . -name '*.crt' | sort | cut -b3-
	) > "$pkgdir"/etc/ca-certificates.conf
}
md5sums="ca34fb3a5bfb3264062d592c69f1dec6  ca-certificates_20130610.tar.gz"
sha256sums="9529a9cdfca53dc2ecea96171d8d2ff6ff343843f894af4d446686f02a6c03f2  ca-certificates_20130610.tar.gz"
sha512sums="b9023adb1210f36e9981e2d85fe5a717f53b66ce1ca137cffd97c57b84a7e46cb7500c5bf776a0f125c1585adca8f1ddad09c313d718b219db1ca7cb2e1425fd  ca-certificates_20130610.tar.gz"
