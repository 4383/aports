From d2266d43bfe3cd9a40deb50dfe80ab679d2def0c Mon Sep 17 00:00:00 2001
From: Denys Vlasenko <vda.linux@googlemail.com>
Date: Sun, 22 Apr 2012 01:37:01 +0000
Subject: udhcpc: fix improper size calculation for OPTION_STRING_HOST

Signed-off-by: Denys Vlasenko <vda.linux@googlemail.com>
---
(limited to 'networking/udhcp/dhcpc.c')

diff --git a/networking/udhcp/dhcpc.c b/networking/udhcp/dhcpc.c
index 2f2016c..ddb328d 100644
--- a/networking/udhcp/dhcpc.c
+++ b/networking/udhcp/dhcpc.c
@@ -101,6 +101,7 @@ static const uint8_t len_of_option_as_string[] = {
 	[OPTION_STATIC_ROUTES   ] = sizeof("255.255.255.255/32 255.255.255.255 "),
 	[OPTION_6RD             ] = sizeof("32 128 ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff 255.255.255.255 "),
 	[OPTION_STRING          ] = 1,
+	[OPTION_STRING_HOST     ] = 1,
 #if ENABLE_FEATURE_UDHCP_RFC3397
 	[OPTION_DNS_STRING      ] = 1, /* unused */
 	/* Hmmm, this severely overestimates size if SIP_SERVERS option
--
cgit v0.9.0.1-2-gef13
