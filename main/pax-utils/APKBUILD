# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=pax-utils
pkgver=0.7
pkgrel=3
pkgdesc="ELF related utils for ELF 32/64 binaries"
url="http://hardened.gentoo.org/pax-utils.xml"
arch="all"
license='GPL-2'
depends="scanelf"
makedepends=
source="http://dev.gentoo.org/~vapier/dist/pax-utils-$pkgver.tar.xz
	lddtree-sh.patch"
subpackages="$pkgname-doc scanelf:_scanelf lddtree:_lddtree"

_builddir="$srcdir"/pax-utils-$pkgver
prepare() {
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}
build() {
	cd "$_builddir"
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir/" install
}

_scanelf() {
	pkgdesc="Scan ELF binaries for stuff"
	depends=
	replaces="pax-utils"
	mkdir -p "$subpkgdir"/usr/bin
	mv "$pkgdir"/usr/bin/scanelf "$subpkgdir"/usr/bin/
}

_lddtree() {
	pkgdesc="List dynamic dependencies as a tree"
	depends="scanelf"
	replaces="pax-utils"
	mkdir -p "$subpkgdir"/usr/bin
	mv "$pkgdir"/usr/bin/lddtree "$subpkgdir"/usr/bin/
}

md5sums="8ae7743ad11500f7604f2e817221d877  pax-utils-0.7.tar.xz
3003d6e880fac021a36c2bc2657cdcde  lddtree-sh.patch"
sha256sums="1ac4cee9a9ca97a723505eb29a25e50adeccffba3f0f0ef4f035cf082caf3b84  pax-utils-0.7.tar.xz
0ea9b861193d29a163e2abf6a243182626cd123fd70a323a66088399c8c6c0e5  lddtree-sh.patch"
sha512sums="d99f325b1d3ffc4955bc09aedcbeabea2d87a9647da31db1518de9daa55fbe0e5dd09feedd8dbcd8c4b53825a788ae7c9b904a927abc9ae995385dfd00d44f4a  pax-utils-0.7.tar.xz
3a18d6aa7d13cdff415681e7a11056e05183a7a16c41186ade2505f73e6bb3a90f3c533fb270e3c565d6408b12fb281ac0d1c27a727b87e3820ae13a77b3c149  lddtree-sh.patch"
