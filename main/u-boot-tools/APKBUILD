# Contributor: William Pitcock <nenolod@dereferenced.org>
# Maintainer: Timo Ter√§s <timo.teras@iki.fi>
pkgname=u-boot-tools
pkgver=2016.07
pkgrel=0
pkgdesc="Image bundler for uImage files"
url="http://www.denx.de/wiki/U-Boot/"
arch="all"
license="GPL2"
depends=""
depends_dev=""
makedepends="$depends_dev"
install=""
subpackages=""
source="ftp://ftp.denx.de/pub/u-boot/u-boot-$pkgver.tar.bz2
	fix-build-error-under-gcc6.patch
	"

builddir="$srcdir"/u-boot-$pkgver

build() {
	cd "$builddir"
	LC_ALL=C date +'#define U_BOOT_DATE "%b %d %C%y"' > include/timestamp_autogenerated.h
	LC_ALL=C date +'#define U_BOOT_TIME "%T"' >> include/timestamp_autogenerated.h
	make defconfig tools-only || return 1
}

package() {
	cd "$builddir"
	local tool
	for tool in dumpimage mkenvimage mkimage ; do
		install -c -D -m 755 tools/$tool "$pkgdir"/usr/bin/$tool || return 1
	done
}

md5sums="425a3fa610a7d972e5092a0e92276c70  u-boot-2016.07.tar.bz2
9fc36b675b5580a42705987954e20214  fix-build-error-under-gcc6.patch"
sha256sums="974fb7225c0af6a721307631f66b81e20dbda82a4d7cc32aba2a625727231253  u-boot-2016.07.tar.bz2
ab7b11bc0a4ea0de4df24b827fad573365a55e84ac10ddae0abc88c5f3b63551  fix-build-error-under-gcc6.patch"
sha512sums="fa76dbd7e654ff9e4b3166162be6c0a77ecf2eb2a952b4865df3c818ebcdca7e2bb75e5ba19bf0346000c3d185888552193bb74510b115426cfe444b78efd3ef  u-boot-2016.07.tar.bz2
f508002e8a987e6c60c4a34d451234d19522d92eb0b03b3e73ed55aa80a8b6b570753c7fc910ecb298e360e87048247f5e2d0ebf4f309c95ee2ffc74903cba5e  fix-build-error-under-gcc6.patch"
