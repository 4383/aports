From a6641817147c5fd379245cc080af8bec77315890 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Timo=20Ter=C3=A4s?= <timo.teras@iki.fi>
Date: Thu, 9 Apr 2015 08:47:56 +0300
Subject: [PATCH] abuild: preserve all xattrs

by default getfattr omits system xattrs like security.capability
---
 abuild.in | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/abuild.in b/abuild.in
index 3e7ffaf..3ed5417 100644
--- a/abuild.in
+++ b/abuild.in
@@ -1679,7 +1679,7 @@ stripbin() {
 	scanelf --recursive --nobanner --etype "ET_DYN,ET_EXEC" . \
 		| sed -e 's:^ET_DYN ::' -e 's:^ET_EXEC ::' \
 		| while read filename; do
-		XATTR=$(getfattr -d "${filename}")
+		XATTR=$(getfattr --match="*" --dump "${filename}")
 		${CROSS_COMPILE}strip "${filename}"
 		[ -n "$XATTR" ] && (echo "$XATTR" | setfattr --restore=-)
 	done
-- 
2.3.5

