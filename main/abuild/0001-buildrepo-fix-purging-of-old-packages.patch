From 54ca2cb82aafc43e77dff1bacb80ed25a55f6ae7 Mon Sep 17 00:00:00 2001
From: Natanael Copa <ncopa@alpinelinux.org>
Date: Thu, 7 Apr 2011 14:34:51 +0000
Subject: [PATCH 1/2] buildrepo: fix purging of old packages

---
 buildrepo.in |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/buildrepo.in b/buildrepo.in
index 5a80b0b..405e500 100755
--- a/buildrepo.in
+++ b/buildrepo.in
@@ -81,7 +81,7 @@ build() {
 	if [ -n "$dopurge" ]; then
 		local tmp=$(mktemp /tmp/$program-XXXXXX)
 		local purgefiles
-		cd "$repodir/$1" || return 1
+		cd "$repodir/$repo/$CARCH" || return 1
 		trap 'rm -f "$tmp"; exit 1' INT
 		( listpackages "$1") >$tmp
 		purge=$(ls *.apk 2>/dev/null | grep -v -w -f $tmp)
-- 
1.7.4.4

