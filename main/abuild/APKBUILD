# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgdesc="Script to build Alpine Packages"
pkgname=abuild
pkgver=2.1
pkgrel=2
url=http://git.alpinelinux.org/cgit/abuild/
source="http://git.alpinelinux.org/cgit/abuild/snapshot/abuild-$pkgver.tar.bz2
	0002-add-fetch-from-source-mirror.patch
	0003-add-color-control-command-line-option.patch"
depends="fakeroot file sudo pax-utils apk-tools"
makedepends="openssl-dev pkgconfig"
license=GPL-2

prepare() {
	cd "$srcdir"/$pkgname-$_realver
	# patches
	for i in ../0002-add-fetch-from-source-mirror.patch ../0003-add-color-control-command-line-option.patch; do
		msg "Applying $i"
		if ! patch --verbose -p1 -i $i; then
			error "$i failed"
			return 1
		fi
	done
}

build() {
	cd "$srcdir/$pkgname-$pkgver"

	make
	make install DESTDIR="$pkgdir"
	install -m 644 abuild.conf "$pkgdir"/etc/abuild.conf
}

md5sums="2268fa6147c8088139ef136184cd2ae0  abuild-2.1.tar.bz2
5c0332196a6693d49cfe3d75c29fc63c  0002-add-fetch-from-source-mirror.patch
d710ffb3c7f3eae52cac62bc2bf4f454  0003-add-color-control-command-line-option.patch"
