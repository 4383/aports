# Contributor: Peter Bui <pnutzh4x0r@gmail.com>
# Maintainer: Peter Bui <pnutzh4x0r@gmail.com>
pkgname=offlineimap
pkgver=6.6.0
pkgrel=0
pkgdesc="Synchronizes emails between two repositories"
url="http://offlineimap.org/"
arch="noarch"
license="GPL2+"
depends="python"
depends_dev="python-dev"
makedepends="$depends_dev asciidoc"
install=""
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/OfflineIMAP/${pkgname}/archive/v${pkgver}.tar.gz"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	python setup.py build || return 1

	cd "$_builddir"/docs
	make man || return 1
}

package() {
	cd "$_builddir"
	python setup.py install --root="${pkgdir}" --optimize=1 || return 1
	install -Dm644 docs/offlineimap.1 "${pkgdir}"/usr/share/man/man1/offlineimap.1 || return 1
	install -Dm644 docs/offlineimapui.7 "${pkgdir}"/usr/share/man/man7/offlineimapui.7 || return 1
	install -Dm644 offlineimap.conf "${pkgdir}"/usr/share/offlineimap/offlineimap.conf || return 1
	install -Dm644 offlineimap.conf.minimal "${pkgdir}"/usr/share/offlineimap/offlineimap.conf.minimal || return 1
}

md5sums="645bcc778150bc66f6648efe38804af6  offlineimap-6.6.0.tar.gz"
sha256sums="c41258e5ce531915bb891d4ce10b3af88b6d74a6ee69b6282957f85165ff63f4  offlineimap-6.6.0.tar.gz"
sha512sums="a70353c9a35549b0d2e93a35480b518335e008c3bd7b4c2a613689c49d9d0ab1871d2afdf95cce59da876ff262a671f02356c53e96b8c1ad5651f6347617c301  offlineimap-6.6.0.tar.gz"
