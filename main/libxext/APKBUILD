# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=libxext
pkgver=1.3.1
pkgrel=1
pkgdesc="X11 miscellaneous extensions library"
url="http://xorg.freedesktop.org/"
arch="all"
license="custom"
depends=
depends_dev="xextproto libx11-dev libxau-dev"
makedepends="$depends_dev xproto
	libtool autoconf automake util-macros"
subpackages="$pkgname-dev $pkgname-doc"
source="http://xorg.freedesktop.org/releases/individual/lib/libXext-$pkgver.tar.bz2
	0001-Use-_XEatDataWords-to-avoid-overflow-of-rep.length-b.patch
	0002-integer-overflow-in-XcupGetReservedColormapEntries-C.patch
	0003-integer-overflow-in-XcupStoreColors-CVE-2013-1982-2-.patch
	0004-several-integer-overflows-in-XdbeGetVisualInfo-CVE-2.patch
	0005-integer-overflow-in-XeviGetVisualInfo-CVE-2013-1982-.patch
	0006-integer-overflow-in-XShapeGetRectangles-CVE-2013-198.patch
	0007-integer-overflow-in-XSyncListSystemCounters-CVE-2013.patch
	"


_builddir="$srcdir"/libXext-$pkgver
prepare() {
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
	libtoolize --force && aclocal && autoheader && autoconf \
		&& automake --add-missing
}

build() {
	cd "$srcdir"/libXext-$pkgver
	./configure --prefix=/usr --sysconfdir=/etc
	make
}

package() {
	cd "$srcdir"/libXext-$pkgver
	make DESTDIR="$pkgdir" install || return 1
	rm "$pkgdir"/usr/lib/*.la || return 1
}
md5sums="71251a22bc47068d60a95f50ed2ec3cf  libXext-1.3.1.tar.bz2
e8571e1188293644413df6beb332c209  0001-Use-_XEatDataWords-to-avoid-overflow-of-rep.length-b.patch
3ae33cae5c48fa8cfaa2669a2f474377  0002-integer-overflow-in-XcupGetReservedColormapEntries-C.patch
be5437299e95d870d0c2555e994f9e99  0003-integer-overflow-in-XcupStoreColors-CVE-2013-1982-2-.patch
f10d0d95cd02a31b42ebd9c71b098e00  0004-several-integer-overflows-in-XdbeGetVisualInfo-CVE-2.patch
30d0d1e0d7e47444d767101c789129c6  0005-integer-overflow-in-XeviGetVisualInfo-CVE-2013-1982-.patch
0684b2e3ac5875c1642a77ba6194ec81  0006-integer-overflow-in-XShapeGetRectangles-CVE-2013-198.patch
1c60dbeb9032d3823616e7fcf1162c15  0007-integer-overflow-in-XSyncListSystemCounters-CVE-2013.patch"
sha256sums="56229c617eb7bfd6dec40d2805bc4dfb883dfe80f130d99b9a2beb632165e859  libXext-1.3.1.tar.bz2
a403c890692475a9e1a99c50bae893c150695a75f8ba7f415da2a165a54b1a14  0001-Use-_XEatDataWords-to-avoid-overflow-of-rep.length-b.patch
46b3466a51fa040f39ae7e3fbf7d4d590dd6f3c246990cb5fb91eb40a547e156  0002-integer-overflow-in-XcupGetReservedColormapEntries-C.patch
b1c4b9308e140458a1e010b874d68fdc646ebf9c16b8adf573bbe05ab3e266a1  0003-integer-overflow-in-XcupStoreColors-CVE-2013-1982-2-.patch
1ddc2cd6d47b77247fc67831d81b33df287b9042bffec4fceeb1014ea08462be  0004-several-integer-overflows-in-XdbeGetVisualInfo-CVE-2.patch
f25b13702696eb15bbcc903e6900a08f61ab39a9e79972ff1666dc32671082cb  0005-integer-overflow-in-XeviGetVisualInfo-CVE-2013-1982-.patch
438dec8cc7e02d70318631b8c094a238a88a049eea8187a83f1b34cf859de333  0006-integer-overflow-in-XShapeGetRectangles-CVE-2013-198.patch
660c78e986fc227845dea5aeef00d91e328a52e3268a852160fe4056d4c13c1f  0007-integer-overflow-in-XSyncListSystemCounters-CVE-2013.patch"
sha512sums="e8536d5a93ae6718c459c013abef0660085b4014fa5db7614f847e75dc4ea87a6235593201c144c424c9f809c8f1275eeadd858fd8915ca34ea1713cf367110a  libXext-1.3.1.tar.bz2
3944b42305c7686e815bf11f996a48ed605f6f6cbac525e44dd42f0a6e1f9d7ed03b53bf0cc540fd0e1528128a1895ab8683f659d04670cf4c98fe784763ec50  0001-Use-_XEatDataWords-to-avoid-overflow-of-rep.length-b.patch
10f5c15281aa9d5e6e18511243e020f3d943bd7421defc2c0e5c68cca36d2e0fdd55f1cc58955ba8f2e2ba5983c18ff6610d5b2b2e6a0877f23f446bf2a6c4ed  0002-integer-overflow-in-XcupGetReservedColormapEntries-C.patch
dfc93f726ae0298c2b3ff43be24509904882de8d87e450e0292b32358211e961be72bca0d7af50afb955fa5ac4679598eb72526c9436d6f3fb0973b3ab6c2f08  0003-integer-overflow-in-XcupStoreColors-CVE-2013-1982-2-.patch
26699071127642cf32763be2823fcf57e4bfa7766f60c432154e569f5fb91cf7bb8fb9bd9033190fec0c74cc62aad75f73418d48a7218fe37792ca0584a990e3  0004-several-integer-overflows-in-XdbeGetVisualInfo-CVE-2.patch
6019357b85646c1c97426d03be5146a0af7a05e90af5fcee713cd2f5cd228b3634f896c76d66e174d55ea095f083b5afbb53ae4ea266979c9cdbb2813a4e5013  0005-integer-overflow-in-XeviGetVisualInfo-CVE-2013-1982-.patch
4701c06782c7fb69b4eae19a7e6e1d88f8243fc3353f8be72d820bfa36761ad98ee0e5359e55c4e45a1fbf440cfd63e6d2732dd6d68564da3c707e85184e5a41  0006-integer-overflow-in-XShapeGetRectangles-CVE-2013-198.patch
741a7716aa955c618b526f063919b7268e467f65d125a13dc72f4fd237550e2085e176f08375e8f01829341f9e967963d6d82f95bbc1cda80831c5c0691dbc91  0007-integer-overflow-in-XSyncListSystemCounters-CVE-2013.patch"
