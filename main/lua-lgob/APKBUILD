# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=lua-lgob
pkgver=11.04
pkgrel=4
pkgdesc="Set of Lua bindings that uses gobject-instrospection"
url="http://oproj.tuxfamily.org"
arch="all"
license="GPL-3"
depends="lua"
makedepends="lua-dev cairo-dev gtk+-dev pango-dev vte-dev gtkspell-dev
	webkit-dev atk-dev gstreamer-dev gst-plugins-base-dev poppler-gtk-dev
	gtksourceview-dev"
subpackages="$pkgname-dev $pkgname-doc"
source="http://downloads.tuxfamily.org/oproj/lgob/lgob-$pkgver.tar.bz2
	0001-poppler-reflect-the-poppler_page_get_text-API-change.patch
	"

#    'goocanvas', 'clutter', 'cluttergtk'
_mods="codegen common gobject loader cairo gdk gtk pango pangocairo vte webkit
	atk gst gtkspell gtksourceview poppler"
_builddir="$srcdir"/lgob-$pkgver

prepare() {
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() { 
	cd "$srcdir"/lgob-$pkgver
}

package() {
	cd "$srcdir"/lgob-$pkgver
	for i in $_mods; do
		./build.lua $i "$pkgdir"/usr || return 1
	done
	mkdir -p "$pkgdir"/usr/share/doc/$pkgname
	cp -r examples "$pkgdir"/usr/share/doc/$pkgname/
}

md5sums="1e943299ab2462e4d9d9c4443d65fafb  lgob-11.04.tar.bz2
4042ebd70fb247f6f8fc1bd17ca11ea3  0001-poppler-reflect-the-poppler_page_get_text-API-change.patch"
