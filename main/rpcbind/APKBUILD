# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=rpcbind
pkgver=0.2.1
pkgrel=0
pkgdesc="portmap replacement which supports RPC over various protocols"
url="http://rpcbind.sourceforge.net"
arch="all"
license="custom"
depends=
makedepends="libtirpc-dev"
subpackages="$pkgname-doc"
source="http://downloads.sourceforge.net/sourceforge/$pkgname/$pkgname-$pkgver.tar.bz2
	0002-uclibc-rpcsvc-defines.patch
	rpcbind.initd
	rpcbind.confd"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--bindir=/sbin \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	install -Dm755 "$srcdir"/rpcbind.initd "$pkgdir"/etc/init.d/rpcbind
	install -Dm644 "$srcdir"/rpcbind.confd "$pkgdir"/etc/conf.d/rpcbind
	install -D -m644 COPYING "$pkgdir"/usr/share/licenses/rpcbind/COPYING
}
md5sums="0a5f9c2142af814c55d957aaab3bcc68  rpcbind-0.2.1.tar.bz2
944234c5ef6902d25bd6dfc95f979ed6  0002-uclibc-rpcsvc-defines.patch
381a2722c69b4597af532381f1ffeae0  rpcbind.initd
1ad5c8dcf432c8f23ba740f4c32a7c60  rpcbind.confd"
sha256sums="da169ff877a5a07581fad50a9a808ac6e96f0c277a3df49a7ef005778428496e  rpcbind-0.2.1.tar.bz2
a1970cbe4bcc4704dba49e4a2c5be5105a631d9067c4d5cb5b073e62b5d90c65  0002-uclibc-rpcsvc-defines.patch
674d5af3957c81ff4bd97811d88e064b75f742c351b63c51c397d3779fb57604  rpcbind.initd
38bb95aefc38d843d0890d9c15affd28f19f2133c17f463396c62970e7e2dffc  rpcbind.confd"
sha512sums="5ec1e25c64ad3cd80fc2f14ced64a331afbe896fb3da54c812e3c4a78a69df181f607492762fe852732cc0ac9bd87ee118760b9e7fad2b3f028d581fecc93849  rpcbind-0.2.1.tar.bz2
8750c9b2b44daf42f35ec1c72c52497872724cd40951f7f3d34ca60cab9e291eb00f3b2d0ca9b0985c0877a80f8279a35f14a1ecf64a991e8650af5221a094f6  0002-uclibc-rpcsvc-defines.patch
9fb26b3a496c616a36f85a3af5580fb364bf404ae040ba8719d30dbdea0ea906cf07e1bc1b4c5f6e4b95b121bbd5b5c687ae17cf26617b2b2981ff7e3ef6d83b  rpcbind.initd
f11f6785708bde3ace7b55c1585e283ed07078faf310077c3d26e8e584baec6152d3f86f3d99d7a34fd10f22a7de4d8d70568c9e7f914a82eeb786b08b379044  rpcbind.confd"
