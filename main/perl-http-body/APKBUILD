# Contributor: Natanael Copa <ncopa@alpinelinux.org>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=perl-http-body
pkgver=1.15
pkgrel=1
pkgdesc="HTTP::Body perl module"
url="http://search.cpan.org/dist/HTTP-Body/"
arch="noarch"
license="GPLv2 or Artistic"
depends="perl perl-http-message perl-uri"
makedepends="perl-dev perl-test-deep"
install=""
subpackages="$pkgname-doc"
source="http://search.cpan.org/CPAN/authors/id/G/GE/GETTY/HTTP-Body-$pkgver.tar.gz
	CVE-2013-4407.patch
	"

_builddir="$srcdir"/HTTP-Body-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	PERL_MM_USE_DEFAULT=1 perl Makefile.PL INSTALLDIRS=vendor || return 1
	make && make test || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	find "$pkgdir" \( -name perllocal.pod -o -name .packlist \) -delete
}

md5sums="cccf0211c15a9fed67c68c826c5efeaf  HTTP-Body-1.15.tar.gz
8e5a8675955e2bb7a23579be4df6558d  CVE-2013-4407.patch"
sha256sums="dc2b67750d186e6fc9bf98354b972b644300a06af88fdbe0e0291dbc853c839a  HTTP-Body-1.15.tar.gz
5bacbbeda2c4297188f2fdfb03ee7d00785452bb72fac8ac0e8bd5e3575c7061  CVE-2013-4407.patch"
sha512sums="920deabbe8c7c8dc7af308fddb51bdaf83d70066d056dc112b15d3d2c5d401fd7f84b36913d113a5c5017ec35e623f10e86b43260c18303115f593ba7d5a299e  HTTP-Body-1.15.tar.gz
f6a53949bdb592e9cf10771f3b38b538ac8aeacaddbb7f4f71528147ae2c16ff27a1b191210ec3df3592ad5377beaef4db988ae5eb7a003f4aea558c02995d69  CVE-2013-4407.patch"
