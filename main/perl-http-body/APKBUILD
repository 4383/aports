# Contributor: Natanael Copa <ncopa@alpinelinux.org>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=perl-http-body
pkgver=1.14
pkgrel=0
pkgdesc="HTTP::Body perl module"
url="http://search.cpan.org/dist/HTTP-Body/"
arch="noarch"
license="GPLv2 or Artistic"
depends="perl perl-http-message perl-uri"
makedepends="perl-dev perl-test-deep"
install=""
subpackages="$pkgname-doc"
source="http://search.cpan.org/CPAN/authors/id/G/GE/GETTY/HTTP-Body-$pkgver.tar.gz
	CVE-2013-4407.patch
	"

_builddir="$srcdir"/HTTP-Body-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	PERL_MM_USE_DEFAULT=1 perl Makefile.PL INSTALLDIRS=vendor || return 1
	make && make test || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	find "$pkgdir" \( -name perllocal.pod -o -name .packlist \) -delete
}

md5sums="56d48ed79398d462da1ca9192fe1e2b6  HTTP-Body-1.14.tar.gz
8e5a8675955e2bb7a23579be4df6558d  CVE-2013-4407.patch"
sha256sums="1e9a138cd54f0e1b447c34cef794f8c4613d653f76948b4a1a8d82ca4c795688  HTTP-Body-1.14.tar.gz
5bacbbeda2c4297188f2fdfb03ee7d00785452bb72fac8ac0e8bd5e3575c7061  CVE-2013-4407.patch"
sha512sums="2718921634a9cce06273b84221c9cdf6248b6ee930a132ba0318e9a1df23d8b6abf86a5fc67106c31da8bd0b7ac4e03ede74b4fe6b3f22210a625b5f7fe16dd7  HTTP-Body-1.14.tar.gz
f6a53949bdb592e9cf10771f3b38b538ac8aeacaddbb7f4f71528147ae2c16ff27a1b191210ec3df3592ad5377beaef4db988ae5eb7a003f4aea558c02995d69  CVE-2013-4407.patch"
