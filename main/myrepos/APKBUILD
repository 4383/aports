# Contributor: Fabian Affolter <fabian@affolter-engineering.ch>
# Maintainer: Fabian Affolter <fabian@affolter-engineering.ch>
pkgname=myrepos
pkgver=1.20130710
pkgrel=0
pkgdesc="A multiple repository management tool"
url="https://github.com/joeyh/myrepos"
arch="noarch"
license="GPL2+"
depends="perl git"
depends_dev=""
makedepends=""
replaces="mr"
install=""
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/joeyh/$pkgname/archive/$pkgver.tar.gz"

_builddir="$srcdir"/$pkgname-$pkgver
build() {
	cd "$_builddir"
	make || return 1
	make test || return 1
}

package() {
	cd "$_builddir"
	install -Dm755 mr "$pkgdir"/usr/bin/mr || return 1
	cd "$_builddir"/lib
	for file in git-fake-bare git-svn unison; do
		install -Dpm 0644 $file \
			"$pkgdir"/usr/share/$pkgname/$file  || return 1
	done
}

doc() {
	cd "$_builddir"
    mkdir -p "$subpkgdir"/usr/share/man || return 1
    mv "$_builddir"/*.1 "$subpkgdir"/usr/share/man/ || return 1
	# Sample configuration files
	for file in mrconfig mrconfig.complex; do
		install -Dpm 0644 $file \
			"$subpkgdir"/usr/share/doc/$pkgname/$file  || return 1
	done
}

md5sums="92284d8b9403a4d7512da9ed87db8226  myrepos-1.20130710.tar.gz"
sha256sums="3f5747f7fcaebc2d2291f28765e0f9f76ff889da1d3ad8e519be3d798eb726d9  myrepos-1.20130710.tar.gz"
sha512sums="6c7caebc2f9aaf00b7cdd111f5af074c6d1153d888f2fc7b2d3a82d6324c86d7f2955858c02e3b6a6f2f852c8b52dd95b40b67307a3cbb7f4489c9113f981f34  myrepos-1.20130710.tar.gz"
