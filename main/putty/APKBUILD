# Contributor: Sergei Lukin <sergej.lukin@gmail.com>
# Maintainer: Jeff Bilyk <jbilyk@alpinelinux.org>
pkgname=putty
pkgver=0.68
pkgrel=0
pkgdesc="SSH and telnet client"
url="http://www.chiark.greenend.org.uk/~sgtatham/putty/"
arch="all"
license="custom"
depends=
depends_dev=
makedepends="$depends_dev"
install=""
subpackages="$pkgname-doc"
source="http://the.earth.li/~sgtatham/putty/latest/putty-$pkgver.tar.gz
fix-include.patch
"

# secfixes:
#   0.68-r0:
#   - CVE-2017-6542

_builddir="$srcdir"/putty-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
}

md5sums="1d933c04e256a669af5a3b85c090909a  putty-0.68.tar.gz
c376fb348650e28b88cbf06c07cd35d4  fix-include.patch"
sha256sums="7ba256f46e5a353cafe811ce7914d0e22a52bdfc0e6e2d183ad28b5af44cd09c  putty-0.68.tar.gz
c10f453b2b8f4df670e192234ab14aa81d28f5b917a38c75d8936e351478c738  fix-include.patch"
sha512sums="e3a6e4f45e1fce70d4cbb6d4769ab72b23c10920e48a88bba95b3f4c225b0193ddc1444e69d572bdec5e505d2c56fed365f07d990c156b35f272b56f978ef5d3  putty-0.68.tar.gz
1ac1d9c803e0bc180b4c9a2dde357d06b0af37d182e8037fccc5c42f03f5e796fca0a1a2e6fa2db5ae27fbbdfb2579938a70ccf5028fee20c828a853607f330b  fix-include.patch"
