# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=xfsprogs
pkgver=3.1.0
pkgrel=0
pkgdesc="XFS filesystem utilities"
url="http://oss.sgi.com/projects/xfs/"
license="LGPL"
depends="e2fsprogs"
makedepends="e2fsprogs-dev bash"
subpackages="$pkgname-dev $pkgname-doc"
source="ftp://oss.sgi.com/projects/xfs/cmd_tars/${pkgname}-$pkgver.tar.gz
	xfsprogs-3.0.0-gzip.patch
	"

_builddir="$srcdir"/$pkgname-$pkgver

prepare() {
	cd "$_builddir"
	for i in ../*.patch; do
		msg "Applying $i..."
		patch -p1 < $i || return 1
	done
}
	
build() {
	cd "$_builddir"
	export DEBUG=-DNDEBUG
	export OPTIMIZER="$CFLAGS"

	ac_cv_header_aio_h=yes ac_cv_lib_rt_lio_listio=yes \
	./configure --prefix=/usr \
		--sbindir=/sbin \
		--libexecdir=/usr/lib \
		--enable-gettext=no

	make SHELL=/bin/bash || return 1
}

package() {
	cd "$_builddir"
	make -j1 DIST_ROOT="$pkgdir" install install-dev
}
md5sums="07c1ff6a4a44b58ee5ffdabca33a4493  xfsprogs-3.1.0.tar.gz
c72865de30f55343e843dd4fd49a91c5  xfsprogs-3.0.0-gzip.patch"
