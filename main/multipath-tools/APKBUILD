# Maintainer: Leonardo Arena <rnalrd@alpinelinux.org>
pkgname="multipath-tools"
pkgver=0.4.9_git20120127
pkgrel=0
pkgdesc="Device Mapper Multipathing Driver"
url="http://christophe.varoqui.free.fr/"
arch="all"
license="GPL"
depends="udev"
makedepends="lvm2-dev libaio-dev readline-dev ncurses-dev"
install=
subpackages="$pkgname-doc"
source="http://dev.alpinelinux.org/archive/$pkgname/$pkgname-$pkgver.tar.gz
	"
#source="http://christophe.varoqui.free.fr/$pkgname/$pkgname-$pkgver.tar.bz2

_builddir="$srcdir"

prepare() {
	cd $_builddir
	find . -name Makefile -exec sed -i -e 's/glibc/uclibc/g' {} \;
#	for i in ../*.patch
#	do
#		msg "Applying $i"
#		patch -p1 < $i || return 1
#	done
}

build() {
	cd $_builddir
	make -j1 prefix="/usr" \
		sysconfdir="/etc" \
		mandir="/usr/share/man" \
		infodir="/usr/share/info" || return 1
}

package() {
	cd $_builddir
	make DESTDIR="$pkgdir" install
	install -D -m644 ../$pkgname.conf $pkgdir/etc/multipath.conf
	install -D -m644 ../$pkgname.confd $pkgdir/etc/conf.d/multipathd
	install -D -m755 ../$pkgname.initd $pkgdir/etc/init.d/multipathd
}

md5sums="38503d19b66c247c7da87eca9a48d570  multipath-tools-0.4.9_git20120127.tar.gz"
sha256sums="bc51ed7cae3fd4a60d5157d7fb3593395663362223e5fd86f30cf4b6d92f9cf4  multipath-tools-0.4.9_git20120127.tar.gz"
sha512sums="f9f27dded1d8c7fb7f1aae0d0febc0461cc939db337c204310d9d45a2d1d138601621cb56b5048f1a4b8a08142245b852d28ed6fddbd43d6466f41c67d933a9e  multipath-tools-0.4.9_git20120127.tar.gz"
