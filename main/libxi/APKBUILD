# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=libxi
pkgver=1.7.1
pkgrel=1
pkgdesc="X11 Input extension library"
url="http://xorg.freedesktop.org"
arch="all"
license="custom"
subpackages="$pkgname-dev $pkgname-doc"
depends=
depends_dev="inputproto libx11-dev libxext-dev libxfixes-dev"
makedepends="
	$depends_dev
	pkgconfig 
	xextproto
	xproto
	libtool autoconf automake util-macros
	"
source="http://xorg.freedesktop.org/releases/individual/lib/libXi-$pkgver.tar.bz2
	CVE-2013-1984_CVE-2013-1995_CVE-2013-1998.patch"

_builddir="$srcdir"/libXi-$pkgver
prepare() {
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
	libtoolize --force && aclocal && autoheader && autoconf \
		&& automake --add-missing
}

build () 
{ 
	cd "$_builddir"
	./configure --prefix=/usr --sysconfdir=/etc || return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" install || return 1
	rm "$pkgdir"/usr/lib/*.la || return 1
	install -Dm644 COPYING "$pkgdir"/usr/share/licenses/$pkgname/COPYING
}
md5sums="24d71afed1b86c60d4eb361628d7f47b  libXi-1.7.1.tar.bz2
75c05fe817230d99194a7593a4f1f8ae  CVE-2013-1984_CVE-2013-1995_CVE-2013-1998.patch"
sha256sums="e92adb6b69c53c51e05c1e65db97e23751b935a693000fb0606c11b88c0066c5  libXi-1.7.1.tar.bz2
5cc75b20c524ccaf49a0283e16b00a81019c25753eb1a16ae8880e6bc0688e60  CVE-2013-1984_CVE-2013-1995_CVE-2013-1998.patch"
sha512sums="f897bb9ca0bc98b4e5ad7ff770bbafabdc7880122ec50ecbafbcc0e0d4b299cf792484bed6cf87608b652baedd3928341b1bdf110d240a02ac1ac930bab05927  libXi-1.7.1.tar.bz2
cf5486fe1daa93190f9fe66ff372bfa3b18a00d0ffff07f222ab1d89f30df786a99959d110c41ae8460257e2f5f4805e861cb8a2858836a6f7413303507bfa70  CVE-2013-1984_CVE-2013-1995_CVE-2013-1998.patch"
