# Contributor: Michael Mason <ms13sp@gmail.com>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=fetchmail
pkgver=6.3.25
pkgrel=0
pkgdesc="A remote-mail retrieval and forwarding utility"
url="http://fetchmail.berlios.de/"
arch="all"
license="GPL"
depends=
pkgusers="fetchmail"
pkggroups="fetchmail"
makedepends="openssl-dev python"
install="fetchmail.pre-install"
subpackages="$pkgname-doc fetchmailconf"
source="http://download.berlios.de/fetchmail/$pkgname-$pkgver.tar.bz2
	fetchmail.initd"
build() {
	cd "$srcdir/$pkgname-$pkgver"

	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info \
		--with-ssl \
		--disable-nls
	make || return 1
}

package() {
	cd "$srcdir/$pkgname-$pkgver"
	make DESTDIR="$pkgdir" install
	install -Dm755 "$srcdir"/fetchmail.initd "$pkgdir"/etc/init.d/fetchmail
	install -o fetchmail -g fetchmail -d "$pkgdir"/var/lib/fetchmail \
		"$pkgdir"/var/run/fetchmail
}

fetchmailconf() {
	depends="python"
	pkgdesc="A GUI for generating fetchmail configuration files"
	install=
	mkdir -p "$subpkgdir"/usr/bin
	cd "$pkgdir"
	mv usr/bin/fetchmailconf "$subpkgdir"/usr/bin/
	mv usr/lib "$subpkgdir"/usr/
}

md5sums="2147a46615db787281296af4504ba78f  fetchmail-6.3.25.tar.bz2
20ad22948fd77cf24e2bb288af6fd266  fetchmail.initd"
sha256sums="4cd5d812f9391184052f19ce4072b66f1b08434a5503657f3c4c052fb2e4c26b  fetchmail-6.3.25.tar.bz2
7a8cf11f172bf747453b98e97723b98953c1b06f95f68ad0d8332a253604e8dd  fetchmail.initd"
sha512sums="92e1ff6801975339cc7158b9a103ca56742ba83eeb80dd9a05634b815637a7d47da6c9a9b80265939faec0e0a4fdb655a4c28adf3cca2bf6cf36da1fb1fee793  fetchmail-6.3.25.tar.bz2
a4606676085d69e08633665b11994ba0a2deb54e00d99ca191058b1cc4f0e2ff681f941f5ef88254fda78d620ed835d4107f51a484f2ddefa53e05b925cea61e  fetchmail.initd"
