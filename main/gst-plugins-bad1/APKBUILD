# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=gst-plugins-bad1
pkgver=1.8.3
pkgrel=0
pkgdesc="GStreamer bad plugins"
url="http://gstreamer.freedesktop.org/"
arch="all"
license="LGPL GPL"
depends=""
subpackages="$pkgname-lang $pkgname-dev $pkgname-doc"
makedepends="
	alsa-lib-dev
	bzip2-dev
	curl-dev
	faac-dev
	faad2-dev
	flite-dev
	glib-dev
	gsm-dev
	gst-plugins-base1-dev
	gstreamer1-dev
	jasper-dev
	libdc1394-dev
	libexif-dev
	libmms-dev
	libmodplug-dev
	liboil-dev
	libressl-dev
	librsvg-dev
	libvdpau-dev
	libx11-dev
	neon-dev
	orc-dev
	sdl-dev
	spandsp-dev
	xvidcore-dev
	"

source="http://gstreamer.freedesktop.org//src/gst-plugins-bad/gst-plugins-bad-$pkgver.tar.xz
	CVE-2016-9809.patch
	CVE-2016-9812.patch
	CVE-2016-9813.patch
	CVE-2017-5843.patch
	"
ldpath="/usr/lib/gstreamer-1.0"
builddir="$srcdir"/gst-plugins-bad-$pkgver

# secfixes:
#   1.8.3-r0:
#     - CVE-2016-9809
#     - CVE-2016-9812
#     - CVE-2016-9813
#     - CVE-2016-5843

build() {
	cd "$builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--disable-static \
		--enable-experimental \
		--disable-fatal-warnings \
		--with-package-name="GStreamer Bad Plugins (Alpine Linux)" \
		--with-package-origin="http://alpinelinux.org/" \
		|| return 1
	make || return 1
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install || return 1
}

md5sums="955281a43e98c5464563fa049e0a0911  gst-plugins-bad-1.8.3.tar.xz
5f4b84f9a2330af2d8000bd3321e23c0  CVE-2016-9809.patch
e7a67a284fa955e033bc16b5abe05545  CVE-2016-9812.patch
b55721930b6dea57eec01667c7cd5b40  CVE-2016-9813.patch
57da34fff25bf69e5c67574ba9f33fdb  CVE-2017-5843.patch"
sha256sums="7899fcb18e6a1af2888b19c90213af018a57d741c6e72ec56b133bc73ec8509b  gst-plugins-bad-1.8.3.tar.xz
6a4dde1e73941afdae48dd8b8e02819f79d42a4bec5b1d16cfaa1ebc33805bf2  CVE-2016-9809.patch
a386ab126055b2a6084aea26b20275b09494e65fc53849f193b448481f480ba5  CVE-2016-9812.patch
f19bfe16d517130e133a7d88b7c8e78366a69956ed8f25cf906c931c76f839af  CVE-2016-9813.patch
2c12d1aa0227149dc46d5ea994e619637d1e316e63a85bd89cad92833c4e7ee5  CVE-2017-5843.patch"
sha512sums="3676903fea7a5b078187c3b295208bc24b567ba4e965035db603cf8106e34ca619668253ff4320b192c4e3d1698572e6591bf7fb7253bd2399e7986711bb85c4  gst-plugins-bad-1.8.3.tar.xz
cc9bb9143207a67e4bd21f687fadb054dee8286f9b173fb05744f09ed7d2e1c4325822451df612b5d0cbe3d7a4673b7907b2d7f7defc758988cf6f8d2e19d866  CVE-2016-9809.patch
0d6b90ad8c2a33d7d73e9357783c76c9b7056c7c51d33bb0b9e7aa4861991050d4f4af8ccd11d07904c0b436c388b352a071ee2cf31e4a0dcde2d47ac0a36dc3  CVE-2016-9812.patch
9f949eac20aea2b87ee179185e09f78362c3419cb827a5e2994f0aa7e8a7f0d0e286e97d76923ffff877ce862db704ec80c6b862e7991ab921431024ce3292ac  CVE-2016-9813.patch
d42d0f87925406c714409d0bf5f3a1b68ff90a6097e64004008022d9840e2ec615476e5c1821585c1be15891d39ce2f932664777265c56ccb778b9a968a71deb  CVE-2017-5843.patch"
