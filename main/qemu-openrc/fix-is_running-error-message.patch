From 1b83390b83ce7c33aa64a53758ee7f6748b5d62a Mon Sep 17 00:00:00 2001
From: Leszek Cima≈Ça <ernierasta@zori.cz>
Date: Wed, 29 Mar 2017 13:14:15 +0200
Subject: [PATCH] Do not print unnecessary and confusing error message in is_running()

When VM is stopped gracefully, unnecessary and useless error message is
printed:

    Stopping VM mail ...
    Waiting 40 seconds for VM shutdown ........sh: can't kill pid 17659: No such process [ ok ]

This patch fixes this problem.

Patch-Origin: Backported from 0.6.0
---
 qemu.initd | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/qemu.initd b/qemu.initd
index 0e8c241..6c1e45f 100644
--- a/qemu.initd
+++ b/qemu.initd
@@ -205,7 +205,7 @@ version() {
 #-------------------------------- Helpers -------------------------------
 
 is_running() {
-	[ -e "$pidfile" ] && kill -0 "$(cat "$pidfile")"
+	[ -e "$pidfile" ] && kill -0 "$(cat "$pidfile")" 2>/dev/null
 }
 
 command_args_push() {
