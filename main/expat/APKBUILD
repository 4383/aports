# Maintainer: Carlo Landmeter <clandmeter@gmail.com>
pkgname=expat
pkgver=2.1.0
pkgrel=1
pkgdesc="An XML Parser library written in C"
url="http://www.libexpat.org/"
arch="all"
license='AS IS'
depends=
makedepends=
source="http://downloads.sourceforge.net/project/$pkgname/$pkgname/$pkgver/$pkgname-$pkgver.tar.gz
	CVE-2016-0718-v2-2-1.patch
	"
subpackages="$pkgname-dev $pkgname-doc"

_builddir="$srcdir/$pkgname-$pkgver"
prepare() {
	cd "$_builddir"
	update_config_sub || return 1
	for i in "$srcdir"/*.patch; do
		[ -f "$i" ] || continue
		msg "Applying $i"
		patch -p2 -i "$i" || return 1
	done
		
}

build() {
	cd "$_builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--mandir=/usr/share/man \
		|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir/" install || return 1
	rm "$pkgdir"/usr/lib/*.la || return 1
}

md5sums="dd7dab7a5fea97d2a6a43f511449b7cd  expat-2.1.0.tar.gz
d3956709e6a0477288f8fdc5a400200f  CVE-2016-0718-v2-2-1.patch"
sha256sums="823705472f816df21c8f6aa026dd162b280806838bb55b3432b0fb1fcca7eb86  expat-2.1.0.tar.gz
a8b29528d2db6b9e0f217c0bae43f494594f0d98a2e0954b4fa7c1f60ce5b779  CVE-2016-0718-v2-2-1.patch"
sha512sums="2a9ad2b44b87b84087979fe4114d661838df3b03dbdcb74d590cb74096bf35ce9d5a86617b0941a2655ea441a94537bcbcd78252da92342238823be36de2d09d  expat-2.1.0.tar.gz
858cebc918d773e6df90438ef90cbd72a3f521a3dfc21f1cbd420bcbab68c35cd82e8aca71bcadbf50cf66adce9daa35e7aaed014c8bc104c62eb741c9c1ec54  CVE-2016-0718-v2-2-1.patch"
