# Contributor: prymeroot <pryme@gmx.com>
# Contributor: Jeff Bilyk <jbilyk@gmail.com>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=fail2ban
pkgver=0.8.12
pkgrel=0
pkgdesc="Scans log files for login failures then updates iptables to reject originating ip address"
url="http://www.fail2ban.org"
arch="noarch"
license="GPL2+"
depends="python iptables logrotate"
makedepends="python-dev python-dev py-setuptools"
source="$pkgname-$pkgver.tar.gz::https://codeload.github.com/fail2ban/fail2ban/tar.gz/$pkgver
		fail2ban.confd
		fail2ban.logrotate"

_builddir="$srcdir"/$pkgname-$pkgver
build() {
	cd "$_builddir"
	python setup.py build || return 1
}

package() {
	cd "$_builddir"
	python setup.py install --root "$pkgdir" || return 1
	install -Dm755 files/gentoo-initd "$pkgdir"/etc/init.d/fail2ban \
		|| return 1
	install -Dm644 "$srcdir"/fail2ban.confd "$pkgdir"/etc/conf.d/fail2ban \
		|| return 1
	install -Dm644 "$srcdir"/fail2ban.logrotate \
		"$pkgdir"/etc/logrotate.d/fail2ban || return 1
}

md5sums="50e6cbd1d2b18ad890f1b60b53aa5b36  fail2ban-0.8.12.tar.gz
b209a04f9314dd064a4aa0ee505c8a4d  fail2ban.confd
6d1af6ceebd15c8ae3938bc675efe553  fail2ban.logrotate"
sha256sums="4844d17296861c39647c6053b1dc146fe80691f3833dd116ea9197059946f467  fail2ban-0.8.12.tar.gz
e35f1f820bfe5ecaac2696d60155c348d84af428e8c615e97b900c24a587d233  fail2ban.confd
4cfe274ec9c71dd0ae0575298f5327230f6e67b2f8fc1a616c645d0f6b3ce02f  fail2ban.logrotate"
sha512sums="7186ed8c810e0c4d1420c0e0e91558e56abe71d5b48fe26360a6c3c11b6349ccea1354405b3f3f98d1eef8a43faac1c3f931b41e2a6c3ca15258a74616d00e1a  fail2ban-0.8.12.tar.gz
1e7581dd04e7777d6fd5c40cc842a7ec5f4e6a0374673d020d89dd61bf4093d48934844bee89bcac9084f9ae44f3beb66e714cf3c2763d79c3e8feb790c5e43b  fail2ban.confd
60c80dcf8ced5a0323daef2df702f862d99ac45f56b91015ce39be8471cf9d6a3bb45d776df0330692f40db37638dc3ef2004cfc65f26d50dd67c94fbfdf4ec2  fail2ban.logrotate"
