From 00a80395a4cd17a6f420238bf9d936d3d9b65a8a Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Fri, 30 Sep 2016 15:18:03 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/280

---
 magick/profile.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/magick/profile.c b/magick/profile.c
index baf7e70..db4083d 100644
--- a/magick/profile.c
+++ b/magick/profile.c
@@ -2060,7 +2060,7 @@ static MagickBooleanType SyncExifProfile(Image *image, StringInfo *profile)
       (void) AddValueToSplayTree(exif_resources,q,q);
       tag_value=(ssize_t) ReadProfileShort(endian,q);
       format=(ssize_t) ReadProfileShort(endian,q+2);
-      if ((format-1) >= EXIF_NUM_FORMATS)
+      if ((format < 0) || ((format-1) >= EXIF_NUM_FORMATS))
         break;
       components=(ssize_t) ReadProfileLong(endian,q+4);
       if (components < 0)
