# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=py-twisted
_pkgname=Twisted
pkgver=16.2.0
pkgrel=0
pkgdesc="Asynchronous networking framework written in Python."
url="http://twistedmatrix.com/"
arch="all"
license="MIT"
depends="py-crypto py-zope-interface"
makedepends="python-dev py-setuptools libtirpc-dev"
install=""
subpackages="$pkgname-doc"
source="https://twistedmatrix.com/Releases/${_pkgname}/${pkgver%.*}/${_pkgname}-${pkgver}.tar.bz2"

_builddir="$srcdir"/"$_pkgname"-$pkgver

build() {
	cd "$_builddir"
	CFLAGS="$CFLAGS `pkgconf --cflags libtirpc`" python setup.py build || return 1
}

package() {
	cd "$_builddir"
	python setup.py install --prefix=/usr --root="$pkgdir" || return 1
	install -D -m644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
	_mans="manhole.1 pyhtmlizer.1 tap2deb.1 tap2rpm.1 trial.1 twistd.1"
	for _man in $_mans; do
		install -m644 -D "$_builddir"/docs/core/man/$_man \
			"$pkgdir"/usr/share/man/man1/$_man  || return 1
	done
}

md5sums="8b35a88d5f1a4bfd762a008968fddabf  Twisted-16.2.0.tar.bz2"
sha256sums="a090e8dc675e97fb20c3bb5f8114ae94169f4e29fd3b3cbede35705fd3cdbd79  Twisted-16.2.0.tar.bz2"
sha512sums="a1942c15a84946e8bd4833801fffe7be01443560209972e10043262fd17a73c5d0c50592bd037130b6a1de08d7223cbdc1e2398c8c67f559d42e3e8ec81df840  Twisted-16.2.0.tar.bz2"
