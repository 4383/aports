# Contributor: Michael Mason <ms13sp@gmail.com>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=dansguardian
pkgver=2.10.1.1
pkgrel=1
pkgdesc="Web content filter"
url="http://dansguardian.org"
license="GPL"
depends="logrotate"
makedepends="zlib-dev uclibc++-dev pcre-dev pkgconfig libiconv-dev"
install="$pkgname.pre-install $pkgname.post-install"
subpackages="$pkgname-doc"
source="http://dansguardian.org/downloads/2/Stable/$pkgname-$pkgver.tar.gz
	dansguardian.initd
	dansguardian.logrotate
	"

build() {
	cd "$srcdir/$pkgname-$pkgver"
	export CXX=${CXX_UC:-g++-uc}

	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--infodir=/usr/share/info \
		--with-proxyuser=dansguar \
		--with-proxygroup=dansguar \
		--with-logdir=/var/log/dansguardian \
		--with-piddir=/var/run/ \
		--enable-ntlm
	make || return 1
	make DESTDIR="$pkgdir" install

	install -D -m 755 ../dansguardian.initd "$pkgdir"/etc/init.d/dansguardian
	install -D -m 644 ../dansguardian.logrotate "$pkgdir"/etc/logrotate.d/dansguardian
}

md5sums="0987a1c9bfbdf398118386f10279611a  dansguardian-2.10.1.1.tar.gz
0c04f74cd5db9fc7a8e80b407ec34214  dansguardian.initd
85b6de01c9508e8ceff5ebb55752f8d3  dansguardian.logrotate"
